{"version":3,"sources":["pages/components/BookCard.js","pages/components/BookCardRating.js","pages/Home.js","pages/Login.js","pages/Register.js","pages/Users.js","pages/Profile.js","pages/CreateBook.js","pages/components/BookInfo.js","pages/components/CommentsSection.js","pages/BookViewer.js","LoginRoute.js","pages/components/Search.js","App.js","index.js"],"names":["BookCard","className","to","this","props","title","author","description","id","defaultMessage","Date","updatedAt","toLocaleDateString","Component","withRouter","BookCardRating","value","rating","edit","count","isHalf","size","activeColor","toPrecision","Home","state","allTags","getTags","bind","axios","get","then","response","data","map","tag","tags","entry","setState","name","JSON","parse","localStorage","getItem","filter","book","now","sort","a","b","index","slice","createdAt","ratingCount","minSize","maxSize","arr","Set","o","stringify","string","defaults","withCredentials","Login","handleInputChange","event","target","username","password","alert","login","onClickLogin","onClickLoginTwitter","onClickLoginVK","onClickLoginGoogle","window","location","href","post","message","prevState","console","log","handleSuccessfulAuth","type","onChange","onClick","Toast","style","position","top","right","show","onClose","delay","autohide","Header","Register","onClickRegister","email","Users","users","selectedRows","block","unblock","delete","blockUsers","unblockUsers","deleteUsers","getData","showBlockAlert","showUnblockAlert","showDeleteAlert","Promise","resolve","setTimeout","catch","err","history","push","includes","parseInt","userId","handleLogoutClick","columns","cell","row","Alert","variant","role","keyField","noDataIndication","hiddenRows","wrapperClasses","selectRow","mode","clickToSelect","onSelectAll","rows","isSelect","r","onSelect","Profile","handleChange","e","undefined","profileId","profileUsername","profileEmail","books","isLoading","getBooks","match","params","ID","status","getProfileData","getUserData","Spinner","animation","dataField","text","formatter","label","Badge","align","pathname","bookid","Button","hidden","deleteBook","Container","fontSize","fontWeight","width","Form","Control","placeholder","readOnly","bootstrap4","defaultSorted","order","pagination","paginationFactory","resetIds","list","el","chapterId","resetNames","chapterName","CreateBook","handleValueChange","chapters","handleTabChange","activeTab","deleteChapter","chapter","editMode","bookId","multiple","genre","activeNav","desc","authorId","BookId","createBook","updateBook","onDragEnd","addChapter","Chapters","user","result","destination","startIndex","endIndex","splice","removed","reorder","source","chaptersCount","length","toString","openBook","genres","Group","as","Row","Label","column","sm","Col","allowNew","highlightOnlyResult","newSelectionPrefix","defaultSelected","options","labelKey","renderToken","option","onRemove","defaultValue","isSearchable","Card","maxWidth","droppableId","provided","droppableProps","ref","innerRef","Accordion","tab","draggableId","draggableProps","dragHandleProps","display","alignItems","margin","AccordionToggle","eventKey","marginLeft","AccordionCollapse","selectedTab","onTabChange","generateMarkdownPreview","markdown","BookInfo","CommentsSection","ws","WebSocket","origin","replace","preventDefault","addCommentsFromServer","comments","comment","onopen","onmessage","evt","onclose","UserId","send","Comment","Content","Author","Metadata","toLocaleString","Text","reply","TextArea","addReply","content","labelPosition","icon","primary","BookViewer","pushChapters","Pagination","Item","setActivePage","activePage","editable","setRating","setRatingBook","isRated","component","handleLogin","rest","render","Search","getBook","dataset","idx","find","messages","en","English","ru","Russian","lunr","require","englishRussianSupport","multiLanguage","App","handleLocale","locale","setItem","search","logout","handleLogout","handleSearch","showLogoutAlert","showLoginAlert","use","field","add","Navbar","collapseOnSelect","sticky","expand","bg","Brand","Toggle","aria-controls","Collapse","Nav","Link","toUpperCase","InputGroup","FormControl","Prepend","exact","path","ListGroup","key","baseURL","createBrowserHistory","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.d0309cf6.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nclass BookCard extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <small className=\"text-muted\">\r\n            <FormattedMessage\r\n              id=\"lastUpdatedFooter\"\r\n              defaultMessage=\"Last updated\"\r\n            />\r\n            {new Date(this.props.updatedAt).toLocaleDateString()}</small>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCard)","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\nimport ReactStars from \"react-rating-stars-component\";\r\n\r\nclass BookCardRating extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <div className=\"row d-flex\">\r\n            <div className=\"col-md-4\">\r\n            <ReactStars\r\n              value={this.props.rating}\r\n              edit={false}\r\n              count={5}\r\n              isHalf={true}\r\n              size={18}\r\n              activeColor=\"#ffd700\"\r\n            />\r\n            </div>\r\n            <div className=\"offset-col-md-4 small text\">\r\n              {this.props.rating.toPrecision(2)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCardRating)","import React, { Component } from \"react\";\r\nimport BookCard from \"./components/BookCard\";\r\nimport BookCardRating from \"./components/BookCardRating\";\r\nimport { TagCloud } from 'react-tagcloud'\r\nimport axios from \"axios\"\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nconst unique = (arr) => {\r\n  return [...new Set(arr.map((o) => JSON.stringify(o))),\r\n  ].map((string) => JSON.parse(string));\r\n}\r\n\r\nclass Home extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      allTags: [],\r\n    }\r\n    this.getTags = this.getTags.bind(this)\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getTags()\r\n  }\r\n\r\n  getTags() {\r\n    axios.get('/book/getTags')\r\n      .then((response) => {\r\n        response.data.map(tag => {\r\n          if (tag.tags) { (tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry })) }\r\n          return tag;\r\n        })\r\n      });\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div className=\"container mt-3\">\r\n          <div className=\"row xl-3\">\r\n            <div name=\"recent\" className=\"col\">\r\n              <h3>\r\n                <FormattedMessage\r\n                  id=\"recentlyUpdated\"\r\n                  defaultMessage=\"Recently updated\"\r\n                />\r\n              </h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .filter(book => new Date(book.updatedAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort((a, b) => {\r\n                  if (a.updatedAt < b.updatedAt) {\r\n                    return 1;\r\n                  }\r\n                  if (a.updatedAt > b.updatedAt) {\r\n                    return -1;\r\n                  }\r\n                  return 0;\r\n                })\r\n                .map((book, index) => (\r\n                  <BookCard\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    updatedAt={book.updatedAt}\r\n                  />\r\n                ))}\r\n            </div>\r\n            <div name=\"top\" className=\"col\">\r\n              <h3>\r\n                <FormattedMessage\r\n                  id=\"topFandoms\"\r\n                  defaultMessage=\"Top fandoms of the week\"\r\n                />\r\n              </h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .slice(0, 5)\r\n                .filter(book => new Date(book.createdAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort((a, b) => (b.rating - a.rating))\r\n                .map((book, index) => (\r\n                  <BookCardRating\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    rating={book.ratingCount ? (book.rating / book.ratingCount) : 0}\r\n                  />\r\n                ))\r\n              }\r\n            </div>\r\n            <div name=\"tags\" className=\"col\">\r\n              <h3>\r\n                <FormattedMessage\r\n                  id=\"tags\"\r\n                  defaultMessage=\"Tags\"\r\n                />\r\n              </h3>\r\n              <TagCloud\r\n                minSize={16}\r\n                maxSize={48}\r\n                tags={unique(this.state.allTags)}\r\n              //onClick={tag => alert(`${tag.value} was selected!`)}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Home","import React, { Component } from \"react\";\r\nimport { Link } from 'react-router-dom';\r\nimport { Toast } from \"react-bootstrap\"\r\nimport axios from \"axios\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Login extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\tpassword: '',\r\n\t\t\talert: {\r\n\t\t\t\tlogin: false\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.onClickLogin = this.onClickLogin.bind(this);\r\n\t\tthis.onClickLoginTwitter = this.onClickLoginTwitter.bind(this);\r\n\t\tthis.onClickLoginVK = this.onClickLoginVK.bind(this);\r\n\t\tthis.onClickLoginGoogle = this.onClickLoginGoogle.bind(this);\r\n\t};\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t};\r\n\r\n\tonClickLoginTwitter() {\r\n\t\twindow.location.href = 'https://itransition-coursework.herokuapp.com/user/auth/twitter/callback'\r\n\t}\r\n\r\n\tonClickLoginVK() {\r\n\t\twindow.location.href = 'https://itransition-coursework.herokuapp.com/user/auth/vkontakte/callback'\r\n\t}\r\n\r\n\tonClickLoginGoogle() {\r\n\t\twindow.location.href = 'https://itransition-coursework.herokuapp.com/user/auth/google/callback'\r\n\t}\r\n\r\n\tonClickLogin() {\r\n\t\tconst { username, password } = this.state;\r\n\t\taxios.post('user/login', {\r\n\t\t\tusername,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tconsole.log(response.data)\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\talert:\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\t\tlogin: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}))\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"login\">\r\n\t\t\t\t{/* <form> */}\r\n\t\t\t\t<h3 className=\"mb-3 mt-5 text-center\">\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"signIn\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</h3>\r\n\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t<div className=\"row mb-3 mt-5 justify-content-center\">\r\n\t\t\t\t\t\t<label className=\"form-label\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"username\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"text\" className=\"col-6 ml-3 form-control\" name=\"username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t<label className=\"form-label\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"password\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t<input type=\"password\" className=\"col-6 ml-3 form-control\" name=\"password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-5 justify-content-center\">\r\n\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLogin} className=\"btn btn-outline-primary\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"logIn\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-5 justify-content-center\">\r\n\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLoginTwitter} className=\"btn btn-primary\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"logInTwitter\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLoginVK} className=\"ml-2 btn btn-info\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"logInVK\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLoginGoogle} className=\"ml-2 btn btn-danger\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"logInGoogle\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t\t<h3 className=\"mt-5 text-center\">\r\n\t\t\t\t\t<Link to=\"/register\" className=\"register_link\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"createAccount\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</Link>\r\n\t\t\t\t</h3>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Toast\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\t\ttop: 100,\r\n\t\t\t\t\t\t\tright: 40,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tshow={this.state.alert.login}\r\n\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\talert:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\t\t\t\t\tlogin: false\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdelay={2000}\r\n\t\t\t\t\t\tautohide\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Toast.Header>\r\n\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\t<FormattedMessage \r\n\t\t\t\t\t\t\t\t\tid=\"wrongInfo\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</strong>\r\n\t\t\t\t\t\t</Toast.Header>\r\n\t\t\t\t\t</Toast>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Register extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\temail: '',\r\n\t\t\tpassword: '',\r\n\t\t};\r\n\t}\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t}\r\n\r\n\tonClickRegister = () => {\r\n\t\tconst { username, email, password } = this.state;\r\n\t\taxios.post('/user/register', {\r\n\t\t\tusername,\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tconsole.log(response);\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"register\">\r\n\t\t\t\t<form>\r\n\t\t\t\t\t<h3 className=\"mb-3 text-center\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"signUp\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</h3>\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<div className=\"mb-3 mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"username\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"text\" className=\"col-3 form-control\" name=\"username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"mb-3 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"email\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"email\" className=\"col-3 form-control\" name=\"email\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"password\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</label>\r\n\t\t\t\t\t\t\t<input type=\"password\" className=\"col-3 form-control\" name=\"password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickRegister} className=\"btn btn-outline-primary\">Submit</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Register;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport { withRouter, Link } from \"react-router-dom\";\r\nimport { Alert } from 'react-bootstrap';\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Users extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.state = {\r\n\t\t\tusers: [],\r\n\t\t\tselectedRows: [],\r\n\t\t\talert: {\r\n\t\t\t\tblock: false,\r\n\t\t\t\tunblock: false,\r\n\t\t\t\tdelete: false\r\n\t\t\t},\r\n\t\t}\r\n\r\n\t\tthis.blockUsers = this.blockUsers.bind(this);\r\n\t\tthis.unblockUsers = this.unblockUsers.bind(this);\r\n\t\tthis.deleteUsers = this.deleteUsers.bind(this);\r\n\t\tthis.getData = this.getData.bind(this);\r\n\t\tthis.showBlockAlert = this.showBlockAlert.bind(this);\r\n\t\tthis.showUnblockAlert = this.showUnblockAlert.bind(this);\r\n\t\tthis.showDeleteAlert = this.showDeleteAlert.bind(this);\r\n\t}\r\n\r\n\tasync getData() {\r\n\t\tawait new Promise(resolve => setTimeout(resolve, 200));\r\n\t\tlet data = [];\r\n\t\tdata = await axios.get('/user/usersTable')\r\n\t\t\t.then(response => {\r\n\t\t\t\treturn response.data;\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tthis.props.history.push('/');\r\n\t\t\t});\r\n\t\tthis.setState({ users: data });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.getData();\r\n\t}\r\n\r\n\tshowBlockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowUnblockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tunblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tunblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowDeleteAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tdelete: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tdelete: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/block', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.showBlockAlert();\r\n\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\r\n\tunblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/unblock', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tthis.showUnblockAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\r\n\tdeleteUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/delete', {\r\n\t\t\tselectedRows,\r\n\t\t}).then((response) => {\r\n\t\t\tif (response) {\r\n\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.showDeleteAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst columns = [\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"id\",\r\n\t\t\t\t\"text\": \"ID\"\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"username\",\r\n\t\t\t\t\"text\":\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"usernameTable\"\r\n\t\t\t\t\t/>,\r\n\t\t\t\t\"formatter\": (cell, row) => <Link to={`/profile/${cell}`}> {cell} </Link>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"email\",\r\n\t\t\t\t\"text\":\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"emailTable\"\r\n\t\t\t\t\t/>,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"createdAt\",\r\n\t\t\t\t\"text\":\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"registrationDate\"\r\n\t\t\t\t\t/>,\r\n\t\t\t\t\"formatter\": (cell, row) => new Date(cell).toLocaleDateString()\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"role\",\r\n\t\t\t\t\"text\":\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"roleTable\"\r\n\t\t\t\t\t/>,\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\t\"dataField\": \"status\",\r\n\t\t\t\t\"text\":\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"statusTable\"\r\n\t\t\t\t\t/>\r\n\t\t\t}\r\n\t\t]\r\n\r\n\t\treturn (\r\n\t\t\t<div className=\"container mt-3\">\r\n\t\t\t\t<Alert show={this.state.alert.block} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"blockAlert\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.unblock} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"unblockAlert\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.delete} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"deleteAlert\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<div className=\"btn-group mb-3\" role=\"group\">\r\n\t\t\t\t\t<button onClick={this.blockUsers} type=\"button\" className=\"btn btn-outline-primary\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"blockButton\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button onClick={this.unblockUsers} type=\"button\" className=\"btn btn-outline-primary\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"unblockButton\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t\t<button onClick={this.deleteUsers} type=\"button\" className=\"btn btn-outline-danger\">\r\n\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\tid=\"deleteButton\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<BootstrapTable\r\n\t\t\t\t\tkeyField='id'\r\n\t\t\t\t\tnoDataIndication=\"Table is Empty\"\r\n\t\t\t\t\tdata={this.state.users}\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\thiddenRows={[5]} //Admin ID\r\n\t\t\t\t\twrapperClasses=\"table-responsive\"\r\n\t\t\t\t\tselectRow={{\r\n\t\t\t\t\t\tmode: 'checkbox',\r\n\t\t\t\t\t\tclickToSelect: true,\r\n\t\t\t\t\t\tonSelectAll: (row, rows, isSelect) => {\r\n\t\t\t\t\t\t\tif (row) {\r\n\t\t\t\t\t\t\t\tfor (let r of rows) {\r\n\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, r.id]\r\n\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({ selectedRows: [] });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonSelect: (row, isSelect) => {\r\n\t\t\t\t\t\t\tif (isSelect) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, row.id]\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\tselectedRows: this.state.selectedRows.filter(function (selectedRows) {\r\n\t\t\t\t\t\t\t\t\t\treturn selectedRows !== row.id\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withRouter(Users);","import React, { Component } from \"react\";\r\nimport { Button, Badge, Form, Container, Spinner } from \"react-bootstrap\";\r\nimport { Link } from 'react-router-dom';\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport paginationFactory from 'react-bootstrap-table2-paginator';\r\nimport { BsX } from \"react-icons/bs\";\r\nimport axios from 'axios';\r\nimport { withRouter } from \"react-router\";\r\nimport { FormattedMessage } from \"react-intl\";\r\n\r\nclass Profile extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      id: undefined,\r\n      profileId: undefined,\r\n      username: \"\",\r\n      profileUsername: \"\",\r\n      email: \"\",\r\n      profileEmail: \"\",\r\n      books: [],\r\n      isLoading: true,\r\n    }\r\n    this.getBooks = this.getBooks.bind(this);\r\n  }\r\n\r\n  handleChange = e => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  getBooks() {\r\n    const username = this.props.match.params.id; //change later\r\n    axios\r\n      .get(\"/book/userBooks\", {\r\n        params: {\r\n          username: username\r\n        }\r\n      })\r\n      .then(response => {\r\n        this.setState({ books: response.data });\r\n      });\r\n  }\r\n\r\n  deleteBook(id) {\r\n    const ID = id;\r\n    axios\r\n      .post(\"/book/deleteBook\", { ID })\r\n      .then(response => {\r\n        this.setState({\r\n          books: this.state.books.filter(book => book.id !== ID)\r\n        })\r\n      });\r\n  }\r\n\r\n  getUserData() {\r\n    axios\r\n      .get(\"/user/userData\")\r\n      .then(response => {\r\n        if (response.data.status !== 'error') {\r\n          this.setState({\r\n            id: response.data.id,\r\n            username: response.data.username,\r\n            email: response.data.email,\r\n            role: response.data.role\r\n          }, () => this.setState({ isLoading: false }));\r\n        } else {\r\n          this.setState({ isLoading: false })\r\n        }\r\n      })\r\n  }\r\n\r\n  getProfileData() {\r\n    axios\r\n      .get(\"/user/profileData\",\r\n        {\r\n          params: {\r\n            username: this.props.match.params.id,\r\n          }\r\n        })\r\n      .then(response => {\r\n        this.setState({\r\n          profileId: response.data.id,\r\n          profileUsername: response.data.username,\r\n          profileEmail: response.data.email\r\n        })\r\n      })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBooks();\r\n    this.getProfileData();\r\n    this.getUserData();\r\n  }\r\n\r\n  render() {\r\n    const { isLoading } = this.state;\r\n    if (isLoading) {\r\n      return <div>\r\n        <Spinner animation=\"border\" role=\"status\">\r\n          <span className=\"sr-only\">Loading...</span>\r\n        </Spinner>\r\n      </div>;\r\n    }\r\n\r\n    if (!isLoading && !this.state.profileId) {\r\n      return <div>\r\n        <h3 className=\"mt-5 text-center\">\r\n          This user doesn't exist\r\n                </h3>\r\n      </div>\r\n    }\r\n\r\n    const columns = [\r\n      {\r\n        dataField: \"title\",\r\n        text:\r\n          <FormattedMessage\r\n            id=\"titleProfile\"\r\n            defaultMessage=\"Title\"\r\n          />\r\n        ,\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"genre\",\r\n        text:\r\n          <FormattedMessage\r\n            id=\"genreProfile\"\r\n            defaultMessage=\"Genre\"\r\n          />\r\n      },\r\n      {\r\n        dataField: \"tags\",\r\n        text:\r\n          <FormattedMessage\r\n            id=\"tagsProfile\"\r\n            defaultMessage=\"Tags\"\r\n          />,\r\n        formatter: (cell, row) => cell ? cell.map((label, index) => { return (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">{label.label}</Badge>) })\r\n          : <FormattedMessage\r\n            id=\"noTagsProfile\"\r\n            defaultMessage=\"No tags\"\r\n          />\r\n      },\r\n      {\r\n        dataField: \"rating\",\r\n        text:\r\n          <FormattedMessage\r\n            id=\"ratingProfile\"\r\n            defaultMessage=\"Rating\"\r\n          />,\r\n        formatter: (cell, row) => row.ratingCount !== 0 ? (cell / row.ratingCount).toPrecision(2) : 0,\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"createdAt\",\r\n        text:\r\n          <FormattedMessage\r\n            id=\"createdAtProfile\"\r\n            defaultMessage=\"Publication date\"\r\n          />,\r\n        formatter: (cell, row) => new Date(cell).toLocaleDateString(),\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"Edit\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) =>\r\n          <Link to={{ pathname: `/edit/${row.title}`, state: { bookid: row.title } }}>\r\n            <Button variant=\"secondary\">\r\n              <FormattedMessage\r\n                id=\"editProfile\"\r\n                defaultMessage=\"Edit\"\r\n              />\r\n            </Button>\r\n          </Link>,\r\n        hidden: (this.state.username === this.state.profileUsername || this.props.role === 'admin') ? false : true\r\n      },\r\n      {\r\n        dataField: \"View\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) =>\r\n          <Link to={`/view/${row.title}`}>\r\n            <Button variant=\"secondary\">\r\n              <FormattedMessage\r\n                id=\"viewProfile\"\r\n                defaultMessage=\"View\"\r\n              />\r\n            </Button>\r\n          </Link>\r\n      },\r\n      {\r\n        dataField: \"Delete\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => <Button onClick={() => this.deleteBook(row.id)}> <BsX /> </Button>,\r\n        hidden: this.state.username === this.state.profileUsername ? false : true\r\n      }\r\n    ]\r\n\r\n    return (\r\n      <>\r\n        <Container className=\"container mt-3\">\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold',\r\n              width: 'auto',\r\n            }}>\r\n              <FormattedMessage\r\n                id=\"usernameProfile\"\r\n                defaultMessage=\"Username:\"\r\n              />\r\n            </div>\r\n            <div className=\"p-1 ml-3\">\r\n              <Form.Control type=\"text\" placeholder={this.state.profileUsername} readOnly />\r\n            </div>\r\n          </div>\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold'\r\n            }}>\r\n              <FormattedMessage\r\n                id=\"emailProfile\"\r\n                defaultMessage=\"Email:\"\r\n              />\r\n            </div>\r\n            <div className=\"p-1 ml-3\">\r\n              <Form.Control type=\"text\" placeholder={this.state.profileEmail} readOnly />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"container mt-3\">\r\n            {(this.state.username === this.props.match.params.id)\r\n              ? <div className=\"mt-3 mb-3\">\r\n                <Link to={\"/createBook\"}>\r\n                  <Button className=\"shadow-sm\" variant=\"outline-success\" >\r\n                    <FormattedMessage\r\n                      id=\"createBookButton\"\r\n                      defaultMessage=\"Create fandom\"\r\n                    />\r\n                  </Button>\r\n                </Link>\r\n              </div>\r\n              : null\r\n            }\r\n\r\n            <BootstrapTable\r\n              bootstrap4\r\n              keyField='id'\r\n              noDataIndication=\"Table is Empty\"\r\n              data={this.state.books}\r\n              columns={columns}\r\n              defaultSorted={[{\r\n                dataField: 'createdAt',\r\n                order: 'desc'\r\n              }]}\r\n              wrapperClasses=\"table-responsive\"\r\n              pagination={paginationFactory()}\r\n            />\r\n          </div>\r\n        </Container>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Profile);","import React, { Component, Fragment } from \"react\";\r\nimport { Spinner, Form, Row, Col, Button, Accordion, Card, AccordionToggle, AccordionCollapse } from \"react-bootstrap\";\r\nimport { Typeahead, Token } from 'react-bootstrap-typeahead';\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { BsPlus, BsX } from \"react-icons/bs\";\r\nimport { withRouter } from \"react-router\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactMde from \"react-mde\";\r\nimport axios from 'axios';\r\nimport Select from 'react-select'\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nconst unique = (arr) => {\r\n\treturn [...new Set(arr.map((o) => JSON.stringify(o))),\r\n\t].map((string) => JSON.parse(string));\r\n}\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n\tconst result = list;\r\n\tconst [removed] = result.splice(startIndex, 1);\r\n\tresult.splice(endIndex, 0, removed);\r\n\treturn resetNames(resetIds(result));\r\n};\r\n\r\nconst resetIds = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst ID = el;\r\n\t\tID.chapterId = index + 1;\r\n\t\treturn ID;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nconst resetNames = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst name = el;\r\n\t\tname.chapterName = index + 1;\r\n\t\treturn name;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nclass CreateBook extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\teditMode: false,\r\n\t\t\tisLoading: true,\r\n\t\t\tmultiple: true,\r\n\t\t\tbookId: \"\",\r\n\t\t\ttags: [],\r\n\t\t\tallTags: [],\r\n\t\t\tgenre: \"\",\r\n\t\t\tactiveNav: \"write\",\r\n\t\t\tdesc: \"\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tauthor: \"\",\r\n\t\t\tauthorId: \"\",\r\n\t\t\tchapters: [\r\n\t\t\t\t{\r\n\t\t\t\t\tchapterId: 1,\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tchapterName: '1',\r\n\t\t\t\t\ttext: '',\r\n\t\t\t\t\tBookId: '',\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t}\r\n\t\tthis.createBook = this.createBook.bind(this);\r\n\t\tthis.updateBook = this.updateBook.bind(this);\r\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\r\n\t\tthis.addChapter = this.addChapter.bind(this);\r\n\t\tthis.deleteChapter = this.deleteChapter.bind(this);\r\n\t\tthis.getTags = this.getTags.bind(this);\r\n\t}\r\n\r\n\topenBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\tthis.getTags()\r\n\t\taxios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t},\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\ttitle: response.data.title,\r\n\t\t\t\t\tbookId: response.data.id,\r\n\t\t\t\t\ttags: response.data.tags,\r\n\t\t\t\t\tgenre: response.data.genre,\r\n\t\t\t\t\tdesc: response.data.description,\r\n\t\t\t\t\tauthor: response.data.author,\r\n\t\t\t\t\tauthorId: response.data.authorId,\r\n\t\t\t\t\tchapters: response.data.Chapters\r\n\t\t\t\t},\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tif (this.state.chapters && (this.props.role === 'admin' || this.props.user === this.state.author)) {\r\n\t\t\t\t\t\t\tthis.state.chapters.map((chapter) => {\r\n\t\t\t\t\t\t\t\tdelete chapter['createdAt'];\r\n\t\t\t\t\t\t\t\tdelete chapter['updatedAt'];\r\n\t\t\t\t\t\t\t\treturn chapter;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.setState({ isLoading: false })\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.props.history.push(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t});\r\n\t};\r\n\r\n\tonDragEnd(result) {\r\n\t\tif (!result.destination) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst chapters = reorder(\r\n\t\t\tthis.state.chapters,\r\n\t\t\tresult.source.index,\r\n\t\t\tresult.destination.index\r\n\t\t);\r\n\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\thandleValueChange = (e, index) => {\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tchapters[index].text = e;\r\n\t\tthis.setState({ chapters });\r\n\t\t/*this.setState(prevState => ({\r\n\t\t\tchapters: {\r\n\t\t\t\t...prevState.chapters,\r\n\t\t\t\t[prevState.chapters[index].text]: e,\r\n\t\t\t},\r\n\t\t}));*/\r\n\t};\r\n\r\n\thandleTabChange = activeTab => {\r\n\t\tthis.setState({ activeTab });\r\n\t};\r\n\r\n\taddChapter() {\r\n\t\t//console.log(this.state.chapters.length)\r\n\t\tconst chaptersCount = this.state.chapters.length + 1;\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tconst chapter = {\r\n\t\t\tBookId: this.state.bookId,\r\n\t\t\tchapterId: chaptersCount,\r\n\t\t\tchapterName: chaptersCount.toString(),\r\n\t\t\ttext: ''\r\n\t\t}\r\n\t\tchapters.push(chapter);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\tdeleteChapter = id => {\r\n\t\tconst chapters = this.state.chapters.filter((chapter) => chapter.chapterId !== id);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t\tif (this.state.editMode) {\r\n\t\t\tconst bookId = this.state.bookId;\r\n\t\t\tconst chapterId = id;\r\n\t\t\taxios\r\n\t\t\t\t.post(\"/book/deleteChapter\", { bookId, chapterId });\r\n\t\t}\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ author: this.props.user, authorId: this.props.userId })\r\n\t\tif (this.props.location.pathname === `/edit/${this.props.match.params.bookid}`) {\r\n\t\t\tthis.setState({ editMode: true }, () => this.openBook())\r\n\t\t} else {\r\n\t\t\tthis.setState({ isLoading: false })\r\n\t\t}\r\n\t}\r\n\r\n\tcreateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/createBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, chapters\r\n\t\t})\r\n\t\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\tupdateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tbookId,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/updateBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, bookId, chapters\r\n\t\t})\r\n\t\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\tgetTags() {\r\n\t\taxios.get('/book/getTags')\r\n\t\t\t.then((response) => {\r\n\t\t\t\tresponse.data.map(tag => {\r\n\t\t\t\t\tif (tag.tags) { (tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry })) }\r\n\t\t\t\t\treturn tag;\r\n\t\t\t\t})\r\n\t\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\tconst genres = [\r\n\t\t\t{\r\n\t\t\t\tvalue: 'fantasy',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"fantasy\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'action',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"action\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'adventure',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"adventure\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'detective',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"detective\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'romance',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"romance\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'sci-fi',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"sci-fi\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'horror',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"horror\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'thriller',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"thriller\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t\t{\r\n\t\t\t\tvalue: 'erotic',\r\n\t\t\t\tlabel:\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"erotic\"\r\n\t\t\t\t\t/>\r\n\t\t\t},\r\n\t\t]\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"mt-4\">\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"titleViewer\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ title: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"descViewer\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.desc}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ desc: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"tagsViewer\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t\t\t<Typeahead\r\n\t\t\t\t\t\t\t\t\t\t{...this.state}\r\n\t\t\t\t\t\t\t\t\t\tallowNew={true}\r\n\t\t\t\t\t\t\t\t\t\thighlightOnlyResult={false}\r\n\t\t\t\t\t\t\t\t\t\tnewSelectionPrefix={\r\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"addTag\"\r\n\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\tid=\"tags-token\"\r\n\t\t\t\t\t\t\t\t\t\tdefaultSelected={this.state.tags ? this.state.tags : []}\r\n\t\t\t\t\t\t\t\t\t\toptions={this.state.allTags.length > 0 ? unique(this.state.allTags) : []}\r\n\t\t\t\t\t\t\t\t\t\tlabelKey=\"value\"\r\n\t\t\t\t\t\t\t\t\t\tonChange={(tags) => this.setState({ tags })}\r\n\t\t\t\t\t\t\t\t\t\trenderToken={(option, { onRemove }, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Token key={index} option={option} onRemove={onRemove}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{`${option.value}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Token>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"genreViewer\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\tdefaultValue={{ value: \"default\", label: this.state.genre }}\r\n\t\t\t\t\t\t\t\t\tonChange={(genre) => this.setState({ genre })}\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\toptions={genres}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t</Form>\r\n\r\n\t\t\t\t\t<Card style={{ maxWidth: '45.5rem' }} onClick={this.addChapter}>\r\n\t\t\t\t\t\t<Card.Header as={Button} variant=\"light\">\r\n\t\t\t\t\t\t\t<BsPlus />\r\n\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\r\n\t\t\t\t\t\t<Droppable droppableId=\"droppable\" >\r\n\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t<div className=\"col-xs\"\r\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Accordion>\r\n\t\t\t\t\t\t\t\t\t\t{(this.state.chapters).map((tab, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<Draggable\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={tab.chapterId}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdraggableId={tab.chapterId.toString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card key={index} style={{ maxWidth: '45.5rem' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card.Header style={{ display: 'flex', alignItems: 'center', margin: '0' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionToggle as={Button} variant=\"link\" eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.editMode ? `Chapter ${tab.chapterId}` : `Chapter ${tab.chapterName}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionToggle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(index + 1 === this.state.chapters.length)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? <Button variant=\"link\" onClick={() => { this.deleteChapter(tab.chapterId) }} style={{ marginLeft: 'auto' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<BsX />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionCollapse eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ReactMde\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.chapters[index].text}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleValueChange(e, index)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedTab={this.state.activeTab}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonTabChange={this.handleTabChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgenerateMarkdownPreview={(markdown) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPromise.resolve(<ReactMarkdown source={markdown} />)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionCollapse>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t</Accordion>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t\t<div className=\"mt-3\">\r\n\t\t\t\t\t\t{this.state.editMode\r\n\t\t\t\t\t\t\t? <Button onClick={this.updateBook} variant=\"outline-success\">Update</Button>\r\n\t\t\t\t\t\t\t: <Button onClick={this.createBook} variant=\"outline-success\">Publish</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(CreateBook);","import React, { Component } from \"react\";\r\n\r\nclass BookInfo extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"row mt-1\">\r\n        <div className=\"p-1 mr-5\">\r\n          {this.props.label}\r\n        </div>\r\n        <div>\r\n          {this.props.value}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default BookInfo","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Comment, Form, Button } from 'semantic-ui-react'\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport 'semantic-ui-css/components/comment.min.css'\r\nimport 'semantic-ui-css/components/form.min.css'\r\nimport 'semantic-ui-css/components/button.min.css'\r\nimport 'semantic-ui-css/components/icon.min.css'\r\n\r\nclass CommentsSection extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      comments: [],\r\n      comment: ''\r\n    };\r\n  }\r\n\r\n  // ws = new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`)\r\n  ws = new WebSocket(window.location.origin.replace(/^http/, 'ws') + `/${this.props.bookId}`)\r\n\r\n  handleInputChange = (event) => {\r\n    event.preventDefault();\r\n    this.setState({\r\n      [event.target.name]: event.target.value,\r\n    });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.ws.onopen = () => {\r\n      console.log('Connected to server')\r\n    }\r\n    this.ws.onmessage = evt => {\r\n      const comment = JSON.parse(evt.data)\r\n      this.addCommentsFromServer(comment);\r\n    }\r\n    this.ws.onclose = () => {\r\n      console.log('Disconnected from server')\r\n      this.setState({\r\n        ws: new WebSocket(window.location.origin.replace(/^http/, 'ws') + `/${this.props.bookId}`),\r\n        // ws: new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`),\r\n      })\r\n    }\r\n  }\r\n\r\n  addCommentsFromServer = comments => {\r\n    this.setState(state => ({ comments: comments }))\r\n  }\r\n\r\n  addReply() {\r\n    if (this.state.comment) {\r\n      const comment = {\r\n        author: this.props.username,\r\n        UserId: this.props.userId,\r\n        BookId: this.props.bookId,\r\n        text: this.state.comment\r\n      }\r\n      this.ws.send(JSON.stringify(comment))\r\n      this.setState({ comment: '' })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Comment.Group size='small'>\r\n          {this.state.comments.map((comment, index) => (\r\n            <Comment key={index}>\r\n              <Comment.Content>\r\n                <Comment.Author as='a'>{comment.author}</Comment.Author>\r\n                <Comment.Metadata>\r\n                  <div>{new Date(comment.createdAt).toLocaleString(\"ru-RU\")}</div>\r\n                </Comment.Metadata>\r\n                <Comment.Text>{comment.text}</Comment.Text>\r\n              </Comment.Content>\r\n            </Comment>\r\n          ))}\r\n        </Comment.Group>\r\n        {this.props.username ?\r\n          <Form reply>\r\n            <Form.TextArea\r\n              value={this.state.comment}\r\n              onChange={e => this.handleInputChange(e)}\r\n              name='comment'\r\n              width={8}\r\n            />\r\n            <Button\r\n              ws={this.ws}\r\n              onClick={() => this.addReply()}\r\n              content={\r\n                <FormattedMessage\r\n                  id=\"addReply\"\r\n                  defaultMessage=\"Add reply\"\r\n                />\r\n              }\r\n              labelPosition='left'\r\n              icon='edit'\r\n              size='small'\r\n              primary\r\n            />\r\n          </Form>\r\n          : null}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(CommentsSection);","import React, { Component } from \"react\";\r\nimport { Spinner, Button, Pagination, Container, Badge } from \"react-bootstrap\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactStars from \"react-rating-stars-component\";\r\nimport axios from 'axios';\r\nimport BookInfo from \"./components/BookInfo\";\r\nimport CommentsSection from \"./components/CommentsSection\";\r\nimport { withRouter } from \"react-router\";\r\nimport { FormattedMessage } from \"react-intl\";\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass BookViewer extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tisLoading: true,\r\n\t\t\tbook: [],\r\n\t\t\trating: undefined,\r\n\t\t\tactivePage: \"\",\r\n\t\t\teditable: true,\r\n\t\t\tcomments: false,\r\n\t\t}\r\n\t\tthis.setRating = this.setRating.bind(this);\r\n\t\tthis.setRatingBook = this.setRatingBook.bind(this);\r\n\t\tthis.setActivePage = this.setActivePage.bind(this);\r\n\t\tthis.pushChapters = this.pushChapters.bind(this);\r\n\t\tthis.isRated = this.isRated.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.user === undefined) {\r\n\t\t\tthis.setState({ editable: false });\r\n\t\t}\r\n\t\tthis.openBook()\r\n\t}\r\n\r\n\tisRated() {\r\n\t\tconst bookId = this.state.book.id;\r\n\t\tconst authorId = this.props.userId;\r\n\t\taxios.get('/book/isRated', {\r\n\t\t\tparams: {\r\n\t\t\t\tauthorId, bookId\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconsole.log(response)\r\n\t\t\t\tif (response.data.message) {\r\n\t\t\t\t\tthis.setState({ editable: false },\r\n\t\t\t\t\t\t() => this.setState({ isLoading: false }))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setState({ isLoading: false })\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tasync openBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\tawait axios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({ book: response.data },\r\n\t\t\t\t\t(() => { if (this.props.user) { this.isRated() } else { this.setState({ isLoading: false }) } }))\r\n\t\t\t})\r\n\t\t\t.catch(err => console.log(err));\r\n\t};\r\n\r\n\tsetActivePage(index) {\r\n\t\tthis.setState({ activePage: index });\r\n\t}\r\n\r\n\tpushChapters = () => {\r\n\t\tlet chapters = [];\r\n\t\tif (this.state.book.Chapters) {\r\n\t\t\tthis.state.book.Chapters\r\n\t\t\t\t.sort((a, b) => {\r\n\t\t\t\t\tif (a.chapterId > b.chapterId) {\r\n\t\t\t\t\t\treturn 1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (a.chapterId < b.chapterId) {\r\n\t\t\t\t\t\treturn -1;\r\n\t\t\t\t\t}\r\n\t\t\t\t\treturn 0;\r\n\t\t\t\t})\r\n\t\t\t\t.map((chapter, index) => {\r\n\t\t\t\t\tchapters.push(\r\n\t\t\t\t\t\t<Pagination.Item onClick={() => { this.setActivePage(index); this.setState({ comments: false }) }} key={index}>{index + 1}</Pagination.Item>\r\n\t\t\t\t\t)\r\n\t\t\t\t\treturn chapters\r\n\t\t\t\t})\r\n\t\t}\r\n\t\treturn chapters;\r\n\t}\r\n\r\n\tsetRating(value) {\r\n\t\tif (this.props.user) {\r\n\t\t\tthis.setState({\r\n\t\t\t\trating: value\r\n\t\t\t})\r\n\t\t} else {\r\n\t\t\tconsole.log(\"You have to login to set a rating.\")\r\n\t\t}\r\n\t}\r\n\r\n\tsetRatingBook() {\r\n\t\tif (this.props.user) {\r\n\t\t\tconst author = this.props.user;\r\n\t\t\tconst bookId = this.state.book.id;\r\n\t\t\tconst rating = this.state.book.rating;\r\n\t\t\tconst authorId = this.props.userId;\r\n\t\t\tconst ratingCount = this.state.book.ratingCount;\r\n\t\t\taxios.post('/book/setRating', {\r\n\t\t\t\tauthor, authorId, bookId, rating, ratingCount\r\n\t\t\t})\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log('You have to login to set a rating.')\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\tif (!this.state.book) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<h3 className=\"mt-5 text-center\">\r\n\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\tid=\"noBook\"\r\n\t\t\t\t\t/>\r\n\t\t\t\t</h3>\r\n\t\t\t</div>\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Container className=\"container\">\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"titleViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvalue={this.state.book.title}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"authorViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvalue={this.state.book.author}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"descViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvalue={this.state.book.description}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"genreViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tvalue={this.state.book.genre}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"tagsViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{this.state.book.tags\r\n\t\t\t\t\t\t\t? this.state.book.tags.map((tag, index) => {\r\n\t\t\t\t\t\t\t\treturn (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">\r\n\t\t\t\t\t\t\t\t\t{tag.value}\r\n\t\t\t\t\t\t\t\t</Badge>)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"ratingViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<ReactStars\r\n\t\t\t\t\t\t\tvalue={this.state.book.rating / this.state.book.ratingCount}\r\n\t\t\t\t\t\t\tcount={5}\r\n\t\t\t\t\t\t\tedit={(this.props.user && this.state.editable) ? true : false}\r\n\t\t\t\t\t\t\tonChange={this.setRating}\r\n\t\t\t\t\t\t\tisHalf={true}\r\n\t\t\t\t\t\t\tsize={24}\r\n\t\t\t\t\t\t\tactiveColor=\"#ffd700\"\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t<span className=\"ml-3 mt-2\">{this.state.book.rating ? (this.state.book.rating / this.state.book.ratingCount).toPrecision(2) : 0}</span>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tclassName=\"ml-3 p-1\"\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t() => this.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tbook:\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t...prevState.book,\r\n\t\t\t\t\t\t\t\t\t\trating: this.state.editable ? prevState.book.rating + this.state.rating : prevState.book.rating,\r\n\t\t\t\t\t\t\t\t\t\tratingCount: this.state.editable ? prevState.book.ratingCount + 1 : prevState.book.ratingCount,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\teditable: false\r\n\t\t\t\t\t\t\t\t}), () => this.setRatingBook())\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\tvariant=\"outline-success\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"setRatingViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\tid=\"chaptersViewer\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Pagination>\r\n\t\t\t\t\t\t\t{this.pushChapters()}\r\n\t\t\t\t\t\t\t<Pagination.Item onClick={() => { this.setState(prevState => ({ comments: prevState.comments === false ? true : false })) }}>\r\n\t\t\t\t\t\t\t\t<FormattedMessage\r\n\t\t\t\t\t\t\t\t\tid=\"commentsViewer\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Pagination.Item>\r\n\t\t\t\t\t\t</Pagination>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{this.state.comments\r\n\t\t\t\t\t\t? <CommentsSection\r\n\t\t\t\t\t\t\tusername={this.props.user}\r\n\t\t\t\t\t\t\tuserId={this.props.userId}\r\n\t\t\t\t\t\t\tbookId={this.state.book.id}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t: null\r\n\t\t\t\t\t}\r\n\t\t\t\t\t{this.state.activePage !== \"\"\r\n\t\t\t\t\t\t? <div className=\"row mt-5 \">\r\n\t\t\t\t\t\t\t<ReactMarkdown>\r\n\t\t\t\t\t\t\t\t{this.state.book.Chapters[parseInt(this.state.activePage)].text}\r\n\t\t\t\t\t\t\t</ReactMarkdown>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t</Container>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(BookViewer);","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nfunction LoginRoute({ component: Component, handleSuccessfulAuth, handleLogin, user, ...rest }) {\r\n  return (\r\n    <Route {...rest}\r\n      render={props => {\r\n        if (user === undefined) {\r\n          return <Component handleSuccessfulAuth={handleSuccessfulAuth}\r\n            handleLogin={handleLogin}\r\n            user={user}\r\n            {...props} />;\r\n        } else {\r\n          return (\r\n            <Redirect to=\"/\" />\r\n          );\r\n        }\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default withRouter(LoginRoute);\r\n","import React, { Component } from \"react\";\r\nimport BookCard from \"./BookCard\";\r\nimport { Spinner } from \"react-bootstrap\";\r\n\r\nclass Search extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      book: undefined\r\n    }\r\n    this.getBook = this.getBook.bind(this)\r\n  }\r\n\r\n  getBook(dataset, idx) {\r\n    this.setState({ book: dataset.find(data => data.id === parseInt(idx)) },\r\n    () => this.setState({ isLoading: false }))\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBook(JSON.parse(localStorage.getItem('books')), this.props.result.ref)\r\n  }\r\n\r\n  render() {\r\n\t\tif (!this.state.book) {\r\n    return  <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n    const { book } = this.state\r\n    return (\r\n      <BookCard\r\n        key={book.id}\r\n        title={book.title}\r\n        description={book.description}\r\n        author={book.author}\r\n        updatedAt={book.updatedAt}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport default Search","import React, { Component } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport Home from './pages/Home.js';\nimport Login from './pages/Login.js';\nimport Register from './pages/Register.js';\nimport Users from './pages/Users.js';\nimport Profile from './pages/Profile.js';\nimport CreateBook from './pages/CreateBook.js';\nimport BookViewer from './pages/BookViewer.js';\nimport BookCard from \"./pages/components/BookCard\";\nimport LoginRoute from './LoginRoute.js';\nimport Search from \"./pages/components/Search\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router\";\nimport { Navbar, Nav, Button, FormControl, ListGroup, Toast, Spinner, InputGroup } from \"react-bootstrap\";\n\n/* INTL SETUP */\nimport { IntlProvider, FormattedMessage } from \"react-intl\";\nimport Russian from \"./lang/ru-RU.json\";\nimport English from \"./lang/en-US.json\";\nconst messages = {\n\ten: English,\n\tru: Russian\n}\n\n/* LUNR SETUP */\nconst lunr = require(\"lunr\")\nrequire(\"lunr-languages/lunr.stemmer.support\")(lunr)\nrequire('lunr-languages/lunr.multi')(lunr)\nrequire(\"lunr-languages/lunr.ru\")(lunr)\nconst englishRussianSupport = lunr.multiLanguage('en', 'ru');\n\naxios.defaults.withCredentials = true;\n\nclass App extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tsearch: '',\n\t\t\talert: {\n\t\t\t\tlogin: false,\n\t\t\t\tlogout: false,\n\t\t\t},\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined,\n\t\t\t},\n\t\t\tisLoading: true,\n\t\t\tchapters: [],\n\t\t\tcomments: [],\n\t\t\tlocale: \"en\",\n\t\t\tmessages: English,\n\t\t\t//searchResult: [],\n\t\t\t//books: []\n\t\t}\n\t\tthis.handleLogin = this.handleLogin.bind(this);\n\t\tthis.handleLogout = this.handleLogout.bind(this);\n\t\tthis.handleLogoutClick = this.handleLogoutClick.bind(this);\n\t\tthis.handleSuccessfulAuth = this.handleSuccessfulAuth.bind(this);\n\t\tthis.getBooks = this.getBooks.bind(this);\n\t\tthis.getTags = this.getTags.bind(this);\n\t\tthis.handleSearch = this.handleSearch.bind(this);\n\t}\n\n\thandleSuccessfulAuth(data) {\n\t\tthis.handleLogin(data);\n\t}\n\n\thandleLogout() {\n\t\tthis.showLogoutAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined\n\t\t\t}\n\t\t})\n\t\tthis.props.history.push(\"/\");\n\t}\n\n\tshowLogoutAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogout: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogoutClick() {\n\t\taxios.get('/user/logout')\n\t\t\t.then((response) => {\n\t\t\t\tthis.handleLogout();\n\t\t\t});\n\t}\n\n\tshowLoginAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogin: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogin(data) {\n\t\tthis.showLoginAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: data.id,\n\t\t\t\tusername: data.username,\n\t\t\t\temail: data.email,\n\t\t\t\trole: data.role\n\t\t\t}\n\t\t}, () => this.props.history.push({\n\t\t\tpathname: \"/users\",\n\t\t\tstate: { user: this.state.user }\n\t\t}))\n\t}\n\n\tasync getBooks() {\n\t\taxios\n\t\t\t.get(\"/book/allBooks\")\n\t\t\t.then(response => {\n\t\t\t\t//this.setState({ books: response.data }, () => this.setState({ isLoading: false }));\n\t\t\t\tlocalStorage.setItem('books', JSON.stringify(response.data))\n\t\t\t})\n\t\t\t.then(() => this.setState({ isLoading: false }));\n\t}\n\n\tgetUserData() {\n\t\taxios\n\t\t\t.get(\"/user/userData\")\n\t\t\t.then(response => {\n\t\t\t\t// console.log('getUserData:', response)\n\t\t\t\tif (response.data.status !== 'error') {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\tusername: response.data.username,\n\t\t\t\t\t\t\temail: response.data.email,\n\t\t\t\t\t\t\trole: response.data.role\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tgetTags() {\n\t\taxios.get('/book/getTags')\n\t\t\t.then((response) => {\n\t\t\t\tresponse.data.map(tag => {\n\t\t\t\t\t(tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry }));\n\t\t\t\t\treturn tag;\n\t\t\t\t})\n\t\t\t});\n\t}\n\n\thandleInputChange = (event) => {\n\t\tthis.setState({\n\t\t\t[event.target.name]: event.target.value,\n\t\t});\n\t};\n\n\thandleLocale = () => {\n\t\tthis.setState(prevState => ({\n\t\t\tlocale: prevState.locale === 'en' ? 'ru' : 'en'\n\t\t}), localStorage.setItem('locale', this.state.locale))\n\t}\n\n\thandleSearch() {\n\t\tconst { search } = this.state\n\t\tif (search) {\n\t\t\taxios\n\t\t\t\t.get(\"/book/allComments\")\n\t\t\t\t.then(response => {\n\t\t\t\t\tlocalStorage.setItem('comments', JSON.stringify(response.data))\n\t\t\t\t});\n\t\t\taxios\n\t\t\t\t.get(\"/book/allChapters\")\n\t\t\t\t.then(response => {\n\t\t\t\t\tlocalStorage.setItem('chapters', JSON.stringify(response.data))\n\t\t\t\t});\n\t\t\tconst idx = lunr(function () {\n\t\t\t\tthis.use(englishRussianSupport)\n\t\t\t\tthis.ref('id')\n\t\t\t\tthis.field('author')\n\t\t\t\tthis.field('title')\n\t\t\t\tthis.field('description')\n\t\t\t\tthis.field('text')\n\t\t\t\tJSON.parse(localStorage.getItem('books')).map(book => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: book.id,\n\t\t\t\t\t\ttitle: book.title,\n\t\t\t\t\t\tauthor: book.author,\n\t\t\t\t\t\tdescription: book.description,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t\tJSON.parse(localStorage.getItem('comments')).map(comment => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: comment.BookId,\n\t\t\t\t\t\ttext: comment.text,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t\tJSON.parse(localStorage.getItem('chapters')).map(chapter => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: chapter.BookId,\n\t\t\t\t\t\tchapter: chapter.text,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t})\n\t\t\tlocalStorage.setItem('searchResult', JSON.stringify(idx.search(search)))\n\t\t\tthis.props.history.replace({ pathname: `/search/${this.state.search}` })\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getUserData();\n\t\tthis.getBooks();\n\t\tif (localStorage.getItem('locale') === null) {\n\t\t\tlocalStorage.setItem('locale', 'en')\n\t\t}\n\t}\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n\t\tif (isLoading) {\n\t\t\treturn <div>\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\n\t\t\t\t</Spinner>\n\t\t\t</div>;\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<IntlProvider locale={localStorage.getItem('locale')} messages={messages[localStorage.getItem('locale')]}>\n\t\t\t\t\t<Navbar collapseOnSelect sticky=\"top\" expand=\"sm\" bg=\"light\" variant=\"light\">\n\t\t\t\t\t\t<Navbar.Brand href=\"/\" >\n\t\t\t\t\t\t\t<h3>\n\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\tid=\"headerApp\"\n\t\t\t\t\t\t\t\t\tdefaultMessage=\"Mordor\"\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t</Navbar.Brand>\n\t\t\t\t\t\t<Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\n\t\t\t\t\t\t<Navbar.Collapse id=\"responsive-navbar-nav\">\n\t\t\t\t\t\t\t<Nav className=\"mr-auto\">\n\t\t\t\t\t\t\t\t{this.state.user && this.state.user.role === 'admin'\n\t\t\t\t\t\t\t\t\t? <Nav.Link href=\"/users\">\n\t\t\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"usersButton\"\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Users\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t<Nav.Link href=\"/books\">\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\tid=\"fandomsButton\"\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Fandoms\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t</Nav>\n\t\t\t\t\t\t\t{this.state.user && this.state.user.username\n\t\t\t\t\t\t\t\t? <Nav className=\"ml-auto\">\n\t\t\t\t\t\t\t\t\t<Nav.Link>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={() => this.props.history.replace({ pathname: `/profile/${this.state.user.username}`, state: { user: this.state.user } })} variant=\"primary\">\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"profileButton\"\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Profile\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t\t<Nav.Link>\n\t\t\t\t\t\t\t\t\t\t<Button onClick={this.handleLogoutClick} variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\t\tid=\"logoutButton\"\n\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Logout\"\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t</Nav>\n\t\t\t\t\t\t\t\t: <Nav.Link href=\"/login\">\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\tid=\"loginButton\"\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Login\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t</Navbar.Collapse>\n\t\t\t\t\t\t<Button onClick={this.handleLocale} variant=\"outline-primary\">{localStorage.getItem('locale').toUpperCase()}</Button>\n\t\t\t\t\t\t<div className=\"ml-lg-2 ml-md-2 ml-sm-2\">\n\t\t\t\t\t\t\t<InputGroup>\n\t\t\t\t\t\t\t\t<FormControl\n\t\t\t\t\t\t\t\t\ttype=\"text\"\n\t\t\t\t\t\t\t\t\tname=\"search\"\n\t\t\t\t\t\t\t\t\tonChange={this.handleInputChange}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t<InputGroup.Prepend>\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-info\" onClick={this.handleSearch}>\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\tid=\"searchButton\"\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"Search\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</InputGroup.Prepend>\n\t\t\t\t\t\t\t</InputGroup>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</Navbar>\n\t\t\t\t\t<div className=\"container\">\n\t\t\t\t\t\t<Switch>\n\t\t\t\t\t\t\t<Route exact path=\"/\" render={props =>\n\t\t\t\t\t\t\t\t<Home {...props}\n\t\t\t\t\t\t\t\t\tbooks={this.state.books}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t} />\n\t\t\t\t\t\t\t<Route path=\"/profile/:id\" render={props =>\n\t\t\t\t\t\t\t\t<Profile {...props}\n\t\t\t\t\t\t\t\t\tbooks={JSON.parse(localStorage.getItem('books'))}\n\t\t\t\t\t\t\t\t\trole={this.state.user.role}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t} />\n\t\t\t\t\t\t\t<Route path=\"/view/:bookid\" render={props =>\n\t\t\t\t\t\t\t\t<BookViewer {...props}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t} />\n\t\t\t\t\t\t\t<Route path=\"/edit/:bookid\" render={props => {\n\t\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\t\trole={this.state.user.role}\n\t\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path=\"/createBook\" render={props => {\n\t\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<LoginRoute path=\"/login\" component={Login}\n\t\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Route path=\"/register\" render={props => (\n\t\t\t\t\t\t\t\t<Register {...props}\n\t\t\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t)} />\n\t\t\t\t\t\t\t<Route path=\"/users\" render={props => {\n\t\t\t\t\t\t\t\tif (this.state.user.role === 'admin') {\n\t\t\t\t\t\t\t\t\treturn <Users {...props}\n\t\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}} />\n\t\t\t\t\t\t\t<Route path=\"/books\" render={props => (\n\t\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('books')).map((book, index) => (\n\t\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t\t<BookCard {...props}\n\t\t\t\t\t\t\t\t\t\t\t\tkey={book.id}\n\t\t\t\t\t\t\t\t\t\t\t\ttitle={book.title}\n\t\t\t\t\t\t\t\t\t\t\t\tdescription={book.description}\n\t\t\t\t\t\t\t\t\t\t\t\tauthor={book.author}\n\t\t\t\t\t\t\t\t\t\t\t\tupdatedAt={book.updatedAt}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t\t)} />\n\t\t\t\t\t\t\t<Route path=\"/search\" render={props => (\n\t\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('searchResult')).length > 0\n\t\t\t\t\t\t\t\t\t\t? JSON.parse(localStorage.getItem('searchResult')).map((result, index) => (\n\t\t\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t\t\t<Search {...props}\n\t\t\t\t\t\t\t\t\t\t\t\t\tresult={result}\n\t\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\t\t\t\t\tcomments={this.state.comments}\n\t\t\t\t\t\t\t\t\t\t\t\t\tchapters={this.state.chapters}\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t\t\t\t: <div>\n\t\t\t\t\t\t\t\t\t\t\t<h3 className=\"mt-5 text-center\">\n\t\t\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\t\t\tid=\"noResults\"\n\t\t\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"No results found\"\n\t\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t\t)} />\n\t\t\t\t\t\t\t<Route path=\"*\" component={() => <h3 className=\"text-center\">404 NOT FOUND</h3>} />\n\t\t\t\t\t\t</Switch>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tshow={this.state.alert.logout}\n\t\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\t\tlogout: false\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\tid=\"loggedOutToast\"\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"You logged out\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t\t</Toast>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tshow={this.state.alert.login}\n\t\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\t\tlogin: false\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t\t{this.state.user.username}\n\t\t\t\t\t\t\t\t\t\t<FormattedMessage\n\t\t\t\t\t\t\t\t\t\t\tid=\"loggedInToast\"\n\t\t\t\t\t\t\t\t\t\t\tdefaultMessage=\"logged in\"\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t\t</Toast>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t</IntlProvider>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default withRouter(App);","import 'bootstrap/dist/css/bootstrap.css';\nimport 'font-awesome/css/font-awesome.min.css'; \nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from \"history\";\nimport './index.css';\nimport App from './App';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://itransition-coursework.herokuapp.com';\n// axios.defaults.baseURL = 'http://localhost:5000';\n\nconst history = createBrowserHistory();\n\nReactDOM.render(\n  <Router history={history}>\n    <App />\n  </Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}