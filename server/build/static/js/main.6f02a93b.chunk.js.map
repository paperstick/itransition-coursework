{"version":3,"sources":["pages/components/BookCard.js","pages/components/BookCardRating.js","pages/Home.js","pages/Login.js","pages/Register.js","data/columns.js","pages/Users.js","pages/Profile.js","data/genres.js","pages/CreateBook.js","pages/components/BookInfo.js","pages/components/CommentsSection.js","pages/BookViewer.js","LoginRoute.js","pages/components/Search.js","App.js","index.js"],"names":["BookCard","className","to","this","props","title","author","description","Date","updatedAt","toLocaleDateString","Component","withRouter","BookCardRating","value","rating","edit","count","isHalf","size","activeColor","toPrecision","Home","state","allTags","getTags","bind","axios","get","then","response","data","map","tag","tags","entry","setState","name","JSON","parse","localStorage","getItem","filter","book","now","sort","reverse","index","id","slice","createdAt","a","b","ratingCount","minSize","maxSize","arr","Set","o","stringify","string","defaults","withCredentials","Login","handleInputChange","event","target","username","password","alert","login","onClickLogin","post","message","prevState","console","log","handleSuccessfulAuth","type","placeholder","onChange","onClick","Toast","style","position","top","right","show","onClose","delay","autohide","Header","Register","onClickRegister","email","columns","cell","row","Users","users","selectedRows","block","unblock","delete","blockUsers","unblockUsers","deleteUsers","getData","showBlockAlert","showUnblockAlert","showDeleteAlert","Promise","resolve","setTimeout","catch","err","history","push","includes","parseInt","userId","handleLogoutClick","Alert","variant","role","keyField","noDataIndication","hiddenRows","wrapperClasses","selectRow","mode","clickToSelect","onSelectAll","rows","isSelect","r","onSelect","Profile","handleChange","e","undefined","profileId","profileUsername","profileEmail","books","isLoading","getBooks","match","params","ID","status","getProfileData","getUserData","Spinner","animation","dataField","text","formatter","label","Badge","align","pathname","bookid","Button","hidden","deleteBook","Container","fontSize","fontWeight","width","Form","Control","readOnly","bootstrap4","defaultSorted","order","pagination","paginationFactory","genres","resetIds","list","el","chapterId","resetNames","chapterName","CreateBook","handleValueChange","chapters","handleTabChange","activeTab","deleteChapter","chapter","editMode","multiple","bookId","genre","activeNav","desc","authorId","BookId","createBook","updateBook","onDragEnd","addChapter","Chapters","user","result","destination","startIndex","endIndex","splice","removed","reorder","source","chaptersCount","length","toString","location","openBook","Group","as","Row","Label","column","sm","Col","allowNew","highlightOnlyResult","newSelectionPrefix","defaultSelected","options","labelKey","renderToken","option","onRemove","defaultValue","isSearchable","Card","maxWidth","droppableId","provided","droppableProps","ref","innerRef","Accordion","tab","draggableId","draggableProps","dragHandleProps","display","alignItems","margin","AccordionToggle","eventKey","marginLeft","AccordionCollapse","selectedTab","onTabChange","generateMarkdownPreview","markdown","BookInfo","CommentsSection","ws","WebSocket","window","origin","replace","preventDefault","addCommentsFromServer","comments","comment","onopen","onmessage","evt","onclose","UserId","send","Comment","Content","Author","Metadata","toLocaleString","Text","reply","TextArea","addReply","content","labelPosition","icon","primary","BookViewer","pushChapters","Pagination","Item","setActivePage","activePage","editable","setRating","setRatingBook","isRated","component","handleLogin","rest","render","Search","getBook","dataset","idx","find","lunr","require","englishRussianSupport","multiLanguage","App","search","logout","handleLogout","handleSearch","showLogoutAlert","showLoginAlert","setItem","use","field","add","Navbar","collapseOnSelect","sticky","expand","bg","Brand","href","Toggle","aria-controls","Collapse","Nav","Link","InputGroup","FormControl","Prepend","exact","path","ListGroup","key","baseURL","createBrowserHistory","ReactDOM","document","getElementById"],"mappings":"2SAIMA,E,4JACJ,WACE,OACE,sBAAKC,UAAU,6BAAf,UACE,sBAAKA,UAAU,sBAAf,UACE,cAAC,IAAD,CAAMC,GAAE,gBAAWC,KAAKC,MAAMC,OAA9B,SACE,oBAAIJ,UAAU,YAAd,SAA4BE,KAAKC,MAAMC,UAEzC,cAAC,IAAD,CAAMH,GAAE,mBAAcC,KAAKC,MAAME,QAAjC,SACE,uBAAOL,UAAU,aAAjB,SAA+BE,KAAKC,MAAME,WAE5C,mBAAGL,UAAU,YAAb,SAA0BE,KAAKC,MAAMG,iBAEvC,qBAAKN,UAAU,cAAf,SACE,wBAAOA,UAAU,aAAjB,0BAA4C,IAAIO,KAAKL,KAAKC,MAAMK,WAAWC,iC,GAd9DC,aAqBRC,cAAWZ,G,kBCnBpBa,E,4JACJ,WACE,OACE,sBAAKZ,UAAU,6BAAf,UACE,sBAAKA,UAAU,sBAAf,UACE,cAAC,IAAD,CAAMC,GAAE,gBAAWC,KAAKC,MAAMC,OAA9B,SACE,oBAAIJ,UAAU,YAAd,SAA4BE,KAAKC,MAAMC,UAEzC,cAAC,IAAD,CAAMH,GAAE,mBAAcC,KAAKC,MAAME,QAAjC,SACE,uBAAOL,UAAU,aAAjB,SAA+BE,KAAKC,MAAME,WAE5C,mBAAGL,UAAU,YAAb,SAA0BE,KAAKC,MAAMG,iBAEvC,qBAAKN,UAAU,cAAf,SACE,sBAAKA,UAAU,aAAf,UACE,qBAAKA,UAAU,WAAf,SACA,cAAC,IAAD,CACEa,MAAOX,KAAKC,MAAMW,OAClBC,MAAM,EACNC,MAAO,EACPC,QAAQ,EACRC,KAAM,GACNC,YAAY,cAGd,qBAAKnB,UAAU,6BAAf,SACGE,KAAKC,MAAMW,OAAOM,YAAY,iB,GA1BhBV,aAmCdC,cAAWC,G,0BC+CXS,E,kDA5Eb,aAAe,IAAD,8BACd,gBACKC,MAAQ,CACTC,QAAS,IAEX,EAAKC,QAAU,EAAKA,QAAQC,KAAb,gBALH,E,qDAQd,WACEvB,KAAKsB,Y,qBAGP,WAAW,IAAD,OACVE,IAAMC,IAAI,iBACTC,MAAK,SAACC,GACNA,EAASC,KAAKC,KAAI,SAAAC,GAEjB,OADGA,EAAIC,MAAQD,EAAIC,KAAKF,KAAI,SAACG,GAA4G,cAAzFA,EAAK,aAAkB,EAAKC,UAAS,SAAAb,GAAK,MAAK,CAAEC,QAAQ,GAAD,mBAAMD,EAAMC,SAAZ,CAAqBW,QAAmBA,KACzIF,U,oBAKT,WACE,OACE,mCACE,qBAAKhC,UAAU,iBAAf,SACE,sBAAKA,UAAU,WAAf,UACE,sBAAKoC,KAAK,SAASpC,UAAU,MAA7B,UACE,kDACCqC,KAAKC,MAAMC,aAAaC,QAAQ,UAC9BC,QAAO,SAAAC,GAAI,OAAI,IAAInC,KAAKmC,EAAKlC,WAAc,IAAID,KAAKA,KAAKoC,MAAQ,WACjEC,OACAC,UACAd,KAAI,SAACW,EAAMI,GAAP,OACH,cAAC,EAAD,CAEE1C,MAAOsC,EAAKtC,MACZE,YAAaoC,EAAKpC,YAClBD,OAAQqC,EAAKrC,OACbG,UAAWkC,EAAKlC,WAJXkC,EAAKK,UAQlB,sBAAKX,KAAK,MAAMpC,UAAU,MAA1B,UACE,yDACCqC,KAAKC,MAAMC,aAAaC,QAAQ,UAC9BQ,MAAM,EAAG,GACTP,QAAO,SAAAC,GAAI,OAAI,IAAInC,KAAKmC,EAAKO,WAAc,IAAI1C,KAAKA,KAAKoC,MAAQ,WACjEC,MAAK,SAACM,EAAGC,GAAJ,OAAWA,EAAErC,OAASoC,EAAEpC,UAC7BiB,KAAI,SAACW,EAAMI,GAAP,OACH,cAAC,EAAD,CAEE1C,MAAOsC,EAAKtC,MACZE,YAAaoC,EAAKpC,YAClBD,OAAQqC,EAAKrC,OACbS,OAAQ4B,EAAKU,YAAeV,EAAK5B,OAAS4B,EAAKU,YAAe,GAJzDV,EAAKK,UASlB,sBAAKX,KAAK,OAAOpC,UAAU,MAA3B,UACE,sCACA,cAAC,WAAD,CACEqD,QAAS,GACTC,QAAS,GACTrB,MAvEAsB,EAuEarD,KAAKoB,MAAMC,QAtEhC,YAAI,IAAIiC,IAAID,EAAIxB,KAAI,SAAC0B,GAAD,OAAOpB,KAAKqB,UAAUD,QAC/C1B,KAAI,SAAC4B,GAAD,OAAYtB,KAAKC,MAAMqB,mBAFf,IAACJ,M,GAKG7C,a,SCNnBgB,IAAMkC,SAASC,iBAAkB,E,IAkGlBC,E,kDA/Fd,WAAY3D,GAAQ,IAAD,8BAClB,cAAMA,IAWP4D,kBAAoB,SAACC,GACpB,EAAK7B,SAAL,eACE6B,EAAMC,OAAO7B,KAAO4B,EAAMC,OAAOpD,SAZnC,EAAKS,MAAQ,CACZ4C,SAAU,GACVC,SAAU,GACVC,MAAO,CACNC,OAAO,IAGT,EAAKC,aAAe,EAAKA,aAAa7C,KAAlB,gBATF,E,gDAkBnB,WAAgB,IAAD,SACiBvB,KAAKoB,MAA5B4C,EADM,EACNA,SAAUC,EADJ,EACIA,SAClBzC,IAAM6C,KAAK,aAAc,CACxBL,WACAC,aACEvC,MAAK,SAACC,GACHA,EAASC,KAAK0C,QAIlB,EAAKrC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJC,OAAO,SAPTK,QAAQC,IAAI9C,EAASC,MACrB,EAAK3B,MAAMyE,qBAAqB/C,EAASC,Y,oBAa5C,WAAU,IAAD,OACR,OACC,sBAAK9B,UAAU,QAAf,UAEE,oBAAIA,UAAU,wBAAd,qBACA,sBAAKA,UAAU,YAAf,UACC,sBAAKA,UAAU,uCAAf,UACC,uBAAOA,UAAU,aAAjB,sBACA,uBAAO6E,KAAK,OAAO7E,UAAU,0BAA0BoC,KAAK,WAAW0C,YAAY,iBAAiBC,SAAU7E,KAAK6D,uBAEpH,sBAAK/D,UAAU,6BAAf,UACC,uBAAOA,UAAU,aAAjB,sBACA,uBAAO6E,KAAK,WAAW7E,UAAU,0BAA0BoC,KAAK,WAAW0C,YAAY,iBAAiBC,SAAU7E,KAAK6D,uBAExH,qBAAK/D,UAAU,kCAAf,SACC,wBAAQ6E,KAAK,SAASG,QAAS9E,KAAKoE,aAActE,UAAU,0BAA5D,yBAIH,oBAAIA,UAAU,mBAAd,SACC,cAAC,IAAD,CAAMC,GAAG,YAAYD,UAAU,gBAA/B,iCAID,8BACC,cAACiF,EAAA,EAAD,CACCC,MAAO,CACNC,SAAU,WACVC,IAAK,IACLC,MAAO,IAERC,KAAMpF,KAAKoB,MAAM8C,MAAMC,MACvBkB,QAAS,WACR,EAAKpD,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJC,OAAO,SAIVmB,MAAO,IACPC,UAAQ,EAjBT,SAmBC,cAACR,EAAA,EAAMS,OAAP,UACC,gF,GArFahF,aCJpBgB,IAAMkC,SAASC,iBAAkB,E,IA8DlB8B,E,kDA3Dd,WAAYxF,GAAQ,IAAD,8BAClB,cAAMA,IAQP4D,kBAAoB,SAACC,GACpB,EAAK7B,SAAL,eACE6B,EAAMC,OAAO7B,KAAO4B,EAAMC,OAAOpD,SAXjB,EAenB+E,gBAAkB,WAAO,IAAD,EACe,EAAKtE,MAAnC4C,EADe,EACfA,SAAU2B,EADK,EACLA,MAAO1B,EADF,EACEA,SACzBzC,IAAM6C,KAAK,iBAAkB,CAC5BL,WACA2B,QACA1B,aACEvC,MAAK,SAACC,GACR6C,QAAQC,IAAI9C,GACPA,EAASC,KAAK0C,SAClB,EAAKrE,MAAMyE,qBAAqB/C,EAASC,UAtB3C,EAAKR,MAAQ,CACZ4C,SAAU,GACV2B,MAAO,GACP1B,SAAU,IALO,E,0CA6BnB,WACC,OACC,qBAAKnE,UAAU,WAAf,SACC,iCACC,oBAAIA,UAAU,mBAAd,qBACA,sBAAKA,UAAU,YAAf,UACC,sBAAKA,UAAU,uCAAf,UACC,uBAAOA,UAAU,mBAAjB,sBACA,uBAAO6E,KAAK,OAAO7E,UAAU,qBAAqB8E,YAAY,iBAAiB1C,KAAK,WAAW2C,SAAU7E,KAAK6D,uBAG/G,sBAAK/D,UAAU,kCAAf,UACC,uBAAOA,UAAU,mBAAjB,2BACA,uBAAO6E,KAAK,QAAQ7E,UAAU,qBAAqB8E,YAAY,mBAAmB1C,KAAK,QAAQ2C,SAAU7E,KAAK6D,uBAG/G,sBAAK/D,UAAU,6BAAf,UACC,uBAAOA,UAAU,mBAAjB,sBACA,uBAAO6E,KAAK,WAAW7E,UAAU,qBAAqB8E,YAAY,iBAAiB1C,KAAK,WAAW2C,SAAU7E,KAAK6D,uBAEnH,qBAAK/D,UAAU,kCAAf,SACC,wBAAQ6E,KAAK,SAASG,QAAS9E,KAAK0F,gBAAiB5F,UAAU,0BAA/D,kC,GAnDgBU,a,oCC0BRoF,EA7BC,CACd,CACE,UAAa,KACb,KAAQ,MAEV,CACE,UAAa,WACb,KAAQ,WACR,UAAa,SAACC,EAAMC,GAAP,OAAe,eAAC,IAAD,CAAM/F,GAAE,mBAAc8F,GAAtB,cAAgCA,EAAhC,SAE9B,CACE,UAAa,QACb,KAAQ,SAEV,CACE,UAAa,YACb,KAAQ,oBACR,UAAa,SAACA,EAAMC,GAAP,OAAe,IAAIzF,KAAKwF,GAAMtF,uBAE7C,CACE,UAAa,OACb,KAAQ,QAEV,CACE,UAAa,SACb,KAAQ,iBCpBZiB,IAAMkC,SAASC,iBAAkB,E,IAE3BoC,E,kDACL,WAAY9F,GAAQ,IAAD,8BAClB,cAAMA,IAEDmB,MAAQ,CACZ4E,MAAO,GACPC,aAAc,GACd/B,MAAO,CACNgC,OAAO,EACPC,SAAS,EACTC,QAAQ,IAIV,EAAKC,WAAa,EAAKA,WAAW9E,KAAhB,gBAClB,EAAK+E,aAAe,EAAKA,aAAa/E,KAAlB,gBACpB,EAAKgF,YAAc,EAAKA,YAAYhF,KAAjB,gBACnB,EAAKiF,QAAU,EAAKA,QAAQjF,KAAb,gBACf,EAAKkF,eAAiB,EAAKA,eAAelF,KAApB,gBACtB,EAAKmF,iBAAmB,EAAKA,iBAAiBnF,KAAtB,gBACxB,EAAKoF,gBAAkB,EAAKA,gBAAgBpF,KAArB,gBAnBL,E,kFAsBnB,mCAAAyB,EAAA,sEACO,IAAI4D,SAAQ,SAAAC,GAAO,OAAIC,WAAWD,EAAS,QADlD,cAEKjF,EAAO,GAFZ,SAGcJ,IAAMC,IAAI,oBACrBC,MAAK,SAAAC,GACL,OAAOA,EAASC,QAEhBmF,OAAM,SAAAC,GACNxC,QAAQC,IAAIuC,GACZ,EAAK/G,MAAMgH,QAAQC,KAAK,QAT3B,OAGCtF,EAHD,OAWC5B,KAAKiC,SAAS,CAAE+D,MAAOpE,IAXxB,gD,qFAcA,WACC5B,KAAKwG,Y,4BAGN,WAAkB,IAAD,OAChBxG,KAAKiC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJgC,OAAO,QAGTY,YAAW,WACV,EAAK7E,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJgC,OAAO,UAGP,O,8BAGJ,WAAoB,IAAD,OAClBlG,KAAKiC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJiC,SAAS,QAGXW,YAAW,WACV,EAAK7E,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJiC,SAAS,UAGT,O,6BAGJ,WAAmB,IAAD,OACjBnG,KAAKiC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJkC,QAAQ,QAGVU,YAAW,WACV,EAAK7E,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJkC,QAAQ,UAGR,O,wBAGJ,WAAc,IAAD,OACNH,EAAejG,KAAKoB,MAAM6E,aAChCzE,IAAM6C,KAAK,eAAgB,CAC1B4B,iBAECvE,MAAK,SAACC,GACFA,IACCsE,EAAakB,SAASC,SAAS,EAAKnH,MAAMoH,SAC7C,EAAKC,qBAGL,EAAKb,iBACL,EAAKD,iB,0BAMV,WAAgB,IAAD,OACRP,EAAejG,KAAKoB,MAAM6E,aAChCzE,IAAM6C,KAAK,iBAAkB,CAC5B4B,iBAECvE,MAAK,SAACC,GACFA,IACH,EAAK+E,mBACL,EAAKF,gB,yBAKT,WAAe,IAAD,OACPP,EAAejG,KAAKoB,MAAM6E,aAChCzE,IAAM6C,KAAK,gBAAiB,CAC3B4B,iBACEvE,MAAK,SAACC,GACJA,IACCsE,EAAakB,SAASC,SAAS,EAAKnH,MAAMoH,SAC7C,EAAKC,qBAGL,EAAKX,kBACL,EAAKH,iB,oBAMT,WAAU,IAAD,OACR,OACC,sBAAK1G,UAAU,iBAAf,UACC,cAACyH,EAAA,EAAD,CAAOnC,KAAMpF,KAAKoB,MAAM8C,MAAMgC,MAAOsB,QAAQ,SAA7C,SACC,oDAID,cAACD,EAAA,EAAD,CAAOnC,KAAMpF,KAAKoB,MAAM8C,MAAMiC,QAASqB,QAAQ,SAA/C,SACC,sDAID,cAACD,EAAA,EAAD,CAAOnC,KAAMpF,KAAKoB,MAAM8C,MAAMkC,OAAQoB,QAAQ,SAA9C,SACC,oDAID,sBAAK1H,UAAU,iBAAiB2H,KAAK,QAArC,UACC,wBAAQ3C,QAAS9E,KAAKqG,WAAY1B,KAAK,SAAS7E,UAAU,0BAA1D,mBACA,wBAAQgF,QAAS9E,KAAKsG,aAAc3B,KAAK,SAAS7E,UAAU,0BAA5D,qBACA,wBAAQgF,QAAS9E,KAAKuG,YAAa5B,KAAK,SAAS7E,UAAU,yBAA3D,uBAED,cAAC,IAAD,CACC4H,SAAS,KACTC,iBAAiB,iBACjB/F,KAAM5B,KAAKoB,MAAM4E,MACjBJ,QAASA,EACTgC,WAAY,CAAC,GACbC,eAAe,mBACfC,UAAW,CACVC,KAAM,WACNC,eAAe,EACfC,YAAa,SAACnC,EAAKoC,EAAMC,GACxB,GAAIrC,EAAK,CAAC,IAAD,gBACMoC,GADN,yBACCE,EADD,QAEP,EAAKnG,UAAS,SAAAsC,GAAS,MAAK,CAC3B0B,aAAa,GAAD,mBAAM1B,EAAU0B,cAAhB,CAA8BmC,EAAEvF,UAF9C,2BAAqB,IADb,oCAOR,EAAKZ,SAAS,CAAEgE,aAAc,MAGhCoC,SAAU,SAACvC,EAAKqC,GACXA,EACH,EAAKlG,UAAS,SAAAsC,GAAS,MAAK,CAC3B0B,aAAa,GAAD,mBAAM1B,EAAU0B,cAAhB,CAA8BH,EAAIjD,SAG/C,EAAKZ,SAAS,CACbgE,aAAc,EAAK7E,MAAM6E,aAAa1D,QAAO,SAAU0D,GACtD,OAAOA,IAAiBH,EAAIjD,mB,GAtMlBrC,aAkNLC,cAAWsF,G,wEClNpBuC,E,kDACJ,aAAe,IAAD,8BACZ,gBAcFC,aAAe,SAAAC,GACb,EAAKvG,SAAL,eAAiBuG,EAAEzE,OAAO7B,KAAOsG,EAAEzE,OAAOpD,SAd1C,EAAKS,MAAQ,CACXyB,QAAI4F,EACJC,eAAWD,EACXzE,SAAU,GACV2E,gBAAiB,GACjBhD,MAAO,GACPiD,aAAc,GACdC,MAAO,GACPC,WAAW,GAEb,EAAKC,SAAW,EAAKA,SAASxH,KAAd,gBAZJ,E,4CAmBd,WAAY,IAAD,OACHyC,EAAWhE,KAAKC,MAAM+I,MAAMC,OAAOpG,GACzCrB,IACGC,IAAI,kBAAmB,CACtBwH,OAAQ,CACNjF,SAAUA,KAGbtC,MAAK,SAAAC,GACJ,EAAKM,SAAS,CAAE4G,MAAOlH,EAASC,Y,wBAItC,SAAWiB,GAAK,IAAD,OACPqG,EAAKrG,EACXrB,IACG6C,KAAK,mBAAoB,CAAC6E,OAC1BxH,MAAK,SAAAC,GACJ,EAAKM,SAAS,CACZ4G,MAAO,EAAKzH,MAAMyH,MAAMtG,QAAO,SAAAC,GAAI,OAAIA,EAAKK,KAAOqG,Y,yBAM3D,WAAe,IAAD,OACZ1H,IACGC,IAAI,kBACJC,MAAK,SAAAC,GACqB,UAAzBA,EAASC,KAAKuH,OACjB,EAAKlH,SAAS,CACPY,GAAIlB,EAASC,KAAKiB,GAClBmB,SAAUrC,EAASC,KAAKoC,SACxB2B,MAAOhE,EAASC,KAAK+D,MACrB8B,KAAM9F,EAASC,KAAK6F,OACxB,kBAAM,EAAKxF,SAAS,CAAE6G,WAAW,OAE/B,EAAK7G,SAAS,CAAE6G,WAAW,S,4BAKnC,WAAkB,IAAD,OACftH,IACGC,IAAI,oBACH,CACEwH,OAAQ,CACNjF,SAAUhE,KAAKC,MAAM+I,MAAMC,OAAOpG,MAGvCnB,MAAK,SAAAC,GACJ,EAAKM,SAAS,CACZyG,UAAW/G,EAASC,KAAKiB,GACzB8F,gBAAiBhH,EAASC,KAAKoC,SAC/B4E,aAAcjH,EAASC,KAAK+D,a,+BAKpC,WACE3F,KAAK+I,WACL/I,KAAKoJ,iBACLpJ,KAAKqJ,gB,oBAGP,WAAU,IAAD,OACCP,EAAc9I,KAAKoB,MAAnB0H,UACR,GAAIA,EACF,OAAO,8BACL,cAACQ,EAAA,EAAD,CAASC,UAAU,SAAS9B,KAAK,SAAjC,SACE,sBAAM3H,UAAU,UAAhB,4BAKN,IAAKgJ,IAAc9I,KAAKoB,MAAMsH,UAC5B,OAAQ,8BACE,oBAAI5I,UAAU,mBAAd,uCAMZ,IAAM8F,EAAU,CACd,CACE4D,UAAW,QACXC,KAAM,QACN/G,MAAM,GAER,CACE8G,UAAW,QACXC,KAAM,SAER,CACED,UAAW,OACXC,KAAM,OACNC,UAAW,SAAC7D,EAAMC,GAAP,OAAeD,EAAOA,EAAKhE,KAAI,SAAC8H,EAAO/G,GAAY,OAAQ,cAACgH,EAAA,EAAD,CAAmB9J,UAAU,WAAW0H,QAAQ,YAAhD,SAA6DmC,EAAMA,OAAvD/G,MAA4E,YAEhK,CACE4G,UAAW,SACXC,KAAM,SACNC,UAAW,SAAC7D,EAAMC,GAAP,OAAmC,IAApBA,EAAI5C,aAAqB2C,EAAOC,EAAI5C,aAAahC,YAAY,GAAK,GAC5FwB,MAAM,GAER,CACE8G,UAAW,YACXC,KAAM,mBACNC,UAAW,SAAC7D,EAAMC,GAAP,OAAe,IAAIzF,KAAKwF,GAAMtF,sBACzCmC,MAAM,GAER,CACE8G,UAAW,OACXC,KAAM,GACNI,MAAO,SACPH,UAAW,SAAC7D,EAAMC,GAAP,OACT,cAAC,IAAD,CAAM/F,GAAI,CAAE+J,SAAS,SAAD,OAAWhE,EAAI5F,OAASkB,MAAO,CAAE2I,OAAQjE,EAAI5F,QAAjE,SACE,cAAC8J,EAAA,EAAD,CAAQxC,QAAQ,YAAhB,qBAIJyC,OAASjK,KAAKoB,MAAM4C,WAAahE,KAAKoB,MAAMuH,iBAAuC,UAApB3I,KAAKC,MAAMwH,MAE5E,CACE+B,UAAW,OACXC,KAAM,GACNI,MAAO,SACPH,UAAW,SAAC7D,EAAMC,GAAP,OACT,cAAC,IAAD,CAAM/F,GAAE,gBAAW+F,EAAI5F,OAAvB,SACE,cAAC8J,EAAA,EAAD,CAAQxC,QAAQ,YAAhB,sBAKN,CACEgC,UAAW,SACXC,KAAM,GACNI,MAAO,SACPH,UAAW,SAAC7D,EAAMC,GAAP,OAAe,eAACkE,EAAA,EAAD,CAAQlF,QAAS,kBAAM,EAAKoF,WAAWpE,EAAIjD,KAA3C,cAAiD,cAAC,IAAD,IAAjD,QAC1BoH,OAAQjK,KAAKoB,MAAM4C,WAAahE,KAAKoB,MAAMuH,kBAI/C,OACE,mCACE,eAACwB,EAAA,EAAD,CAAWrK,UAAU,iBAArB,UACE,sBAAKA,UAAU,WAAf,UACE,qBAAKA,UAAU,OAAOkF,MAAO,CAC3BoF,SAAU,GACVC,WAAY,OACZC,MAAO,QAHT,uBAOA,qBAAKxK,UAAU,WAAf,SACE,cAACyK,EAAA,EAAKC,QAAN,CAAc7F,KAAK,OAAOC,YAAa5E,KAAKoB,MAAMuH,gBAAiB8B,UAAQ,SAG/E,sBAAK3K,UAAU,WAAf,UACE,qBAAKA,UAAU,OAAOkF,MAAO,CAC3BoF,SAAU,GACVC,WAAY,QAFd,oBAMA,qBAAKvK,UAAU,WAAf,SACE,cAACyK,EAAA,EAAKC,QAAN,CAAc7F,KAAK,OAAOC,YAAa5E,KAAKoB,MAAMwH,aAAc6B,UAAQ,SAI5E,sBAAK3K,UAAU,iBAAf,UACIE,KAAKoB,MAAM4C,WAAahE,KAAKC,MAAM+I,MAAMC,OAAOpG,GAC9C,qBAAK/C,UAAU,YAAf,SACA,cAAC,IAAD,CAAMC,GAAI,cAAV,SACE,cAACiK,EAAA,EAAD,CAAQlK,UAAU,YAAY0H,QAAQ,kBAAtC,+BAKF,KAGJ,cAAC,IAAD,CACEkD,YAAU,EACVhD,SAAS,KACTC,iBAAiB,iBACjB/F,KAAM5B,KAAKoB,MAAMyH,MACjBjD,QAASA,EACT+E,cAAe,CAAC,CACdnB,UAAW,YACXoB,MAAO,SAET/C,eAAe,mBACfgD,WAAYC,oB,GApNJtK,aA6NPC,cAAW6H,G,2IC1NXyC,GAZA,CACb,CAAEpK,MAAO,UAAWgJ,MAAO,WAC3B,CAAEhJ,MAAO,SAAUgJ,MAAO,UAC1B,CAAEhJ,MAAO,YAAagJ,MAAO,aAC7B,CAAEhJ,MAAO,YAAagJ,MAAO,aAC7B,CAAEhJ,MAAO,UAAWgJ,MAAO,WAC3B,CAAEhJ,MAAO,SAAUgJ,MAAO,UAC1B,CAAEhJ,MAAO,SAAUgJ,MAAO,UAC1B,CAAEhJ,MAAO,WAAYgJ,MAAO,YAC5B,CAAEhJ,MAAO,SAAUgJ,MAAO,W,cCM5BnI,IAAMkC,SAASC,iBAAkB,EAEjC,IAYMqH,GAAW,SAAAC,GAMhB,OALkBA,EAAKpJ,KAAI,SAACqJ,EAAItI,GAC/B,IAAMsG,EAAKgC,EAEX,OADAhC,EAAGiC,UAAYvI,EAAQ,EAChBsG,MAKHkC,GAAa,SAAAH,GAMlB,OALkBA,EAAKpJ,KAAI,SAACqJ,EAAItI,GAC/B,IAAMV,EAAOgJ,EAEb,OADAhJ,EAAKmJ,YAAczI,EAAQ,EACpBV,MAKHoJ,G,kDACL,WAAYrL,GAAQ,IAAD,8BAClB,cAAMA,IA+EPsL,kBAAoB,SAAC/C,EAAG5F,GACvB,IAAM4I,EAAW,EAAKpK,MAAMoK,SAC5BA,EAAS5I,GAAO6G,KAAOjB,EACvB,EAAKvG,SAAS,CAAEuJ,cAnFE,EA4FnBC,gBAAkB,SAAAC,GACjB,EAAKzJ,SAAS,CAAEyJ,eA7FE,EA8GnBC,cAAgB,SAAA9I,GACf,IAAM2I,EAAW,EAAKpK,MAAMoK,SAASjJ,QAAO,SAACqJ,GAAD,OAAaA,EAAQT,YAActI,KAC/E,EAAKZ,SAAS,CAAEuJ,SAAUA,KA9G1B,EAAKpK,MAAQ,CACZyK,UAAU,EACV/C,WAAW,EACXgD,UAAU,EACVC,OAAQ,GACRhK,KAAM,GACNV,QAAS,GACT2K,MAAO,GACPC,UAAW,QACXC,KAAM,GACNhM,MAAO,GACPC,OAAQ,GACRgM,SAAU,GACVX,SAAU,CACT,CACCL,UAAW,EACXtI,GAAI,GACJwI,YAAa,IACb5B,KAAM,GACN2C,OAAQ,MAIX,EAAKC,WAAa,EAAKA,WAAW9K,KAAhB,gBAClB,EAAK+K,WAAa,EAAKA,WAAW/K,KAAhB,gBAClB,EAAKgL,UAAY,EAAKA,UAAUhL,KAAf,gBACjB,EAAKiL,WAAa,EAAKA,WAAWjL,KAAhB,gBAClB,EAAKoK,cAAgB,EAAKA,cAAcpK,KAAnB,gBACrB,EAAKD,QAAU,EAAKA,QAAQC,KAAb,gBA9BG,E,4CAiCnB,WAAY,IAAD,OACJrB,EAAQF,KAAKC,MAAM+I,MAAMC,OAAOc,OACtC/J,KAAKsB,UACLE,IAAMC,IAAI,iBAAkB,CAC3BwH,OAAQ,CACP/I,MAAOA,KAGPwB,MAAK,SAACC,GACN,EAAKM,SAAS,CACb/B,MAAOyB,EAASC,KAAK1B,MACrB6L,OAAQpK,EAASC,KAAKiB,GACtBd,KAAMJ,EAASC,KAAKG,KACpBiK,MAAOrK,EAASC,KAAKoK,MACrBE,KAAMvK,EAASC,KAAKxB,YACpBD,OAAQwB,EAASC,KAAKzB,OACtBgM,SAAUxK,EAASC,KAAKuK,SACxBX,SAAU7J,EAASC,KAAK6K,WAExB,YACK,EAAKrL,MAAMoK,UAAiC,UAApB,EAAKvL,MAAMwH,MAAoB,EAAKxH,MAAMyM,OAAS,EAAKtL,MAAMjB,OAQzF,EAAKF,MAAMgH,QAAQC,KAAK,MAPxB,EAAK9F,MAAMoK,SAAS3J,KAAI,SAAC+J,GAGxB,cAFOA,EAAO,iBACPA,EAAO,UACPA,KAER,EAAK3J,SAAS,CAAE6G,WAAW,a,uBAQjC,SAAU6D,GACT,GAAKA,EAAOC,YAAZ,CAGA,IAAMpB,EAjGQ,SAACP,EAAM4B,EAAYC,GAClC,IAAMH,EAAS1B,EADgC,EAE7B0B,EAAOI,OAAOF,EAAY,GAArCG,EAFwC,oBAI/C,OADAL,EAAOI,OAAOD,EAAU,EAAGE,GACpB5B,GAAWJ,GAAS2B,IA6FTM,CAChBjN,KAAKoB,MAAMoK,SACXmB,EAAOO,OAAOtK,MACd+J,EAAOC,YAAYhK,OAGpB5C,KAAKiC,SAAS,CAAEuJ,SAAUA,O,wBAmB3B,WAEC,IAAM2B,EAAgBnN,KAAKoB,MAAMoK,SAAS4B,OAAS,EAC7C5B,EAAWxL,KAAKoB,MAAMoK,SACtBI,EAAU,CACfQ,OAAQpM,KAAKoB,MAAM2K,OACnBZ,UAAWgC,EACX9B,YAAa8B,EAAcE,WAC3B5D,KAAM,IAEP+B,EAAStE,KAAK0E,GACd5L,KAAKiC,SAAS,CAAEuJ,SAAUA,M,+BAQ3B,WAAqB,IAAD,OACnBxL,KAAKiC,SAAS,CAAE9B,OAAQH,KAAKC,MAAMyM,KAAMP,SAAUnM,KAAKC,MAAMoH,SAC1DrH,KAAKC,MAAMqN,SAASxD,WAApB,gBAA0C9J,KAAKC,MAAM+I,MAAMC,OAAOc,QACrE/J,KAAKiC,SAAS,CAAE4J,UAAU,IAAQ,kBAAM,EAAK0B,cAE7CvN,KAAKiC,SAAS,CAAE6G,WAAW,M,wBAI7B,WAAc,IAAD,EASR9I,KAAKoB,MAPRjB,EAFW,EAEXA,OACAgM,EAHW,EAGXA,SACApK,EAJW,EAIXA,KACAiK,EALW,EAKXA,MACAE,EANW,EAMXA,KACAhM,EAPW,EAOXA,MACAsL,EARW,EAQXA,SAEDhK,IAAM6C,KAAK,mBAAoB,CAC9BlE,SAAQgM,WAAUpK,OAAMiK,QAAOE,OAAMhM,QAAOsL,aAE3C9J,MAAK,SAACC,OACR3B,KAAKC,MAAMgH,QAAQC,KAAnB,gBAAiChH,M,wBAGlC,WAAc,IAAD,EAURF,KAAKoB,MARRjB,EAFW,EAEXA,OACAgM,EAHW,EAGXA,SACApK,EAJW,EAIXA,KACAiK,EALW,EAKXA,MACAE,EANW,EAMXA,KACAhM,EAPW,EAOXA,MACA6L,EARW,EAQXA,OACAP,EATW,EASXA,SAEDhK,IAAM6C,KAAK,mBAAoB,CAC9BlE,SAAQgM,WAAUpK,OAAMiK,QAAOE,OAAMhM,QAAO6L,SAAQP,aAEpD9J,MAAK,SAACC,OACP3B,KAAKC,MAAMgH,QAAQC,KAAnB,gBAAiChH,M,qBAGlC,WAAW,IAAD,OACTsB,IAAMC,IAAI,iBACTC,MAAK,SAACC,GACNA,EAASC,KAAKC,KAAI,SAAAC,GAEjB,OADGA,EAAIC,MAAQD,EAAIC,KAAKF,KAAI,SAACG,GAA4G,cAAzFA,EAAK,aAAkB,EAAKC,UAAS,SAAAb,GAAK,MAAK,CAAEC,QAAQ,GAAD,mBAAMD,EAAMC,SAAZ,CAAqBW,QAAmBA,KACzIF,U,oBAKV,WAAU,IAxMKuB,EAwMN,OAER,OADsBrD,KAAKoB,MAAnB0H,UAEA,8BACN,cAACQ,EAAA,EAAD,CAASC,UAAU,SAAS9B,KAAK,SAAjC,SACC,sBAAM3H,UAAU,UAAhB,4BAMF,mCACC,sBAAKA,UAAU,OAAf,UACC,eAACyK,EAAA,EAAD,WACC,eAACA,EAAA,EAAKiD,MAAN,CAAYC,GAAIC,IAAhB,UACC,cAACnD,EAAA,EAAKoD,MAAN,CAAYC,QAAM,EAACC,GAAI,EAAvB,mBAGA,cAACC,EAAA,EAAD,CAAKD,GAAI,EAAT,SACC,cAACtD,EAAA,EAAKC,QAAN,CACC7J,MAAOX,KAAKoB,MAAMlB,MAClB2E,SAAU,SAAAf,GAAW,EAAK7B,SAAS,CAAE/B,MAAO4D,EAAMC,OAAOpD,SACzDgE,KAAK,cAKR,eAAC4F,EAAA,EAAKiD,MAAN,CAAYC,GAAIC,IAAhB,UACC,cAACnD,EAAA,EAAKoD,MAAN,CAAYC,QAAM,EAACC,GAAI,EAAvB,yBAGA,cAACC,EAAA,EAAD,CAAKD,GAAI,EAAT,SACC,cAACtD,EAAA,EAAKC,QAAN,CACCiD,GAAG,WACHvF,KAAM,EACNvH,MAAOX,KAAKoB,MAAM8K,KAClBrH,SAAU,SAAAf,GAAW,EAAK7B,SAAS,CAAEiK,KAAMpI,EAAMC,OAAOpD,SACxDgE,KAAK,cAKR,eAAC4F,EAAA,EAAKiD,MAAN,CAAYC,GAAIC,IAAhB,UACC,cAACnD,EAAA,EAAKoD,MAAN,CAAYC,QAAM,EAACC,GAAI,EAAvB,kBAGA,cAACC,EAAA,EAAD,CAAKD,GAAI,EAAT,SACC,cAAC,WAAD,UACC,cAAC,KAAD,2BACK7N,KAAKoB,OADV,IAEC2M,UAAU,EACVC,qBAAqB,EACrBC,mBAAmB,kBACnBpL,GAAG,aACHqL,gBAAiBlO,KAAKoB,MAAMW,KAAO/B,KAAKoB,MAAMW,KAAO,GACrDoM,QAASnO,KAAKoB,MAAMC,QAAQ+L,OAAS,GA/P/B/J,EA+P0CrD,KAAKoB,MAAMC,QA9P7D,YAAI,IAAIiC,IAAID,EAAIxB,KAAI,SAAC0B,GAAD,OAAOpB,KAAKqB,UAAUD,QAC/C1B,KAAI,SAAC4B,GAAD,OAAYtB,KAAKC,MAAMqB,OA6PkD,GACtE2K,SAAS,QACTvJ,SAAU,SAAC9C,GAAD,OAAU,EAAKE,SAAS,CAAEF,UACpC6C,YAAY,kBACZyJ,YAAa,SAACC,EAAD,EAAuB1L,GAAW,IAAvB2L,EAAsB,EAAtBA,SACvB,OACC,cAAC,KAAD,CAAmBD,OAAQA,EAAQC,SAAUA,EAA7C,mBACKD,EAAO3N,QADAiC,cAUlB,eAAC2H,EAAA,EAAKiD,MAAN,CAAYC,GAAIC,IAAhB,UACC,cAACnD,EAAA,EAAKoD,MAAN,CAAYC,QAAM,EAACC,GAAI,EAAvB,mBAGA,cAACC,EAAA,EAAD,CAAKD,GAAI,EAAT,SACC,cAAC,KAAD,CACCW,aAAc,CAAC7N,MAAO,UAAWgJ,MAAO3J,KAAKoB,MAAM4K,OAEnDnH,SAAU,SAACmH,GAAD,OAAW,EAAK/J,SAAS,CAAE+J,WACrCyC,cAAc,EACdN,QAASpD,aAMb,cAAC2D,GAAA,EAAD,CAAM1J,MAAO,CAAE2J,SAAU,WAAa7J,QAAS9E,KAAKwM,WAApD,SACC,cAACkC,GAAA,EAAKlJ,OAAN,CAAaiI,GAAIzD,IAAQxC,QAAQ,QAAjC,SACC,cAAC,IAAD,QAIF,cAAC,KAAD,CAAiB+E,UAAWvM,KAAKuM,UAAjC,SACC,cAAC,KAAD,CAAWqC,YAAY,YAAvB,SACE,SAACC,GAAD,OACA,6CAAK/O,UAAU,UACV+O,EAASC,gBADd,IAECC,IAAKF,EAASG,SAFf,SAIC,eAACC,GAAA,EAAD,WACG,EAAK7N,MAAMoK,SAAU3J,KAAI,SAACqN,EAAKtM,GAAN,OAC1B,cAAC,KAAD,CAECuM,YAAaD,EAAI/D,UAAUkC,WAC3BzK,MAAOA,EAHR,SAKE,SAACiM,GAAD,OACA,yDACCE,IAAKF,EAASG,UACVH,EAASO,gBACTP,EAASQ,iBAHd,aAKC,eAACX,GAAA,EAAD,CAAkB1J,MAAO,CAAE2J,SAAU,WAArC,UACC,eAACD,GAAA,EAAKlJ,OAAN,CAAaR,MAAO,CAAEsK,QAAS,OAAQC,WAAY,SAAUC,OAAQ,KAArE,UACC,cAACC,GAAA,EAAD,CAAiBhC,GAAIzD,IAAQxC,QAAQ,OAAOkI,SAAUR,EAAI/D,UAA1D,SACE,EAAK/J,MAAMyK,SAAX,kBAAiCqD,EAAI/D,WAArC,kBAA8D+D,EAAI7D,eAElEzI,EAAQ,IAAM,EAAKxB,MAAMoK,SAAS4B,OACjC,cAACpD,EAAA,EAAD,CAAQxC,QAAQ,OAAO1C,QAAS,WAAQ,EAAK6G,cAAcuD,EAAI/D,YAAcnG,MAAO,CAAE2K,WAAY,QAAlG,SACD,cAAC,IAAD,MAEC,QAGJ,cAACC,GAAA,EAAD,CAAmBF,SAAUR,EAAI/D,UAAjC,SACC,cAAC,KAAD,CACCxK,MAAO,EAAKS,MAAMoK,SAAS5I,GAAO6G,KAClC5E,SACC,SAAA2D,GACC,EAAK+C,kBAAkB/C,EAAG5F,IAG5BiN,YAAa,EAAKzO,MAAMsK,UACxBoE,YAAa,EAAKrE,gBAClBsE,wBAAyB,SAACC,GAAD,OACxBpJ,QAAQC,QAAQ,cAAC,KAAD,CAAeqG,OAAQ8C,YAvBhCpN,QAVRsM,EAAI/D,cA0CV0D,EAASjK,uBAOf,qBAAK9E,UAAU,OAAf,SACEE,KAAKoB,MAAMyK,SACT,cAAC7B,EAAA,EAAD,CAAQlF,QAAS9E,KAAKsM,WAAY9E,QAAQ,kBAA1C,oBACA,cAACwC,EAAA,EAAD,CAAQlF,QAAS9E,KAAKqM,WAAY7E,QAAQ,kBAA1C,gC,GArUgBhH,aA8UVC,eAAW6K,I,UC5WX2E,G,4JAdb,WACE,OACE,sBAAKnQ,UAAU,WAAf,UACE,qBAAKA,UAAU,WAAf,SACGE,KAAKC,MAAM0J,QAEd,8BACG3J,KAAKC,MAAMU,e,GARCH,a,8BCMjB0P,I,8EACJ,WAAYjQ,GAAQ,IAAD,8BACjB,cAAMA,IAQRkQ,GAAK,IAAIC,UAAUC,OAAO/C,SAASgD,OAAOC,QAAQ,QAAS,MAAxC,WAAkD,EAAKtQ,MAAM8L,SAT7D,EAWnBlI,kBAAoB,SAACC,GACnBA,EAAM0M,iBACN,EAAKvO,SAAL,eACG6B,EAAMC,OAAO7B,KAAO4B,EAAMC,OAAOpD,SAdnB,EAmCnB8P,sBAAwB,SAAAC,GACtB,EAAKzO,UAAS,SAAAb,GAAK,MAAK,CAAEsP,SAAUA,OAlCpC,EAAKtP,MAAQ,CACXsP,SAAU,GACVC,QAAS,IAJM,E,qDAkBnB,WAAqB,IAAD,OAClB3Q,KAAKmQ,GAAGS,OAAS,WACfpM,QAAQC,IAAI,wBAEdzE,KAAKmQ,GAAGU,UAAY,SAAAC,GAClB,IAAMH,EAAUxO,KAAKC,MAAM0O,EAAIlP,MAC/B,EAAK6O,sBAAsBE,IAE7B3Q,KAAKmQ,GAAGY,QAAU,WAChBvM,QAAQC,IAAI,4BACZ,EAAKxC,SAAS,CACZkO,GAAI,IAAIC,UAAUC,OAAO/C,SAASgD,OAAOC,QAAQ,QAAS,MAAxC,WAAkD,EAAKtQ,MAAM8L,c,sBAUrF,WACE,GAAI/L,KAAKoB,MAAMuP,QAAS,CACtB,IAAMA,EAAU,CACdxQ,OAAQH,KAAKC,MAAM+D,SACnBgN,OAAQhR,KAAKC,MAAMoH,OACnB+E,OAAQpM,KAAKC,MAAM8L,OACnBtC,KAAMzJ,KAAKoB,MAAMuP,SAEnB3Q,KAAKmQ,GAAGc,KAAK9O,KAAKqB,UAAUmN,IAC5B3Q,KAAKiC,SAAS,CAAE0O,QAAS,Q,oBAI7B,WAAU,IAAD,OACP,OACE,gCACE,cAACO,GAAA,EAAQ1D,MAAT,CAAexM,KAAK,QAApB,SACGhB,KAAKoB,MAAMsP,SAAS7O,KAAI,SAAC8O,EAAS/N,GAAV,OACvB,cAACsO,GAAA,EAAD,UACE,eAACA,GAAA,EAAQC,QAAT,WACE,cAACD,GAAA,EAAQE,OAAT,CAAgB3D,GAAG,IAAnB,SAAwBkD,EAAQxQ,SAChC,cAAC+Q,GAAA,EAAQG,SAAT,UACE,8BAAM,IAAIhR,KAAKsQ,EAAQ5N,WAAWuO,eAAe,aAEnD,cAACJ,GAAA,EAAQK,KAAT,UAAeZ,EAAQlH,WANb7G,QAWjB5C,KAAKC,MAAM+D,SACV,eAAC,KAAD,CAAMwN,OAAK,EAAX,UACE,cAAC,KAAKC,SAAN,CACE9Q,MAAOX,KAAKoB,MAAMuP,QAClB9L,SAAU,SAAA2D,GAAC,OAAI,EAAK3E,kBAAkB2E,IACtCtG,KAAK,UACLoI,MAAO,IAET,cAAC,KAAD,CACE6F,GAAInQ,KAAKmQ,GACTrL,QAAS,kBAAM,EAAK4M,YACpBC,QAAQ,YACRC,cAAc,OACdC,KAAK,OACL7Q,KAAK,QACL8Q,SAAO,OAGT,Y,GAvFkBtR,cA6FfC,eAAWyP,IC3F1B1O,IAAMkC,SAASC,iBAAkB,E,IAE3BoO,G,kDACL,WAAY9R,GAAQ,IAAD,8BAClB,cAAMA,IA4DP+R,aAAe,WACd,IAAIxG,EAAW,GASf,OARI,EAAKpK,MAAMoB,KAAKiK,UACnB,EAAKrL,MAAMoB,KAAKiK,SAAS5K,KAAI,SAAC+J,EAAShJ,GAItC,OAHA4I,EAAStE,KACR,cAAC+K,GAAA,EAAWC,KAAZ,CAAiBpN,QAAS,WAAQ,EAAKqN,cAAcvP,GAAQ,EAAKX,SAAS,CAAEyO,UAAU,KAAvF,SAAgH9N,EAAQ,GAAhBA,IAElG4I,KAGFA,GArEP,EAAKpK,MAAQ,CACZ0H,WAAW,EACXtG,KAAM,GACN5B,YAAQ6H,EACR2J,WAAY,GACZC,UAAU,EACV3B,UAAU,GAEX,EAAK4B,UAAY,EAAKA,UAAU/Q,KAAf,gBACjB,EAAKgR,cAAgB,EAAKA,cAAchR,KAAnB,gBACrB,EAAK4Q,cAAgB,EAAKA,cAAc5Q,KAAnB,gBACrB,EAAKyQ,aAAe,EAAKA,aAAazQ,KAAlB,gBACpB,EAAKiR,QAAU,EAAKA,QAAQjR,KAAb,gBAdG,E,qDAiBnB,gBACyBkH,IAApBzI,KAAKC,MAAMyM,MACd1M,KAAKiC,SAAS,CAAEoQ,UAAU,IAE3BrS,KAAKuN,a,qBAGN,WAAW,IAAD,OACHxB,EAAS/L,KAAKoB,MAAMoB,KAAKK,GACzBsJ,EAAWnM,KAAKC,MAAMoH,OAC5B7F,IAAMC,IAAI,gBAAiB,CAC1BwH,OAAQ,CACPkD,WAAUJ,YAGVrK,MAAK,SAACC,GACN6C,QAAQC,IAAI9C,GACRA,EAASC,KAAK0C,QACjB,EAAKrC,SAAS,CAAEoQ,UAAU,IACzB,kBAAM,EAAKpQ,SAAS,CAAE6G,WAAW,OAElC,EAAK7G,SAAS,CAAE6G,WAAW,S,6DAK/B,mCAAA9F,EAAA,6DACO9C,EAAQF,KAAKC,MAAM+I,MAAMC,OAAOc,OADvC,SAEOvI,IAAMC,IAAI,iBAAkB,CACjCwH,OAAQ,CACP/I,MAAOA,KAGPwB,MAAK,SAACC,GACN,EAAKM,SAAS,CAAEO,KAAMb,EAASC,OAC7B,WAAY,EAAK3B,MAAMyM,KAAQ,EAAK8F,UAAmB,EAAKvQ,SAAS,CAAE6G,WAAW,UAEpF/B,OAAM,SAAAC,GAAG,OAAIxC,QAAQC,IAAIuC,MAX5B,gD,iFAcA,SAAcpE,GACb5C,KAAKiC,SAAS,CAAEmQ,WAAYxP,M,uBAgB7B,SAAUjC,GACLX,KAAKC,MAAMyM,KACd1M,KAAKiC,SAAS,CACbrB,OAAQD,IAYT6D,QAAQC,IAAI,wC,2BAId,WACC,GAAIzE,KAAKC,MAAMyM,KAAM,CACpB,IAAMvM,EAASH,KAAKC,MAAMyM,KACpBX,EAAS/L,KAAKoB,MAAMoB,KAAKK,GACzBjC,EAASZ,KAAKoB,MAAMoB,KAAK5B,OACzBuL,EAAWnM,KAAKC,MAAMoH,OACtBnE,EAAclD,KAAKoB,MAAMoB,KAAKU,YACpC1B,IAAM6C,KAAK,kBAAmB,CAC7BlE,SAAQgM,WAAUJ,SAAQnL,SAAQsC,gBAEjCxB,MAAK,SAACC,GACN6C,QAAQC,IAAI9C,WAGd6C,QAAQC,IAAI,wC,oBAId,WAAU,IAAD,OAER,OADsBzE,KAAKoB,MAAnB0H,UAEA,8BACN,cAACQ,EAAA,EAAD,CAASC,UAAU,SAAS9B,KAAK,SAAjC,SACC,sBAAM3H,UAAU,UAAhB,4BAKEE,KAAKoB,MAAMoB,KASf,mCACC,eAAC2H,EAAA,EAAD,CAAWrK,UAAU,YAArB,UACC,cAAC,GAAD,CACC6J,MAAO,SACPhJ,MAAOX,KAAKoB,MAAMoB,KAAKtC,QAExB,cAAC,GAAD,CACCyJ,MAAO,UACPhJ,MAAOX,KAAKoB,MAAMoB,KAAKrC,SAExB,cAAC,GAAD,CACCwJ,MAAO,eACPhJ,MAAOX,KAAKoB,MAAMoB,KAAKpC,cAExB,cAAC,GAAD,CACCuJ,MAAO,SACPhJ,MAAOX,KAAKoB,MAAMoB,KAAKwJ,QAExB,sBAAKlM,UAAU,WAAf,UACC,qBAAKA,UAAU,WAAf,mBAGCE,KAAKoB,MAAMoB,KAAKT,KACd/B,KAAKoB,MAAMoB,KAAKT,KAAKF,KAAI,SAACC,EAAKc,GAChC,OAAQ,cAACgH,EAAA,EAAD,CAAmB9J,UAAU,WAAW0H,QAAQ,YAAhD,SACN1F,EAAInB,OADciC,MAInB,QAGJ,sBAAK9C,UAAU,WAAf,UACC,qBAAKA,UAAU,WAAf,qBAIC,cAAC,IAAD,CACCa,MAAOX,KAAKoB,MAAMoB,KAAK5B,OAASZ,KAAKoB,MAAMoB,KAAKU,YAChDpC,MAAO,EACPD,QAAOb,KAAKC,MAAMyM,OAAQ1M,KAAKoB,MAAMiR,UACrCxN,SAAU7E,KAAKsS,UACfvR,QAAQ,EACRC,KAAM,GACNC,YAAY,YAGd,sBAAMnB,UAAU,YAAhB,SAA6BE,KAAKoB,MAAMoB,KAAK5B,QAAUZ,KAAKoB,MAAMoB,KAAK5B,OAASZ,KAAKoB,MAAMoB,KAAKU,aAAahC,YAAY,GAAK,IAC9H,cAAC8I,EAAA,EAAD,CACClK,UAAU,WACVgF,QACC,kBAAM,EAAK7C,UAAS,SAAAsC,GAAS,MAAK,CACjC/B,KAAK,2BAED+B,EAAU/B,MAFV,IAGH5B,OAAQ,EAAKQ,MAAMiR,SAAW9N,EAAU/B,KAAK5B,OAAS,EAAKQ,MAAMR,OAAS2D,EAAU/B,KAAK5B,OACzFsC,YAAa,EAAK9B,MAAMiR,SAAW9N,EAAU/B,KAAKU,YAAc,EAAIqB,EAAU/B,KAAKU,cAEpFmP,UAAU,MACP,kBAAM,EAAKE,oBAEhB/K,QAAQ,kBAbT,uBAkBF,sBAAK1H,UAAU,WAAf,UACC,qBAAKA,UAAU,WAAf,uBAGA,eAACmS,GAAA,EAAD,WACEjS,KAAKgS,eACN,cAACC,GAAA,EAAWC,KAAZ,CAAiBpN,QAAS,WAAQ,EAAK7C,SAAS,CAAEyO,UAAU,KAA5D,4BAGD1Q,KAAKoB,MAAMsP,SACT,cAAC,GAAD,CACD1M,SAAUhE,KAAKC,MAAMyM,KACrBrF,OAAQrH,KAAKC,MAAMoH,OACnB0E,OAAQ/L,KAAKoB,MAAMoB,KAAKK,KAEvB,KACwB,KAA1B7C,KAAKoB,MAAMgR,WACT,qBAAKtS,UAAU,YAAf,SACD,cAAC,KAAD,UACEE,KAAKoB,MAAMoB,KAAKiK,SAASrF,SAASpH,KAAKoB,MAAMgR,aAAa3I,SAG3D,UA/FG,8BACN,oBAAI3J,UAAU,mBAAd,kC,GA5HqBU,aAiOVC,eAAWsR,I,UCtNXtR,oBAnBf,YAAiG,IAAhED,EAA+D,EAA1EiS,UAAsB/N,EAAoD,EAApDA,qBAAsBgO,EAA8B,EAA9BA,YAAahG,EAAiB,EAAjBA,KAASiG,EAAQ,0EAC9F,OACE,cAAC,IAAD,2BAAWA,GAAX,IACEC,OAAQ,SAAA3S,GACN,YAAawI,IAATiE,EACK,cAAClM,EAAD,aAAWkE,qBAAsBA,EACtCgO,YAAaA,EACbhG,KAAMA,GACFzM,IAGJ,cAAC,IAAD,CAAUF,GAAG,aC4BV8S,G,kDAtCb,aAAe,IAAD,8BACZ,gBACKzR,MAAQ,CACXoB,UAAMiG,GAER,EAAKqK,QAAU,EAAKA,QAAQvR,KAAb,gBALH,E,2CAQd,SAAQwR,EAASC,GAAM,IAAD,OACpBhT,KAAKiC,SAAS,CAAEO,KAAMuQ,EAAQE,MAAK,SAAArR,GAAI,OAAIA,EAAKiB,KAAOuE,SAAS4L,QAChE,kBAAM,EAAK/Q,SAAS,CAAE6G,WAAW,S,+BAGnC,WACE9I,KAAK8S,QAAQ3Q,KAAKC,MAAMC,aAAaC,QAAQ,UAAWtC,KAAKC,MAAM0M,OAAOoC,O,oBAG5E,WACA,IAAK/O,KAAKoB,MAAMoB,KACd,OAAQ,8BACR,cAAC8G,EAAA,EAAD,CAASC,UAAU,SAAS9B,KAAK,SAAjC,SACC,sBAAM3H,UAAU,UAAhB,4BAJM,IAQC0C,EAASxC,KAAKoB,MAAdoB,KACR,OACE,cAAC,EAAD,CAEEtC,MAAOsC,EAAKtC,MACZE,YAAaoC,EAAKpC,YAClBD,OAAQqC,EAAKrC,OACbG,UAAWkC,EAAKlC,WAJXkC,EAAKK,Q,GA7BGrC,a,kDCaf0S,GAAOC,EAAQ,KACrBA,EAAQ,IAARA,CAA+CD,IAC/CC,EAAQ,IAARA,CAAqCD,IACrCC,EAAQ,IAARA,CAAkCD,IAClC,IAAME,GAAwBF,GAAKG,cAAc,KAAM,MAEvD7R,IAAMkC,SAASC,iBAAkB,E,IAE3B2P,G,kDACL,aAAe,IAAD,8BACb,gBA6HDzP,kBAAoB,SAACC,GACpB,EAAK7B,SAAL,eACE6B,EAAMC,OAAO7B,KAAO4B,EAAMC,OAAOpD,SA9HnC,EAAKS,MAAQ,CACZmS,OAAQ,GACRrP,MAAO,CACNC,OAAO,EACPqP,QAAQ,GAET9G,KAAM,CACL7J,QAAI4F,EACJzE,cAAUyE,EACV9C,WAAO8C,EACPhB,UAAMgB,GAEPK,WAAW,EACX0C,SAAU,GACVkF,SAAU,IAIX,EAAKgC,YAAc,EAAKA,YAAYnR,KAAjB,gBACnB,EAAKkS,aAAe,EAAKA,aAAalS,KAAlB,gBACpB,EAAK+F,kBAAoB,EAAKA,kBAAkB/F,KAAvB,gBACzB,EAAKmD,qBAAuB,EAAKA,qBAAqBnD,KAA1B,gBAC5B,EAAKwH,SAAW,EAAKA,SAASxH,KAAd,gBAChB,EAAKD,QAAU,EAAKA,QAAQC,KAAb,gBACf,EAAKmS,aAAe,EAAKA,aAAanS,KAAlB,gBA1BP,E,wDA6Bd,SAAqBK,GACpB5B,KAAK0S,YAAY9Q,K,0BAGlB,WACC5B,KAAK2T,kBACL3T,KAAKiC,SAAS,CACbyK,KAAM,CACL7J,QAAI4F,EACJzE,cAAUyE,EACV9C,WAAO8C,EACPhB,UAAMgB,KAGRzI,KAAKC,MAAMgH,QAAQC,KAAK,O,6BAGzB,WACClH,KAAKiC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJsP,QAAQ,U,+BAKX,WAAqB,IAAD,OACnBhS,IAAMC,IAAI,gBACRC,MAAK,SAACC,GACN,EAAK8R,oB,4BAIR,WACCzT,KAAKiC,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJC,OAAO,U,yBAKV,SAAYvC,GAAO,IAAD,OACjB5B,KAAK4T,iBACL5T,KAAKiC,SAAS,CACbyK,KAAM,CACL7J,GAAIjB,EAAKiB,GACTmB,SAAUpC,EAAKoC,SACf2B,MAAO/D,EAAK+D,MACZ8B,KAAM7F,EAAK6F,QAEV,kBAAM,EAAKxH,MAAMgH,QAAQC,KAAK,CAChC4C,SAAU,SACV1I,MAAO,CAAEsL,KAAM,EAAKtL,MAAMsL,a,6DAI5B,iCAAA1J,EAAA,sDACCxB,IACEC,IAAI,kBACJC,MAAK,SAAAC,GAELU,aAAawR,QAAQ,QAAS1R,KAAKqB,UAAU7B,EAASC,UAEtDF,MAAK,kBAAM,EAAKO,SAAS,CAAE6G,WAAW,OAPzC,2C,+EAUA,WAAe,IAAD,OACbtH,IACEC,IAAI,kBACJC,MAAK,SAAAC,GAEwB,UAAzBA,EAASC,KAAKuH,QACjB,EAAKlH,SAAS,CACbyK,KAAM,CACL7J,GAAIlB,EAASC,KAAKiB,GAClBmB,SAAUrC,EAASC,KAAKoC,SACxB2B,MAAOhE,EAASC,KAAK+D,MACrB8B,KAAM9F,EAASC,KAAK6F,a,qBAO1B,WAAW,IAAD,OACTjG,IAAMC,IAAI,iBACTC,MAAK,SAACC,GACNA,EAASC,KAAKC,KAAI,SAAAC,GAEjB,OADCA,EAAIC,KAAKF,KAAI,SAACG,GAA4G,cAAzFA,EAAK,aAAkB,EAAKC,UAAS,SAAAb,GAAK,MAAK,CAAEC,QAAQ,GAAD,mBAAMD,EAAMC,SAAZ,CAAqBW,QAAmBA,KAC3HF,U,0BAWV,WAAgB,IACPyR,EAAWvT,KAAKoB,MAAhBmS,OACR,GAAIA,EAAQ,CACX/R,IACEC,IAAI,qBACJC,MAAK,SAAAC,GACLU,aAAawR,QAAQ,WAAY1R,KAAKqB,UAAU7B,EAASC,UAE3DJ,IACEC,IAAI,qBACJC,MAAK,SAAAC,GACLU,aAAawR,QAAQ,WAAY1R,KAAKqB,UAAU7B,EAASC,UAE3D,IAAMoR,EAAME,IAAK,WAAa,IAAD,OAC5BlT,KAAK8T,IAAIV,IACTpT,KAAK+O,IAAI,MACT/O,KAAK+T,MAAM,UACX/T,KAAK+T,MAAM,SACX/T,KAAK+T,MAAM,eACX/T,KAAK+T,MAAM,QACX5R,KAAKC,MAAMC,aAAaC,QAAQ,UAAUT,KAAI,SAAAW,GAAI,OACjD,EAAKwR,IAAI,CACRnR,GAAIL,EAAKK,GACT3C,MAAOsC,EAAKtC,MACZC,OAAQqC,EAAKrC,OACbC,YAAaoC,EAAKpC,iBAGpB+B,KAAKC,MAAMC,aAAaC,QAAQ,aAAaT,KAAI,SAAA8O,GAAO,OACvD,EAAKqD,IAAI,CACRnR,GAAI8N,EAAQvE,OACZ3C,KAAMkH,EAAQlH,UAGhBtH,KAAKC,MAAMC,aAAaC,QAAQ,aAAaT,KAAI,SAAA+J,GAAO,OACvD,EAAKoI,IAAI,CACRnR,GAAI+I,EAAQQ,OACZR,QAASA,EAAQnC,aAIpBpH,aAAawR,QAAQ,eAAgB1R,KAAKqB,UAAUwP,EAAIO,OAAOA,KAC/DvT,KAAKC,MAAMgH,QAAQsJ,QAAQ,CAAEzG,SAAS,WAAD,OAAa9J,KAAKoB,MAAMmS,a,+BAI/D,WACCvT,KAAKqJ,cACLrJ,KAAK+I,a,oBAGN,WAAU,IAAD,OAGR,OAFsB/I,KAAKoB,MAAnB0H,UAGA,8BACN,cAACQ,EAAA,EAAD,CAASC,UAAU,SAAS9B,KAAK,SAAjC,SACC,sBAAM3H,UAAU,UAAhB,4BAMF,qCACC,eAACmU,GAAA,EAAD,CAAQC,kBAAgB,EAACC,OAAO,MAAMC,OAAO,KAAKC,GAAG,QAAQ7M,QAAQ,QAArE,UACC,cAACyM,GAAA,EAAOK,MAAR,CAAcC,KAAK,IAAnB,SAAwB,0CACxB,cAACN,GAAA,EAAOO,OAAR,CAAeC,gBAAc,0BAC7B,eAACR,GAAA,EAAOS,SAAR,CAAiB7R,GAAG,wBAApB,UACC,eAAC8R,GAAA,EAAD,CAAK7U,UAAU,UAAf,UACEE,KAAKoB,MAAMsL,MAAiC,UAAzB1M,KAAKoB,MAAMsL,KAAKjF,KACjC,cAACkN,GAAA,EAAIC,KAAL,CAAUL,KAAK,SAAf,SACD,cAACvK,EAAA,EAAD,CAAQxC,QAAQ,kBAAhB,qBAIC,KAEH,cAACmN,GAAA,EAAIC,KAAL,CAAUL,KAAK,SAAf,SACC,cAACvK,EAAA,EAAD,CAAQxC,QAAQ,kBAAhB,0BAKDxH,KAAKoB,MAAMsL,MAAQ1M,KAAKoB,MAAMsL,KAAK1I,SACjC,eAAC2Q,GAAA,EAAD,CAAK7U,UAAU,UAAf,UACD,cAAC6U,GAAA,EAAIC,KAAL,UACC,cAAC5K,EAAA,EAAD,CAAQlF,QAAS,kBAAM,EAAK7E,MAAMgH,QAAQsJ,QAAQ,CAAEzG,SAAS,YAAD,OAAc,EAAK1I,MAAMsL,KAAK1I,UAAY5C,MAAO,CAAEsL,KAAM,EAAKtL,MAAMsL,SAAWlF,QAAQ,UAAnJ,uBAID,cAACmN,GAAA,EAAIC,KAAL,UACC,cAAC5K,EAAA,EAAD,CAAQlF,QAAS9E,KAAKsH,kBAAmBE,QAAQ,kBAAjD,yBAKA,cAACmN,GAAA,EAAIC,KAAL,CAAUL,KAAK,SAAf,SACD,cAACvK,EAAA,EAAD,CAAQxC,QAAQ,kBAAhB,wBAMH,qBAAK1H,UAAU,0BAAf,SACC,eAAC+U,GAAA,EAAD,WACC,cAACC,GAAA,EAAD,CAAanQ,KAAK,OAAOC,YAAY,SAAS1C,KAAK,SAAS2C,SAAU7E,KAAK6D,oBAC3E,cAACgR,GAAA,EAAWE,QAAZ,UACC,cAAC/K,EAAA,EAAD,CAAQxC,QAAQ,eAAe1C,QAAS9E,KAAK0T,aAA7C,8BAKJ,sBAAK5T,UAAU,YAAf,UACC,eAAC,IAAD,WACC,cAAC,IAAD,CAAOkV,OAAK,EAACC,KAAK,IAAIrC,OAAQ,SAAA3S,GAAK,OAClC,cAAC,EAAD,2BAAUA,GAAV,IACC4I,MAAO,EAAKzH,MAAMyH,YAGpB,cAAC,IAAD,CAAOoM,KAAK,eAAerC,OAAQ,SAAA3S,GAAK,OACvC,cAAC,EAAD,2BAAaA,GAAb,IACC4I,MAAO1G,KAAKC,MAAMC,aAAaC,QAAQ,UACvCmF,KAAM,EAAKrG,MAAMsL,KAAKjF,WAGxB,cAAC,IAAD,CAAOwN,KAAK,gBAAgBrC,OAAQ,SAAA3S,GAAK,OACxC,cAAC,GAAD,2BAAgBA,GAAhB,IACCyM,KAAM,EAAKtL,MAAMsL,KAAK1I,SACtBqD,OAAQ,EAAKjG,MAAMsL,KAAK7J,SAG1B,cAAC,IAAD,CAAOoS,KAAK,gBAAgBrC,OAAQ,SAAA3S,GACnC,OAAI,EAAKmB,MAAMsL,KAAK1I,SACZ,cAAC,GAAD,2BAAgB/D,GAAhB,IACNwH,KAAM,EAAKrG,MAAMsL,KAAKjF,KACtBiF,KAAM,EAAKtL,MAAMsL,KAAK1I,SACtBqD,OAAQ,EAAKjG,MAAMsL,KAAK7J,MAGxB,cAAC,IAAD,CAAU9C,GAAG,SAIhB,cAAC,IAAD,CAAOkV,KAAK,cAAcrC,OAAQ,SAAA3S,GACjC,OAAI,EAAKmB,MAAMsL,KAAK1I,SACZ,cAAC,GAAD,2BAAgB/D,GAAhB,IACNyM,KAAM,EAAKtL,MAAMsL,KAAK1I,SACtBqD,OAAQ,EAAKjG,MAAMsL,KAAK7J,MAGxB,cAAC,IAAD,CAAU9C,GAAG,SAIhB,cAAC,GAAD,CAAYkV,KAAK,SAASxC,UAAW7O,EACpCc,qBAAsB1E,KAAK0E,qBAC3BgO,YAAa1S,KAAK0S,YAClBhG,KAAM1M,KAAKoB,MAAMsL,KAAK1I,WAEvB,cAAC,IAAD,CAAOiR,KAAK,YAAYrC,OAAQ,SAAA3S,GAAK,OACpC,cAAC,EAAD,2BAAcA,GAAd,IACCyE,qBAAsB,EAAKA,qBAC3BgO,YAAa,EAAKA,kBAGpB,cAAC,IAAD,CAAOuC,KAAK,SAASrC,OAAQ,SAAA3S,GAC5B,MAA6B,UAAzB,EAAKmB,MAAMsL,KAAKjF,KACZ,cAAC,EAAD,2BAAWxH,GAAX,IACNyM,KAAM,EAAKtL,MAAMsL,KAAK1I,SACtBqD,OAAQ,EAAKjG,MAAMsL,KAAK7J,MAGxB,cAAC,IAAD,CAAU9C,GAAG,SAIhB,cAAC,IAAD,CAAOkV,KAAK,SAASrC,OAAQ,SAAA3S,GAAK,OACjC,cAACiV,GAAA,EAAD,UACE/S,KAAKC,MAAMC,aAAaC,QAAQ,UAAUT,KAAI,SAACW,EAAMI,GAAP,OAC9C,8BACC,wBAAC,EAAD,2BAAc3C,GAAd,IACCkV,IAAK3S,EAAKK,GACV3C,MAAOsC,EAAKtC,MACZE,YAAaoC,EAAKpC,YAClBD,OAAQqC,EAAKrC,OACbG,UAAWkC,EAAKlC,cANRsC,WAYb,cAAC,IAAD,CAAOqS,KAAK,UAAUrC,OAAQ,SAAA3S,GAAK,OAClC,cAACiV,GAAA,EAAD,UACE/S,KAAKC,MAAMC,aAAaC,QAAQ,iBAAiB8K,OAAS,EACxDjL,KAAKC,MAAMC,aAAaC,QAAQ,iBAAiBT,KAAI,SAAC8K,EAAQ/J,GAAT,OACtD,8BACC,cAAC,GAAD,2BAAY3C,GAAZ,IACC0M,OAAQA,EACR/J,MAAOA,EACP8N,SAAU,EAAKtP,MAAMsP,SACrBlF,SAAU,EAAKpK,MAAMoK,aALb5I,MAST,8BACD,oBAAI9C,UAAU,mBAAd,6CAOJ,cAAC,IAAD,CAAOmV,KAAK,IAAIxC,UAAW,kBAAM,oBAAI3S,UAAU,cAAd,iCAElC,8BACC,cAACiF,EAAA,EAAD,CACCC,MAAO,CACNC,SAAU,WACVC,IAAK,IACLC,MAAO,IAERC,KAAMpF,KAAKoB,MAAM8C,MAAMsP,OACvBnO,QAAS,WACR,EAAKpD,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJsP,QAAQ,SAIXlO,MAAO,IACPC,UAAQ,EAjBT,SAmBC,cAACR,EAAA,EAAMS,OAAP,UACC,0DAMH,8BACC,cAACT,EAAA,EAAD,CACCC,MAAO,CACNC,SAAU,WACVC,IAAK,IACLC,MAAO,IAERC,KAAMpF,KAAKoB,MAAM8C,MAAMC,MACvBkB,QAAS,WACR,EAAKpD,UAAS,SAAAsC,GAAS,MAAK,CAC3BL,MAAM,2BAEFK,EAAUL,OAFT,IAGJC,OAAO,SAIVmB,MAAO,IACPC,UAAQ,EAjBT,SAmBC,cAACR,EAAA,EAAMS,OAAP,UACC,mCACExF,KAAKoB,MAAMsL,KAAK1I,SADlB,gC,GA3YUxD,aAuZHC,eAAW6S,ICta1B9R,IAAMkC,SAAS0R,QAAU,+CAGzB,IAAMnO,GAAUoO,cAEhBC,IAAS1C,OACP,cAAC,IAAD,CAAQ3L,QAASA,GAAjB,SACE,cAAC,GAAD,MAEFsO,SAASC,eAAe,W","file":"static/js/main.6f02a93b.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nclass BookCard extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <small className=\"text-muted\">Last updated {new Date(this.props.updatedAt).toLocaleDateString()}</small>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCard)","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\nimport ReactStars from \"react-rating-stars-component\";\r\n//import { Card } from 'react-bootstrap';\r\n\r\nclass BookCardRating extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <div className=\"row d-flex\">\r\n            <div className=\"col-md-4\">\r\n            <ReactStars\r\n              value={this.props.rating}\r\n              edit={false}\r\n              count={5}\r\n              isHalf={true}\r\n              size={18}\r\n              activeColor=\"#ffd700\"\r\n            />\r\n            </div>\r\n            <div className=\"offset-col-md-4 small text\">\r\n              {this.props.rating.toPrecision(2)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCardRating)","import React, { Component } from \"react\";\r\nimport BookCard from \"./components/BookCard\";\r\nimport BookCardRating from \"./components/BookCardRating\";\r\nimport { TagCloud } from 'react-tagcloud'\r\nimport axios from \"axios\"\r\n\r\nconst unique = (arr) => {\r\n\treturn [...new Set(arr.map((o) => JSON.stringify(o))),\r\n\t].map((string) => JSON.parse(string));\r\n}\r\n\r\nclass Home extends Component {\r\n  constructor() {\r\n\t\tsuper();\r\n\t\tthis.state = {\r\n      allTags: [],\r\n    }\r\n    this.getTags = this.getTags.bind(this)\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getTags()\r\n  }\r\n\r\n  getTags() {\r\n\t\taxios.get('/book/getTags')\r\n\t\t.then((response) => {\r\n\t\t\tresponse.data.map(tag => {\r\n\t\t\t\tif(tag.tags) {(tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry }))}\r\n\t\t\t\treturn tag; \r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n  render() {\r\n    return (\r\n      <>\r\n        <div className=\"container mt-3\">\r\n          <div className=\"row xl-3\">\r\n            <div name=\"recent\" className=\"col\">\r\n              <h3>Recently updated</h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .filter(book => new Date(book.updatedAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort()\r\n                .reverse()\r\n                .map((book, index) => (\r\n                  <BookCard\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    updatedAt={book.updatedAt}\r\n                  />\r\n                ))}\r\n            </div>\r\n            <div name=\"top\" className=\"col\">\r\n              <h3>Top fandoms of the week</h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .slice(0, 5)\r\n                .filter(book => new Date(book.createdAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort((a, b) => (b.rating - a.rating))\r\n                .map((book, index) => (\r\n                  <BookCardRating\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    rating={book.ratingCount ? (book.rating / book.ratingCount) : 0}\r\n                  />\r\n                ))\r\n              }\r\n            </div>\r\n            <div name=\"tags\" className=\"col\">\r\n              <h3>Tags</h3>\r\n              <TagCloud\r\n                minSize={16}\r\n                maxSize={48}\r\n                tags={unique(this.state.allTags)}\r\n                //onClick={tag => alert(`${tag.value} was selected!`)}\r\n              />\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Home","import React, { Component } from \"react\";\r\nimport { Link } from 'react-router-dom';\r\nimport { Toast } from \"react-bootstrap\"\r\nimport axios from \"axios\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Login extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\tpassword: '',\r\n\t\t\talert: {\r\n\t\t\t\tlogin: false\r\n\t\t\t}\r\n\t\t};\r\n\t\tthis.onClickLogin = this.onClickLogin.bind(this);\r\n\t};\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t};\r\n\r\n\tonClickLogin() {\r\n\t\tconst { username, password } = this.state;\r\n\t\taxios.post('user/login', {\r\n\t\t\tusername,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tconsole.log(response.data)\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t} else {\r\n\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\talert:\r\n\t\t\t\t\t{\r\n\t\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\t\tlogin: true\r\n\t\t\t\t\t}\r\n\t\t\t\t}))\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"login\">\r\n\t\t\t\t{/* <form> */}\r\n\t\t\t\t\t<h3 className=\"mb-3 mt-5 text-center\">Sign In</h3>\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<div className=\"row mb-3 mt-5 justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"form-label\">Username</label>\r\n\t\t\t\t\t\t\t<input type=\"text\" className=\"col-6 ml-3 form-control\" name=\"username\" placeholder=\"Enter username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"form-label\">Password</label>\r\n\t\t\t\t\t\t\t<input type=\"password\" className=\"col-6 ml-3 form-control\" name=\"password\" placeholder=\"Enter password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"row mt-5 justify-content-center\">\r\n\t\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLogin} className=\"btn btn-outline-primary\">Submit</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t{/* </form> */}\r\n\t\t\t\t<h3 className=\"mt-5 text-center\">\r\n\t\t\t\t\t<Link to=\"/register\" className=\"register_link\">\r\n\t\t\t\t\t\tCreate an account\r\n        \t\t</Link>\r\n\t\t\t\t</h3>\r\n\t\t\t\t<div>\r\n\t\t\t\t\t<Toast\r\n\t\t\t\t\t\tstyle={{\r\n\t\t\t\t\t\t\tposition: 'absolute',\r\n\t\t\t\t\t\t\ttop: 100,\r\n\t\t\t\t\t\t\tright: 40,\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tshow={this.state.alert.login}\r\n\t\t\t\t\t\tonClose={() => {\r\n\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\talert:\r\n\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\t\t\t\t\tlogin: false\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t}}\r\n\t\t\t\t\t\tdelay={2000}\r\n\t\t\t\t\t\tautohide\r\n\t\t\t\t\t>\r\n\t\t\t\t\t\t<Toast.Header>\r\n\t\t\t\t\t\t\t<strong>\r\n\t\t\t\t\t\t\t\tUsername or password is wrong\r\n\t\t\t\t\t\t\t</strong>\r\n\t\t\t\t\t\t</Toast.Header>\r\n\t\t\t\t\t</Toast>\r\n\t\t\t\t</div>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Register extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\temail: '',\r\n\t\t\tpassword: '',\r\n\t\t};\r\n\t}\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t}\r\n\r\n\tonClickRegister = () => {\r\n\t\tconst { username, email, password } = this.state;\r\n\t\taxios.post('/user/register', {\r\n\t\t\tusername,\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tconsole.log(response);\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"register\">\r\n\t\t\t\t<form>\r\n\t\t\t\t\t<h3 className=\"mb-3 text-center\">Sign Up</h3>\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<div className=\"mb-3 mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Username</label>\r\n\t\t\t\t\t\t\t<input type=\"text\" className=\"col-3 form-control\" placeholder=\"Enter username\" name=\"username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"mb-3 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Email address</label>\r\n\t\t\t\t\t\t\t<input type=\"email\" className=\"col-3 form-control\" placeholder=\"name@example.com\" name=\"email\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Password</label>\r\n\t\t\t\t\t\t\t<input type=\"password\" className=\"col-3 form-control\" placeholder=\"Enter password\" name=\"password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickRegister} className=\"btn btn-outline-primary\">Submit</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Register;","import { Link } from 'react-router-dom';\r\n\r\nconst columns = [\r\n  {\r\n    \"dataField\": \"id\",\r\n    \"text\": \"ID\"\r\n  },\r\n  {\r\n    \"dataField\": \"username\",\r\n    \"text\": \"Username\",\r\n    \"formatter\": (cell, row) => <Link to={`/profile/${cell}`}> {cell} </Link>\r\n  },\r\n  {\r\n    \"dataField\": \"email\",\r\n    \"text\": \"Email\"\r\n  },\r\n  {\r\n    \"dataField\": \"createdAt\",\r\n    \"text\": \"Registration date\",\r\n    \"formatter\": (cell, row) => new Date(cell).toLocaleDateString()\r\n  },\r\n  {\r\n    \"dataField\": \"role\",\r\n    \"text\": \"Role\"\r\n  },\r\n  {\r\n    \"dataField\": \"status\",\r\n    \"text\": \"Block status\"\r\n  }\r\n]\r\n\r\nexport default columns;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { Alert } from 'react-bootstrap';\r\nimport columns from '../data/columns'\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Users extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.state = {\r\n\t\t\tusers: [],\r\n\t\t\tselectedRows: [],\r\n\t\t\talert: {\r\n\t\t\t\tblock: false,\r\n\t\t\t\tunblock: false,\r\n\t\t\t\tdelete: false\r\n\t\t\t},\r\n\t\t}\r\n\r\n\t\tthis.blockUsers = this.blockUsers.bind(this);\r\n\t\tthis.unblockUsers = this.unblockUsers.bind(this);\r\n\t\tthis.deleteUsers = this.deleteUsers.bind(this);\r\n\t\tthis.getData = this.getData.bind(this);\r\n\t\tthis.showBlockAlert = this.showBlockAlert.bind(this);\r\n\t\tthis.showUnblockAlert = this.showUnblockAlert.bind(this);\r\n\t\tthis.showDeleteAlert = this.showDeleteAlert.bind(this);\r\n\t}\r\n\r\n\tasync getData() {\r\n\t\tawait new Promise(resolve => setTimeout(resolve, 200));\r\n\t\tlet data = [];\r\n\t\tdata = await axios.get('/user/usersTable')\r\n\t\t\t.then(response => {\r\n\t\t\t\treturn response.data;\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tthis.props.history.push('/');\r\n\t\t\t});\r\n\t\tthis.setState({ users: data });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.getData();\r\n\t}\r\n\r\n\tshowBlockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowUnblockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tunblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tunblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowDeleteAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tdelete: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tdelete: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/block', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.showBlockAlert();\r\n\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\r\n\tunblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/unblock', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tthis.showUnblockAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\r\n\tdeleteUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/delete', {\r\n\t\t\tselectedRows,\r\n\t\t}).then((response) => {\r\n\t\t\tif (response) {\r\n\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.showDeleteAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"container mt-3\">\r\n\t\t\t\t<Alert show={this.state.alert.block} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are blocked\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.unblock} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are unblocked\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.delete} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are deleted\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<div className=\"btn-group mb-3\" role=\"group\">\r\n\t\t\t\t\t<button onClick={this.blockUsers} type=\"button\" className=\"btn btn-outline-primary\">Block</button>\r\n\t\t\t\t\t<button onClick={this.unblockUsers} type=\"button\" className=\"btn btn-outline-primary\">Unblock</button>\r\n\t\t\t\t\t<button onClick={this.deleteUsers} type=\"button\" className=\"btn btn-outline-danger\">Delete</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<BootstrapTable\r\n\t\t\t\t\tkeyField='id'\r\n\t\t\t\t\tnoDataIndication=\"Table is Empty\"\r\n\t\t\t\t\tdata={this.state.users}\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\thiddenRows={[5]} //Admin ID\r\n\t\t\t\t\twrapperClasses=\"table-responsive\"\r\n\t\t\t\t\tselectRow={{\r\n\t\t\t\t\t\tmode: 'checkbox',\r\n\t\t\t\t\t\tclickToSelect: true,\r\n\t\t\t\t\t\tonSelectAll: (row, rows, isSelect) => {\r\n\t\t\t\t\t\t\tif (row) {\r\n\t\t\t\t\t\t\t\tfor (let r of rows) {\r\n\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, r.id]\r\n\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({ selectedRows: [] });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonSelect: (row, isSelect) => {\r\n\t\t\t\t\t\t\tif (isSelect) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, row.id]\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\tselectedRows: this.state.selectedRows.filter(function (selectedRows) {\r\n\t\t\t\t\t\t\t\t\t\treturn selectedRows !== row.id\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withRouter(Users);","import React, { Component } from \"react\";\r\nimport { Button, Badge, Form, Container, Spinner } from \"react-bootstrap\";\r\nimport { Link } from 'react-router-dom';\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport paginationFactory from 'react-bootstrap-table2-paginator';\r\nimport { BsX } from \"react-icons/bs\";\r\nimport axios from 'axios';\r\nimport { withRouter } from \"react-router\";\r\n\r\nclass Profile extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      id: undefined,\r\n      profileId: undefined,\r\n      username: \"\",\r\n      profileUsername: \"\",\r\n      email: \"\",\r\n      profileEmail: \"\",\r\n      books: [],\r\n      isLoading: true,\r\n    }\r\n    this.getBooks = this.getBooks.bind(this);\r\n  }\r\n\r\n  handleChange = e => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  getBooks() {\r\n    const username = this.props.match.params.id; //change later\r\n    axios\r\n      .get(\"/book/userBooks\", {\r\n        params: {\r\n          username: username\r\n        }\r\n      })\r\n      .then(response => {\r\n        this.setState({ books: response.data });\r\n      });\r\n  }\r\n\r\n  deleteBook(id) {\r\n    const ID = id;\r\n    axios\r\n      .post(\"/book/deleteBook\", {ID})\r\n      .then(response => {\r\n        this.setState({\r\n          books: this.state.books.filter(book => book.id !== ID)\r\n        })\r\n      });\r\n    \r\n  }\r\n\r\n  getUserData() {\r\n    axios\r\n      .get(\"/user/userData\")\r\n      .then(response => {\r\n\t\t\t\tif (response.data.status !== 'error') {\r\n\t\t\t\t\tthis.setState({\r\n            id: response.data.id,\r\n            username: response.data.username,\r\n            email: response.data.email,\r\n            role: response.data.role\r\n\t\t\t\t\t}, () => this.setState({ isLoading: false }));\r\n\t\t\t\t} else {\r\n          this.setState({ isLoading: false })\r\n        }\r\n\t\t\t})\r\n  }\r\n\r\n  getProfileData() {\r\n    axios\r\n      .get(\"/user/profileData\",\r\n        {\r\n          params: {\r\n            username: this.props.match.params.id,\r\n          }\r\n        })\r\n      .then(response => {\r\n        this.setState({\r\n          profileId: response.data.id,\r\n          profileUsername: response.data.username,\r\n          profileEmail: response.data.email\r\n        })\r\n      })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBooks();\r\n    this.getProfileData();\r\n    this.getUserData();\r\n  }\r\n\r\n  render() {\r\n    const { isLoading } = this.state;\r\n    if (isLoading) {\r\n      return <div>\r\n        <Spinner animation=\"border\" role=\"status\">\r\n          <span className=\"sr-only\">Loading...</span>\r\n        </Spinner>\r\n      </div>;\r\n    }\r\n\r\n    if (!isLoading && !this.state.profileId) {\r\n      return  <div>\r\n                <h3 className=\"mt-5 text-center\">\r\n                  This user doesn't exist\r\n                </h3>\r\n              </div>\r\n    }\r\n\r\n    const columns = [\r\n      {\r\n        dataField: \"title\",\r\n        text: \"Title\",\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"genre\",\r\n        text: \"Genre\"\r\n      },\r\n      {\r\n        dataField: \"tags\",\r\n        text: \"Tags\",\r\n        formatter: (cell, row) => cell ? cell.map((label, index) => { return (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">{label.label}</Badge>) }) : 'No tags'\r\n      },\r\n      {\r\n        dataField: \"rating\",\r\n        text: \"Rating\",\r\n        formatter: (cell, row) => row.ratingCount !== 0 ? (cell / row.ratingCount).toPrecision(2) : 0,\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"createdAt\",\r\n        text: \"Publication Date\",\r\n        formatter: (cell, row) => new Date(cell).toLocaleDateString(),\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"Edit\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => \r\n          <Link to={{ pathname: `/edit/${row.title}`, state: { bookid: row.title } }}>\r\n            <Button variant=\"secondary\">\r\n              Edit\r\n            </Button>\r\n          </Link>,\r\n        hidden: (this.state.username === this.state.profileUsername || this.props.role === 'admin') ? false : true\r\n      },\r\n      {\r\n        dataField: \"View\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => \r\n          <Link to={`/view/${row.title}`}>\r\n            <Button variant=\"secondary\">\r\n              View\r\n            </Button>\r\n          </Link>\r\n      },\r\n      {\r\n        dataField: \"Delete\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => <Button onClick={() => this.deleteBook(row.id)}> <BsX /> </Button>,\r\n        hidden: this.state.username === this.state.profileUsername ? false : true\r\n      }\r\n    ]\r\n    \r\n    return (\r\n      <>\r\n        <Container className=\"container mt-3\">\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold',\r\n              width: 'auto',\r\n            }}>\r\n              Username:\r\n              </div>\r\n            <div className=\"p-1 ml-3\">\r\n              <Form.Control type=\"text\" placeholder={this.state.profileUsername} readOnly />\r\n            </div>\r\n          </div>\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold'\r\n            }}>\r\n              Email:\r\n              </div>\r\n            <div className=\"p-1 ml-3\">\r\n              <Form.Control type=\"text\" placeholder={this.state.profileEmail} readOnly />\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"container mt-3\">\r\n            {(this.state.username === this.props.match.params.id)\r\n              ? <div className=\"mt-3 mb-3\">\r\n                <Link to={\"/createBook\"}>\r\n                  <Button className=\"shadow-sm\" variant=\"outline-success\" >\r\n                    Create a book\r\n              </Button>\r\n                </Link>\r\n              </div>\r\n              : null\r\n            }\r\n\r\n            <BootstrapTable\r\n              bootstrap4\r\n              keyField='id'\r\n              noDataIndication=\"Table is Empty\"\r\n              data={this.state.books}\r\n              columns={columns}\r\n              defaultSorted={[{\r\n                dataField: 'createdAt',\r\n                order: 'desc'\r\n              }]}\r\n              wrapperClasses=\"table-responsive\"\r\n              pagination={paginationFactory()}\r\n            />\r\n          </div>\r\n        </Container>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Profile);","const genres = [\r\n  { value: 'fantasy', label: 'Fantasy' },\r\n  { value: 'action', label: 'Action' },\r\n  { value: 'adventure', label: 'Adventure' },\r\n  { value: 'detective', label: 'Detective' },\r\n  { value: 'romance', label: 'Romance' },\r\n  { value: 'sci-fi', label: 'Sci-Fi' },\r\n  { value: 'horror', label: 'Horror' },\r\n  { value: 'thriller', label: 'Thriller' },\r\n  { value: 'erotic', label: 'Erotic' },\r\n]\r\n\r\nexport default genres;","import React, { Component, Fragment } from \"react\";\r\nimport { Spinner, Form, Row, Col, Button, Accordion, Card, AccordionToggle, AccordionCollapse } from \"react-bootstrap\";\r\nimport { Typeahead, Token } from 'react-bootstrap-typeahead';\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { BsPlus, BsX } from \"react-icons/bs\";\r\nimport { withRouter } from \"react-router\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactMde from \"react-mde\";\r\nimport axios from 'axios';\r\nimport Select from 'react-select'\r\n//import tags from '../data/tags';\r\nimport genres from '../data/genres';\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nconst unique = (arr) => {\r\n\treturn [...new Set(arr.map((o) => JSON.stringify(o))),\r\n\t].map((string) => JSON.parse(string));\r\n}\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n\tconst result = list;\r\n\tconst [removed] = result.splice(startIndex, 1);\r\n\tresult.splice(endIndex, 0, removed);\r\n\treturn resetNames(resetIds(result));\r\n};\r\n\r\nconst resetIds = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst ID = el;\r\n\t\tID.chapterId = index + 1;\r\n\t\treturn ID;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nconst resetNames = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst name = el;\r\n\t\tname.chapterName = index + 1;\r\n\t\treturn name;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nclass CreateBook extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\teditMode: false,\r\n\t\t\tisLoading: true,\r\n\t\t\tmultiple: true,\r\n\t\t\tbookId: \"\",\r\n\t\t\ttags: [],\r\n\t\t\tallTags: [],\r\n\t\t\tgenre: \"\",\r\n\t\t\tactiveNav: \"write\",\r\n\t\t\tdesc: \"\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tauthor: \"\",\r\n\t\t\tauthorId: \"\",\r\n\t\t\tchapters: [\r\n\t\t\t\t{\r\n\t\t\t\t\tchapterId: 1,\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tchapterName: '1',\r\n\t\t\t\t\ttext: '',\r\n\t\t\t\t\tBookId: '',\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t}\r\n\t\tthis.createBook = this.createBook.bind(this);\r\n\t\tthis.updateBook = this.updateBook.bind(this);\r\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\r\n\t\tthis.addChapter = this.addChapter.bind(this);\r\n\t\tthis.deleteChapter = this.deleteChapter.bind(this);\r\n\t\tthis.getTags = this.getTags.bind(this);\r\n\t}\r\n\r\n\topenBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\tthis.getTags()\r\n\t\taxios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t},\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\ttitle: response.data.title,\r\n\t\t\t\t\tbookId: response.data.id,\r\n\t\t\t\t\ttags: response.data.tags,\r\n\t\t\t\t\tgenre: response.data.genre,\r\n\t\t\t\t\tdesc: response.data.description,\r\n\t\t\t\t\tauthor: response.data.author,\r\n\t\t\t\t\tauthorId: response.data.authorId,\r\n\t\t\t\t\tchapters: response.data.Chapters\r\n\t\t\t\t},\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tif (this.state.chapters && (this.props.role === 'admin' || this.props.user === this.state.author)) {\r\n\t\t\t\t\t\t\tthis.state.chapters.map((chapter) => {\r\n\t\t\t\t\t\t\t\tdelete chapter['createdAt'];\r\n\t\t\t\t\t\t\t\tdelete chapter['updatedAt'];\r\n\t\t\t\t\t\t\t\treturn chapter;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.setState({ isLoading: false })\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.props.history.push(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t});\r\n\t};\r\n\r\n\tonDragEnd(result) {\r\n\t\tif (!result.destination) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst chapters = reorder(\r\n\t\t\tthis.state.chapters,\r\n\t\t\tresult.source.index,\r\n\t\t\tresult.destination.index\r\n\t\t);\r\n\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\thandleValueChange = (e, index) => {\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tchapters[index].text = e;\r\n\t\tthis.setState({ chapters });\r\n\t\t/*this.setState(prevState => ({\r\n\t\t\tchapters: {\r\n\t\t\t\t...prevState.chapters,\r\n\t\t\t\t[prevState.chapters[index].text]: e,\r\n\t\t\t},\r\n\t\t}));*/\r\n\t};\r\n\r\n\thandleTabChange = activeTab => {\r\n\t\tthis.setState({ activeTab });\r\n\t};\r\n\r\n\taddChapter() {\r\n\t\t//console.log(this.state.chapters.length)\r\n\t\tconst chaptersCount = this.state.chapters.length + 1;\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tconst chapter = {\r\n\t\t\tBookId: this.state.bookId,\r\n\t\t\tchapterId: chaptersCount,\r\n\t\t\tchapterName: chaptersCount.toString(),\r\n\t\t\ttext: ''\r\n\t\t}\r\n\t\tchapters.push(chapter);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\tdeleteChapter = id => {\r\n\t\tconst chapters = this.state.chapters.filter((chapter) => chapter.chapterId !== id);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ author: this.props.user, authorId: this.props.userId })\r\n\t\tif (this.props.location.pathname === `/edit/${this.props.match.params.bookid}`) {\r\n\t\t\tthis.setState({ editMode: true }, () => this.openBook())\r\n\t\t} else {\r\n\t\t\tthis.setState({ isLoading: false })\r\n\t\t}\r\n\t}\r\n\r\n\tcreateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/createBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, chapters\r\n\t\t})\r\n\t\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\tupdateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tbookId,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/updateBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, bookId, chapters\r\n\t\t})\r\n\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\tgetTags() {\r\n\t\taxios.get('/book/getTags')\r\n\t\t.then((response) => {\r\n\t\t\tresponse.data.map(tag => {\r\n\t\t\t\tif(tag.tags) {(tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry }))}\r\n\t\t\t\treturn tag; \r\n\t\t\t})\r\n\t\t});\r\n\t}\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"mt-4\">\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tTitle\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ title: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tDescription\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.desc}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ desc: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tTags\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t\t\t<Typeahead\r\n\t\t\t\t\t\t\t\t\t\t{...this.state}\r\n\t\t\t\t\t\t\t\t\t\tallowNew={true}\r\n\t\t\t\t\t\t\t\t\t\thighlightOnlyResult={false}\r\n\t\t\t\t\t\t\t\t\t\tnewSelectionPrefix=\"Add a new tag: \"\r\n\t\t\t\t\t\t\t\t\t\tid=\"tags-token\"\r\n\t\t\t\t\t\t\t\t\t\tdefaultSelected={this.state.tags ? this.state.tags : []}\r\n\t\t\t\t\t\t\t\t\t\toptions={this.state.allTags.length > 0 ? unique(this.state.allTags) : []}\r\n\t\t\t\t\t\t\t\t\t\tlabelKey=\"value\"\r\n\t\t\t\t\t\t\t\t\t\tonChange={(tags) => this.setState({ tags })}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Start typing...\"\r\n\t\t\t\t\t\t\t\t\t\trenderToken={(option, { onRemove }, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Token key={index} option={option} onRemove={onRemove}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{`${option.value}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Token>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tGenre\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\tdefaultValue={{value: \"default\", label: this.state.genre}}\r\n\t\t\t\t\t\t\t\t\t//value={this.state.genre}\r\n\t\t\t\t\t\t\t\t\tonChange={(genre) => this.setState({ genre })}\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\toptions={genres}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t</Form>\r\n\r\n\t\t\t\t\t<Card style={{ maxWidth: '45.5rem' }} onClick={this.addChapter}>\r\n\t\t\t\t\t\t<Card.Header as={Button} variant=\"light\">\r\n\t\t\t\t\t\t\t<BsPlus />\r\n\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\r\n\t\t\t\t\t\t<Droppable droppableId=\"droppable\" >\r\n\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t<div className=\"col-xs\"\r\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Accordion>\r\n\t\t\t\t\t\t\t\t\t\t{(this.state.chapters).map((tab, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<Draggable\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={tab.chapterId}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdraggableId={tab.chapterId.toString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card key={index} style={{ maxWidth: '45.5rem' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card.Header style={{ display: 'flex', alignItems: 'center', margin: '0' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionToggle as={Button} variant=\"link\" eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.editMode ? `Chapter ${tab.chapterId}` : `Chapter ${tab.chapterName}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionToggle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(index + 1 === this.state.chapters.length)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? <Button variant=\"link\" onClick={() => { this.deleteChapter(tab.chapterId) }} style={{ marginLeft: 'auto' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<BsX />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionCollapse eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ReactMde\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.chapters[index].text}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleValueChange(e, index)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedTab={this.state.activeTab}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonTabChange={this.handleTabChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgenerateMarkdownPreview={(markdown) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPromise.resolve(<ReactMarkdown source={markdown} />)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionCollapse>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t</Accordion>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t\t<div className=\"mt-3\">\r\n\t\t\t\t\t\t{this.state.editMode\r\n\t\t\t\t\t\t\t? <Button onClick={this.updateBook} variant=\"outline-success\">Update</Button>\r\n\t\t\t\t\t\t\t: <Button onClick={this.createBook} variant=\"outline-success\">Publish</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(CreateBook);","import React, { Component } from \"react\";\r\n\r\nclass BookInfo extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"row mt-1\">\r\n        <div className=\"p-1 mr-5\">\r\n          {this.props.label}\r\n        </div>\r\n        <div>\r\n          {this.props.value}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default BookInfo","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Comment, Form, Button } from 'semantic-ui-react'\r\nimport 'semantic-ui-css/components/comment.min.css'\r\nimport 'semantic-ui-css/components/form.min.css'\r\nimport 'semantic-ui-css/components/button.min.css'\r\nimport 'semantic-ui-css/components/icon.min.css'\r\n\r\nclass CommentsSection extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      comments: [],\r\n      comment: ''\r\n    };\r\n  }\r\n\r\n  // ws = new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`)\r\n  ws = new WebSocket(window.location.origin.replace(/^http/, 'ws')+`/${this.props.bookId}`)\r\n\r\n  handleInputChange = (event) => {\r\n    event.preventDefault();\r\n    this.setState({\r\n      [event.target.name]: event.target.value,\r\n    });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.ws.onopen = () => {\r\n      console.log('Connected to server')\r\n    }\r\n    this.ws.onmessage = evt => {\r\n      const comment = JSON.parse(evt.data)\r\n      this.addCommentsFromServer(comment);\r\n    }\r\n    this.ws.onclose = () => {\r\n      console.log('Disconnected from server')\r\n      this.setState({\r\n        ws: new WebSocket(window.location.origin.replace(/^http/, 'ws')+`/${this.props.bookId}`),\r\n        // ws: new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`),\r\n      })\r\n    }\r\n  }\r\n\r\n  addCommentsFromServer = comments => {\r\n    this.setState(state => ({ comments: comments }))\r\n  }\r\n\r\n  addReply() {\r\n    if (this.state.comment) {\r\n      const comment = {\r\n        author: this.props.username,\r\n        UserId: this.props.userId,\r\n        BookId: this.props.bookId,\r\n        text: this.state.comment\r\n      }\r\n      this.ws.send(JSON.stringify(comment))\r\n      this.setState({ comment: '' })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Comment.Group size='small'>\r\n          {this.state.comments.map((comment, index) => (\r\n            <Comment key={index}>\r\n              <Comment.Content>\r\n                <Comment.Author as='a'>{comment.author}</Comment.Author>\r\n                <Comment.Metadata>\r\n                  <div>{new Date(comment.createdAt).toLocaleString(\"ru-RU\")}</div>\r\n                </Comment.Metadata>\r\n                <Comment.Text>{comment.text}</Comment.Text>\r\n              </Comment.Content>\r\n            </Comment>\r\n          ))}\r\n        </Comment.Group>\r\n        {this.props.username ?\r\n          <Form reply>\r\n            <Form.TextArea\r\n              value={this.state.comment}\r\n              onChange={e => this.handleInputChange(e)}\r\n              name='comment'\r\n              width={8}\r\n            />\r\n            <Button\r\n              ws={this.ws}\r\n              onClick={() => this.addReply()}\r\n              content='Add Reply'\r\n              labelPosition='left'\r\n              icon='edit'\r\n              size='small'\r\n              primary\r\n            />\r\n          </Form>\r\n          : null}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(CommentsSection);","import React, { Component } from \"react\";\r\nimport { Spinner, Button, Pagination, Container, Badge } from \"react-bootstrap\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactStars from \"react-rating-stars-component\";\r\nimport axios from 'axios';\r\nimport BookInfo from \"./components/BookInfo\";\r\nimport CommentsSection from \"./components/CommentsSection\";\r\nimport { withRouter } from \"react-router\";\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass BookViewer extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tisLoading: true,\r\n\t\t\tbook: [],\r\n\t\t\trating: undefined,\r\n\t\t\tactivePage: \"\",\r\n\t\t\teditable: true,\r\n\t\t\tcomments: false,\r\n\t\t}\r\n\t\tthis.setRating = this.setRating.bind(this);\r\n\t\tthis.setRatingBook = this.setRatingBook.bind(this);\r\n\t\tthis.setActivePage = this.setActivePage.bind(this);\r\n\t\tthis.pushChapters = this.pushChapters.bind(this);\r\n\t\tthis.isRated = this.isRated.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.user === undefined) {\r\n\t\t\tthis.setState({ editable: false });\r\n\t\t}\r\n\t\tthis.openBook()\r\n\t}\r\n\r\n\tisRated() {\r\n\t\tconst bookId = this.state.book.id;\r\n\t\tconst authorId = this.props.userId;\r\n\t\taxios.get('/book/isRated', {\r\n\t\t\tparams: {\r\n\t\t\t\tauthorId, bookId\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconsole.log(response)\r\n\t\t\t\tif (response.data.message) {\r\n\t\t\t\t\tthis.setState({ editable: false },\r\n\t\t\t\t\t\t() => this.setState({ isLoading: false }))\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.setState({ isLoading: false })\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\tasync openBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\tawait axios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({ book: response.data },\r\n\t\t\t\t\t(() => { if (this.props.user) { this.isRated() } else { this.setState({ isLoading: false }) } }))\r\n\t\t\t})\r\n\t\t\t.catch(err => console.log(err));\r\n\t};\r\n\r\n\tsetActivePage(index) {\r\n\t\tthis.setState({ activePage: index });\r\n\t}\r\n\r\n\tpushChapters = () => {\r\n\t\tlet chapters = [];\r\n\t\tif (this.state.book.Chapters) {\r\n\t\t\tthis.state.book.Chapters.map((chapter, index) => {\r\n\t\t\t\tchapters.push(\r\n\t\t\t\t\t<Pagination.Item onClick={() => { this.setActivePage(index); this.setState({ comments: false }) }} key={index}>{index + 1}</Pagination.Item>\r\n\t\t\t\t)\r\n\t\t\t\treturn chapters\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn chapters;\r\n\t}\r\n\r\n\tsetRating(value) {\r\n\t\tif (this.props.user) {\r\n\t\t\tthis.setState({\r\n\t\t\t\trating: value\r\n\t\t\t})\r\n\t\t\t// this.setState(prevState => ({\r\n\t\t\t// \tbook:\r\n\t\t\t// \t{\r\n\t\t\t// \t\t...prevState.book,\r\n\t\t\t// \t\trating: this.state.editable ? prevState.book.rating + value : prevState.book.rating,\r\n\t\t\t// \t\tratingCount: this.state.editable ? prevState.book.ratingCount + 1 : prevState.book.ratingCount,\r\n\t\t\t// \t},\r\n\t\t\t// \teditable: false\r\n\t\t\t// }))\r\n\t\t} else {\r\n\t\t\tconsole.log(\"You have to login to set a rating.\")\r\n\t\t}\r\n\t}\r\n\r\n\tsetRatingBook() {\r\n\t\tif (this.props.user) {\r\n\t\t\tconst author = this.props.user;\r\n\t\t\tconst bookId = this.state.book.id;\r\n\t\t\tconst rating = this.state.book.rating;\r\n\t\t\tconst authorId = this.props.userId;\r\n\t\t\tconst ratingCount = this.state.book.ratingCount;\r\n\t\t\taxios.post('/book/setRating', {\r\n\t\t\t\tauthor, authorId, bookId, rating, ratingCount\r\n\t\t\t})\r\n\t\t\t\t.then((response) => {\r\n\t\t\t\t\tconsole.log(response);\r\n\t\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log('You have to login to set a rating.')\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\tif (!this.state.book) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<h3 className=\"mt-5 text-center\">\r\n\t\t\t\t\tNo book found.\r\n\t\t\t\t\t\t\t\t</h3>\r\n\t\t\t</div>\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Container className=\"container\">\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Title:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.title}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Author:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.author}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Description:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.description}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Genre:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.genre}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\tTags:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{this.state.book.tags\r\n\t\t\t\t\t\t\t? this.state.book.tags.map((tag, index) => {\r\n\t\t\t\t\t\t\t\treturn (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">\r\n\t\t\t\t\t\t\t\t\t{tag.value}\r\n\t\t\t\t\t\t\t\t</Badge>)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\tRating:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{/* {this.state.book.rating || this.state.book.rating === 0 ? */}\r\n\t\t\t\t\t\t\t<ReactStars\r\n\t\t\t\t\t\t\t\tvalue={this.state.book.rating / this.state.book.ratingCount}\r\n\t\t\t\t\t\t\t\tcount={5}\r\n\t\t\t\t\t\t\t\tedit={(this.props.user && this.state.editable) ? true : false}\r\n\t\t\t\t\t\t\t\tonChange={this.setRating}\r\n\t\t\t\t\t\t\t\tisHalf={true}\r\n\t\t\t\t\t\t\t\tsize={24}\r\n\t\t\t\t\t\t\t\tactiveColor=\"#ffd700\"\r\n\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t{/* } */}\r\n\t\t\t\t\t\t<span className=\"ml-3 mt-2\">{this.state.book.rating ? (this.state.book.rating / this.state.book.ratingCount).toPrecision(2) : 0}</span>\r\n\t\t\t\t\t\t<Button\r\n\t\t\t\t\t\t\tclassName=\"ml-3 p-1\"\r\n\t\t\t\t\t\t\tonClick={\r\n\t\t\t\t\t\t\t\t() => this.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tbook:\r\n\t\t\t\t\t\t\t\t\t{\r\n\t\t\t\t\t\t\t\t\t\t...prevState.book,\r\n\t\t\t\t\t\t\t\t\t\trating: this.state.editable ? prevState.book.rating + this.state.rating : prevState.book.rating,\r\n\t\t\t\t\t\t\t\t\t\tratingCount: this.state.editable ? prevState.book.ratingCount + 1 : prevState.book.ratingCount,\r\n\t\t\t\t\t\t\t\t\t},\r\n\t\t\t\t\t\t\t\t\teditable: false\r\n\t\t\t\t\t\t\t\t}), () => this.setRatingBook())\r\n\t\t\t\t\t\t\t} \r\n\t\t\t\t\t\t\tvariant=\"outline-success\"\r\n\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\tSubmit\r\n\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\tChapters:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t<Pagination>\r\n\t\t\t\t\t\t{this.pushChapters()}\r\n\t\t\t\t\t\t<Pagination.Item onClick={() => { this.setState({ comments: true }) }}>Comments</Pagination.Item>\r\n\t\t\t\t\t</Pagination>\r\n\t\t\t\t</div>\r\n\t\t\t\t{this.state.comments\r\n\t\t\t\t\t? <CommentsSection\r\n\t\t\t\t\t\tusername={this.props.user}\r\n\t\t\t\t\t\tuserId={this.props.userId}\r\n\t\t\t\t\t\tbookId={this.state.book.id}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t: null}\r\n\t\t\t\t{this.state.activePage !== \"\"\r\n\t\t\t\t\t? <div className=\"row mt-5 \">\r\n\t\t\t\t\t\t<ReactMarkdown>\r\n\t\t\t\t\t\t\t{this.state.book.Chapters[parseInt(this.state.activePage)].text}\r\n\t\t\t\t\t\t</ReactMarkdown>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t: null}\r\n\t\t\t</Container>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(BookViewer);","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nfunction LoginRoute({ component: Component, handleSuccessfulAuth, handleLogin, user, ...rest }) {\r\n  return (\r\n    <Route {...rest}\r\n      render={props => {\r\n        if (user === undefined) {\r\n          return <Component handleSuccessfulAuth={handleSuccessfulAuth}\r\n            handleLogin={handleLogin}\r\n            user={user}\r\n            {...props} />;\r\n        } else {\r\n          return (\r\n            <Redirect to=\"/\" />\r\n          );\r\n        }\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default withRouter(LoginRoute);\r\n","import React, { Component } from \"react\";\r\nimport BookCard from \"./BookCard\";\r\nimport { Spinner } from \"react-bootstrap\";\r\n\r\nclass Search extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      book: undefined\r\n    }\r\n    this.getBook = this.getBook.bind(this)\r\n  }\r\n\r\n  getBook(dataset, idx) {\r\n    this.setState({ book: dataset.find(data => data.id === parseInt(idx)) },\r\n    () => this.setState({ isLoading: false }))\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBook(JSON.parse(localStorage.getItem('books')), this.props.result.ref)\r\n  }\r\n\r\n  render() {\r\n\t\tif (!this.state.book) {\r\n    return  <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n    const { book } = this.state\r\n    return (\r\n      <BookCard\r\n        key={book.id}\r\n        title={book.title}\r\n        description={book.description}\r\n        author={book.author}\r\n        updatedAt={book.updatedAt}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport default Search","import React, { Component } from 'react';\nimport { Route, Switch, Redirect } from 'react-router-dom';\nimport Home from './pages/Home.js';\nimport Login from './pages/Login.js';\nimport Register from './pages/Register.js';\nimport Users from './pages/Users.js';\nimport Profile from './pages/Profile.js';\nimport CreateBook from './pages/CreateBook.js';\nimport BookViewer from './pages/BookViewer.js';\nimport BookCard from \"./pages/components/BookCard\";\nimport LoginRoute from './LoginRoute.js';\nimport Search from \"./pages/components/Search\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router\";\nimport { Navbar, Nav, Button, FormControl, ListGroup, Toast, Spinner, InputGroup } from \"react-bootstrap\";\n\n/* LUNR SETUP */\nconst lunr = require(\"lunr\")\nrequire(\"lunr-languages/lunr.stemmer.support\")(lunr)\nrequire('lunr-languages/lunr.multi')(lunr)\nrequire(\"lunr-languages/lunr.ru\")(lunr)\nconst englishRussianSupport = lunr.multiLanguage('en', 'ru');\n\naxios.defaults.withCredentials = true;\n\nclass App extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tsearch: '',\n\t\t\talert: {\n\t\t\t\tlogin: false,\n\t\t\t\tlogout: false,\n\t\t\t},\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined,\n\t\t\t},\n\t\t\tisLoading: true,\n\t\t\tchapters: [],\n\t\t\tcomments: [],\n\t\t\t//searchResult: [],\n\t\t\t//books: []\n\t\t}\n\t\tthis.handleLogin = this.handleLogin.bind(this);\n\t\tthis.handleLogout = this.handleLogout.bind(this);\n\t\tthis.handleLogoutClick = this.handleLogoutClick.bind(this);\n\t\tthis.handleSuccessfulAuth = this.handleSuccessfulAuth.bind(this);\n\t\tthis.getBooks = this.getBooks.bind(this);\n\t\tthis.getTags = this.getTags.bind(this);\n\t\tthis.handleSearch = this.handleSearch.bind(this);\n\t}\n\n\thandleSuccessfulAuth(data) {\n\t\tthis.handleLogin(data);\n\t}\n\n\thandleLogout() {\n\t\tthis.showLogoutAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined\n\t\t\t}\n\t\t})\n\t\tthis.props.history.push(\"/\");\n\t}\n\n\tshowLogoutAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogout: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogoutClick() {\n\t\taxios.get('/user/logout')\n\t\t\t.then((response) => {\n\t\t\t\tthis.handleLogout();\n\t\t\t});\n\t}\n\n\tshowLoginAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogin: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogin(data) {\n\t\tthis.showLoginAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: data.id,\n\t\t\t\tusername: data.username,\n\t\t\t\temail: data.email,\n\t\t\t\trole: data.role\n\t\t\t}\n\t\t}, () => this.props.history.push({\n\t\t\tpathname: \"/users\",\n\t\t\tstate: { user: this.state.user }\n\t\t}))\n\t}\n\n\tasync getBooks() {\n\t\taxios\n\t\t\t.get(\"/book/allBooks\")\n\t\t\t.then(response => {\n\t\t\t\t//this.setState({ books: response.data }, () => this.setState({ isLoading: false }));\n\t\t\t\tlocalStorage.setItem('books', JSON.stringify(response.data))\n\t\t\t})\n\t\t\t.then(() => this.setState({ isLoading: false }));\n\t}\n\n\tgetUserData() {\n\t\taxios\n\t\t\t.get(\"/user/userData\")\n\t\t\t.then(response => {\n\t\t\t\t// console.log('getUserData:', response)\n\t\t\t\tif (response.data.status !== 'error') {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\tid: response.data.id,\n\t\t\t\t\t\t\tusername: response.data.username,\n\t\t\t\t\t\t\temail: response.data.email,\n\t\t\t\t\t\t\trole: response.data.role\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t})\n\t}\n\n\tgetTags() {\n\t\taxios.get('/book/getTags')\n\t\t.then((response) => {\n\t\t\tresponse.data.map(tag => {\n\t\t\t\t(tag.tags.map((entry) => { delete entry['customOption']; this.setState(state => ({ allTags: [...state.allTags, entry] })); return entry }));\n\t\t\t\treturn tag;\n\t\t\t})\n\t\t});\n\t}\n\n\thandleInputChange = (event) => {\n\t\tthis.setState({\n\t\t\t[event.target.name]: event.target.value,\n\t\t});\n\t};\n\n\thandleSearch() {\n\t\tconst { search } = this.state\n\t\tif (search) {\n\t\t\taxios\n\t\t\t\t.get(\"/book/allComments\")\n\t\t\t\t.then(response => {\n\t\t\t\t\tlocalStorage.setItem('comments', JSON.stringify(response.data))\n\t\t\t\t});\n\t\t\taxios\n\t\t\t\t.get(\"/book/allChapters\")\n\t\t\t\t.then(response => {\n\t\t\t\t\tlocalStorage.setItem('chapters', JSON.stringify(response.data))\n\t\t\t\t});\n\t\t\tconst idx = lunr(function () {\n\t\t\t\tthis.use(englishRussianSupport)\n\t\t\t\tthis.ref('id')\n\t\t\t\tthis.field('author')\n\t\t\t\tthis.field('title')\n\t\t\t\tthis.field('description')\n\t\t\t\tthis.field('text')\n\t\t\t\tJSON.parse(localStorage.getItem('books')).map(book => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: book.id,\n\t\t\t\t\t\ttitle: book.title,\n\t\t\t\t\t\tauthor: book.author,\n\t\t\t\t\t\tdescription: book.description,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t\tJSON.parse(localStorage.getItem('comments')).map(comment => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: comment.BookId,\n\t\t\t\t\t\ttext: comment.text,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t\tJSON.parse(localStorage.getItem('chapters')).map(chapter => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: chapter.BookId,\n\t\t\t\t\t\tchapter: chapter.text,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t})\n\t\t\tlocalStorage.setItem('searchResult', JSON.stringify(idx.search(search)))\n\t\t\tthis.props.history.replace({ pathname: `/search/${this.state.search}` })\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getUserData();\n\t\tthis.getBooks();\n\t}\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n\n\t\tif (isLoading) {\n\t\t\treturn <div>\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\n\t\t\t\t</Spinner>\n\t\t\t</div>;\n\t\t}\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Navbar collapseOnSelect sticky=\"top\" expand=\"sm\" bg=\"light\" variant=\"light\">\n\t\t\t\t\t<Navbar.Brand href=\"/\" ><h3>Mordor</h3></Navbar.Brand>\n\t\t\t\t\t<Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\n\t\t\t\t\t<Navbar.Collapse id=\"responsive-navbar-nav\">\n\t\t\t\t\t\t<Nav className=\"mr-auto\">\n\t\t\t\t\t\t\t{this.state.user && this.state.user.role === 'admin'\n\t\t\t\t\t\t\t\t? <Nav.Link href=\"/users\">\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\tUsers\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<Nav.Link href=\"/books\">\n\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\tFandoms\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t</Nav>\n\t\t\t\t\t\t{this.state.user && this.state.user.username\n\t\t\t\t\t\t\t? <Nav className=\"ml-auto\">\n\t\t\t\t\t\t\t\t<Nav.Link>\n\t\t\t\t\t\t\t\t\t<Button onClick={() => this.props.history.replace({ pathname: `/profile/${this.state.user.username}`, state: { user: this.state.user } })} variant=\"primary\">\n\t\t\t\t\t\t\t\t\t\tProfile\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t<Nav.Link>\n\t\t\t\t\t\t\t\t\t<Button onClick={this.handleLogoutClick} variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\tLogout\n\t\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t</Nav>\n\t\t\t\t\t\t\t: <Nav.Link href=\"/login\">\n\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\tLogin\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Navbar.Collapse>\n\t\t\t\t\t<div className=\"ml-lg-2 ml-md-2 ml-sm-2\">\n\t\t\t\t\t\t<InputGroup>\n\t\t\t\t\t\t\t<FormControl type=\"text\" placeholder=\"Search\" name=\"search\" onChange={this.handleInputChange} />\n\t\t\t\t\t\t\t<InputGroup.Prepend>\n\t\t\t\t\t\t\t\t<Button variant=\"outline-info\" onClick={this.handleSearch}>Search</Button>\n\t\t\t\t\t\t\t</InputGroup.Prepend>\n\t\t\t\t\t\t</InputGroup>\n\t\t\t\t\t</div>\n\t\t\t\t</Navbar>\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<Switch>\n\t\t\t\t\t\t<Route exact path=\"/\" render={props =>\n\t\t\t\t\t\t\t<Home {...props}\n\t\t\t\t\t\t\t\tbooks={this.state.books}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t} />\n\t\t\t\t\t\t<Route path=\"/profile/:id\" render={props =>\n\t\t\t\t\t\t\t<Profile {...props}\n\t\t\t\t\t\t\t\tbooks={JSON.parse(localStorage.getItem('books'))} //change later\n\t\t\t\t\t\t\t\trole={this.state.user.role}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t} />\n\t\t\t\t\t\t<Route path=\"/view/:bookid\" render={props =>\n\t\t\t\t\t\t\t<BookViewer {...props}\n\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\tuserId={this.state.user.id}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t} />\n\t\t\t\t\t\t<Route path=\"/edit/:bookid\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\trole={this.state.user.role}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path=\"/createBook\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<LoginRoute path=\"/login\" component={Login}\n\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Route path=\"/register\" render={props => (\n\t\t\t\t\t\t\t<Register {...props}\n\t\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route path=\"/users\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.role === 'admin') {\n\t\t\t\t\t\t\t\treturn <Users {...props}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path=\"/books\" render={props => (\n\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('books')).map((book, index) => (\n\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t<BookCard {...props}\n\t\t\t\t\t\t\t\t\t\t\tkey={book.id}\n\t\t\t\t\t\t\t\t\t\t\ttitle={book.title}\n\t\t\t\t\t\t\t\t\t\t\tdescription={book.description}\n\t\t\t\t\t\t\t\t\t\t\tauthor={book.author}\n\t\t\t\t\t\t\t\t\t\t\tupdatedAt={book.updatedAt}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route path=\"/search\" render={props => (\n\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('searchResult')).length > 0\n\t\t\t\t\t\t\t\t\t? JSON.parse(localStorage.getItem('searchResult')).map((result, index) => (\n\t\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t\t<Search {...props}\n\t\t\t\t\t\t\t\t\t\t\t\tresult={result}\n\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\t\t\t\tcomments={this.state.comments}\n\t\t\t\t\t\t\t\t\t\t\t\tchapters={this.state.chapters}\n\t\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t))\n\t\t\t\t\t\t\t\t\t: <div>\n\t\t\t\t\t\t\t\t\t\t<h3 className=\"mt-5 text-center\">\n\t\t\t\t\t\t\t\t\t\t\tNo search results found.\n\t\t\t\t\t\t\t\t\t\t\t</h3>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route path=\"*\" component={() => <h3 className=\"text-center\">404 NOT FOUND</h3>} />\n\t\t\t\t\t</Switch>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tshow={this.state.alert.logout}\n\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\tlogout: false\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\tYou logged out\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t</Toast>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tshow={this.state.alert.login}\n\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\tlogin: false\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t{this.state.user.username} logged in\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t</Toast>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default withRouter(App);","import 'bootstrap/dist/css/bootstrap.css';\nimport 'font-awesome/css/font-awesome.min.css'; \nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from \"history\";\nimport './index.css';\nimport App from './App';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://itransition-coursework.herokuapp.com';\n// axios.defaults.baseURL = 'http://localhost:5000';\n\nconst history = createBrowserHistory();\n\nReactDOM.render(\n  <Router history={history}>\n    <App />\n\t</Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}