{"version":3,"sources":["pages/components/BookCard.js","pages/components/BookCardRating.js","data/tags.js","pages/Home.js","pages/Login.js","pages/Register.js","data/columns.js","pages/Users.js","pages/Profile.js","data/genres.js","pages/CreateBook.js","pages/components/BookInfo.js","pages/components/CommentsSection.js","pages/BookViewer.js","LoginRoute.js","pages/components/Search.js","App.js","index.js"],"names":["BookCard","className","to","this","props","title","author","description","Date","updatedAt","toLocaleDateString","Component","withRouter","BookCardRating","value","rating","edit","count","isHalf","size","activeColor","toPrecision","tags","Home","name","JSON","parse","localStorage","getItem","filter","book","now","sort","reverse","map","index","id","slice","createdAt","a","b","ratingCount","minSize","maxSize","onClick","tag","alert","axios","defaults","withCredentials","Login","handleInputChange","event","setState","target","state","username","password","onClickLogin","bind","post","then","response","data","message","console","log","handleSuccessfulAuth","type","placeholder","onChange","Register","onClickRegister","email","columns","cell","row","Users","users","selectedRows","block","unblock","delete","blockUsers","unblockUsers","deleteUsers","getData","showBlockAlert","showUnblockAlert","showDeleteAlert","Promise","resolve","setTimeout","get","catch","err","history","push","prevState","includes","parseInt","userId","handleLogoutClick","Alert","show","variant","role","keyField","noDataIndication","hiddenRows","wrapperClasses","selectRow","mode","clickToSelect","onSelectAll","rows","isSelect","r","onSelect","Profile","handleChange","e","contentEditable","React","createRef","undefined","profileId","profileUsername","profileEmail","books","isLoading","getBooks","match","params","user","replace","pathname","getProfileData","getUserData","Spinner","animation","dataField","text","formatter","label","Badge","align","bookid","Button","hidden","Container","style","fontSize","fontWeight","width","onSave","updateUsername","Form","Control","readOnly","updateEmail","bootstrap4","defaultSorted","order","pagination","paginationFactory","genres","resetIds","list","el","ID","chapterId","resetNames","chapterName","CreateBook","handleValueChange","chapters","handleTabChange","activeTab","deleteChapter","chapter","editMode","multiple","bookId","genre","activeNav","desc","authorId","BookId","createBook","updateBook","onDragEnd","addChapter","Chapters","result","destination","startIndex","endIndex","splice","removed","reorder","source","chaptersCount","length","toString","location","openBook","Group","as","Row","Label","column","sm","Col","allowNew","highlightOnlyResult","newSelectionPrefix","options","labelKey","renderToken","option","onRemove","isSearchable","Card","maxWidth","Header","droppableId","provided","droppableProps","ref","innerRef","Accordion","tab","draggableId","draggableProps","dragHandleProps","display","alignItems","margin","AccordionToggle","eventKey","marginLeft","AccordionCollapse","selectedTab","onTabChange","generateMarkdownPreview","markdown","BookInfo","CommentsSection","ws","WebSocket","process","ORIGINAL_URL","preventDefault","addCommentsFromServer","comments","comment","onopen","onmessage","evt","onclose","UserId","send","stringify","Comment","Content","Author","Metadata","toLocaleString","Text","reply","TextArea","addReply","content","labelPosition","icon","primary","BookViewer","pushChapters","Pagination","Item","setActivePage","activePage","editable","setRating","setRatingBook","isRated","component","handleLogin","rest","render","Search","getBook","dataset","idx","find","lunr","require","englishRussianSupport","multiLanguage","App","search","login","logout","handleLogout","handleSearch","showLogoutAlert","showLoginAlert","setItem","Object","keys","use","field","add","Navbar","collapseOnSelect","sticky","expand","bg","Brand","href","Toggle","aria-controls","Collapse","Nav","Link","InputGroup","FormControl","Prepend","exact","path","ListGroup","key","Toast","position","top","right","onClose","delay","autohide","baseURL","createBrowserHistory","ReactDOM","document","getElementById"],"mappings":"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","file":"static/js/main.46dcf404.chunk.js","sourcesContent":["import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\n\r\nclass BookCard extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <small className=\"text-muted\">Last updated {new Date(this.props.updatedAt).toLocaleDateString()}</small>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCard)","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Link } from 'react-router-dom';\r\nimport ReactStars from \"react-rating-stars-component\";\r\n//import { Card } from 'react-bootstrap';\r\n\r\nclass BookCardRating extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"card border-info mb-3 mt-3\">\r\n        <div className=\"card-body text-info\">\r\n          <Link to={`/view/${this.props.title}`}>\r\n            <h3 className=\"card-text\" >{this.props.title}</h3>\r\n          </Link>\r\n          <Link to={`/profile/${this.props.author}`}>\r\n            <small className=\"text-muted\">{this.props.author}</small>\r\n          </Link>\r\n          <p className=\"card-text\">{this.props.description}</p>\r\n        </div>\r\n        <div className=\"card-footer\">\r\n          <div className=\"row d-flex\">\r\n            <div className=\"col-md-4\">\r\n            <ReactStars\r\n              value={this.props.rating}\r\n              edit={false}\r\n              count={5}\r\n              isHalf={true}\r\n              size={18}\r\n              activeColor=\"#ffd700\"\r\n            />\r\n            </div>\r\n            <div className=\"offset-col-md-4 small text\">\r\n              {this.props.rating.toPrecision(2)}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(BookCardRating)","const tags = [\r\n  {\r\n    value: 'Alaska',\r\n    count: 710249,\r\n  },\r\n  {\r\n    value: 'Arkansas',\r\n    count: 2915958,\r\n  },\r\n  {\r\n    value: 'California',\r\n    count: 37254503,\r\n  },\r\n  {\r\n    value: 'Connecticut',\r\n    count: 3574118\r\n  },\r\n  {\r\n    value: 'Florida',\r\n    count: 18804623,\r\n  },\r\n  {\r\n    value: 'Georgia',\r\n    count: 9688681,\r\n  },\r\n  {\r\n    value: 'Illinois',\r\n    count: 12831549,\r\n  },\r\n  {\r\n    value: 'Indiana',\r\n    count: 6484229,\r\n  },\r\n  {\r\n    value: 'Iowa',\r\n    count: 3046869,\r\n  },\r\n  {\r\n    value: 'Kansas',\r\n    count: 2853132,\r\n  },\r\n  {\r\n    value: 'Kentucky',\r\n    count: 4339349,\r\n  },\r\n  {\r\n    value: 'Louisiana',\r\n    count: 4533479,\r\n  },\r\n  {\r\n    value: 'Maine',\r\n    count: 1328361,\r\n  },\r\n  {\r\n    value: 'Maryland',\r\n    count: 5773785,\r\n  },\r\n  {\r\n    value: 'Massachusetts',\r\n    count: 6547817,\r\n  },\r\n  {\r\n    value: 'Michigan',\r\n    count: 9884129,\r\n  },\r\n  {\r\n    value: 'Minnesota',\r\n    count: 5303925,\r\n  },\r\n  {\r\n    value: 'Mississippi',\r\n    count: 2968103\r\n  },\r\n  {\r\n    value: 'Missouri',\r\n    count: 5988927,\r\n  },\r\n  {\r\n    value: 'Nebraska',\r\n    count: 1826341,\r\n  },\r\n  {\r\n    value: 'Nevada',\r\n    count: 2700691,\r\n  },\r\n  {\r\n    value: 'New Hampshire',\r\n    count: 1316466,\r\n  },\r\n  {\r\n    value: 'New Jersey',\r\n    count: 8791936,\r\n  },\r\n  {\r\n    value: 'New Mexico',\r\n    count: 2059192\r\n  },\r\n  {\r\n    value: 'New York',\r\n    count: 19378087,\r\n  },\r\n  {\r\n    value: 'North Carolina',\r\n    count: 9535692,\r\n  },\r\n  {\r\n    value: 'North Dakota',\r\n    count: 672591,\r\n  },\r\n  {\r\n    value: 'Ohio',\r\n    count: 11536725,\r\n  },\r\n  {\r\n    value: 'Oklahoma',\r\n    count: 3751616,\r\n  },\r\n  {\r\n    value: 'Pennsylvania',\r\n    count: 12702887,\r\n  },\r\n  {\r\n    value: 'Rhode Island',\r\n    count: 1052931,\r\n  },\r\n  {\r\n    value: 'South Carolina',\r\n    count: 4625401,\r\n  },\r\n  {\r\n    value: 'South Dakota',\r\n    count: 814191,\r\n  },\r\n  {\r\n    value: 'Tennessee',\r\n    count: 6346275,\r\n  },\r\n  {\r\n    value: 'Utah',\r\n    count: 2763888,\r\n  },\r\n  {\r\n    value: 'Vermont',\r\n    count: 625745,\r\n  },\r\n  {\r\n    value: 'Virginia',\r\n    count: 8001045,\r\n  },\r\n  {\r\n    value: 'Washington',\r\n    count: 6724543,\r\n  },\r\n  {\r\n    value: 'West Virginia',\r\n    count: 1853011,\r\n  },\r\n  {\r\n    value: 'Wisconsin',\r\n    count: 5687289,\r\n  },\r\n]\r\n\r\nexport default tags;","import React, { Component } from \"react\";\r\nimport BookCard from \"./components/BookCard\";\r\nimport BookCardRating from \"./components/BookCardRating\";\r\nimport { TagCloud } from 'react-tagcloud'\r\nimport tags from \"../data/tags\"\r\n\r\nclass Home extends Component {\r\n  render() {\r\n    return (\r\n      <>\r\n        <div className=\"container mt-3\">\r\n          <div className=\"row xl-3\">\r\n            <div name=\"recent\" className=\"col\">\r\n              <h3>Recently updated</h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .filter(book => new Date(book.updatedAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort()\r\n                .reverse()\r\n                .map((book, index) => (\r\n                  <BookCard\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    updatedAt={book.updatedAt}\r\n                  />\r\n                ))}\r\n            </div>\r\n            <div name=\"top\" className=\"col\">\r\n              <h3>Top fandoms of the week</h3>\r\n              {JSON.parse(localStorage.getItem('books'))\r\n                .slice(0, 5)\r\n                .filter(book => new Date(book.createdAt) > (new Date(Date.now() - 7 * 3600 * 1000 * 24)))\r\n                .sort((a, b) => (b.rating - a.rating))\r\n                .map((book, index) => (\r\n                  <BookCardRating\r\n                    key={book.id}\r\n                    title={book.title}\r\n                    description={book.description}\r\n                    author={book.author}\r\n                    rating={book.ratingCount ? (book.rating / book.ratingCount) : 0}\r\n                  />\r\n                ))\r\n              }\r\n            </div>\r\n            <div name=\"tags\" className=\"col\">\r\n              <h3>Tags</h3>\r\n              <TagCloud\r\n                minSize={12}\r\n                maxSize={48}\r\n                tags={tags}\r\n                onClick={tag => alert(`${tag.value} was selected!`)}\r\n              />\r\n              {/* tags */}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default Home","import React, { Component } from \"react\";\r\nimport { Link } from 'react-router-dom';\r\nimport axios from \"axios\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Login extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\tpassword: '',\r\n\t\t};\r\n\t\tthis.onClickLogin = this.onClickLogin.bind(this);\r\n\t};\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t};\r\n\r\n\tonClickLogin() {\r\n\t\tconst { username, password } = this.state;\r\n\t\taxios.post('user/login', {\r\n\t\t\tusername,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tconsole.log(response.data)\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"login\">\r\n\t\t\t\t<form>\r\n\t\t\t\t\t<h3 className=\"mb-3 text-center\">Sign In</h3>\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<div className=\"row mb-3 mt-5 justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Username</label>\r\n\t\t\t\t\t\t\t<input type=\"text\" className=\"col-3 form-control\" name=\"username\" placeholder=\"Enter username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Password</label>\r\n\t\t\t\t\t\t\t<input type=\"password\" className=\"col-3 form-control\" name=\"password\" placeholder=\"Enter password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"row mt-5 justify-content-center\">\r\n\t\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickLogin} className=\"btn btn-outline-primary\">Submit</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t\t<h3 className=\"mt-5 text-center\">\r\n\t\t\t\t\t<Link to=\"/register\" className=\"register_link\">\r\n\t\t\t\t\t\tCreate an account\r\n        \t\t</Link>\r\n\t\t\t\t</h3>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Login;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Register extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tusername: '',\r\n\t\t\temail: '',\r\n\t\t\tpassword: '',\r\n\t\t};\r\n\t}\r\n\r\n\thandleInputChange = (event) => {\r\n\t\tthis.setState({\r\n\t\t\t[event.target.name]: event.target.value,\r\n\t\t});\r\n\t}\r\n\r\n\tonClickRegister = () => {\r\n\t\tconst { username, email, password } = this.state;\r\n\t\taxios.post('/user/register', {\r\n\t\t\tusername,\r\n\t\t\temail,\r\n\t\t\tpassword,\r\n\t\t}).then((response) => {\r\n\t\t\tconsole.log(response);\r\n\t\t\tif (!response.data.message) {\r\n\t\t\t\tthis.props.handleSuccessfulAuth(response.data);\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"register\">\r\n\t\t\t\t<form>\r\n\t\t\t\t\t<h3 className=\"mb-3 text-center\">Sign Up</h3>\r\n\t\t\t\t\t<div className=\"container\">\r\n\t\t\t\t\t\t<div className=\"mb-3 mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Username</label>\r\n\t\t\t\t\t\t\t<input type=\"text\" className=\"col-3 form-control\" placeholder=\"Enter username\" name=\"username\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"mb-3 row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Email address</label>\r\n\t\t\t\t\t\t\t<input type=\"email\" className=\"col-3 form-control\" placeholder=\"name@example.com\" name=\"email\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\r\n\t\t\t\t\t\t<div className=\"row justify-content-center\">\r\n\t\t\t\t\t\t\t<label className=\"col-2 form-label\">Password</label>\r\n\t\t\t\t\t\t\t<input type=\"password\" className=\"col-3 form-control\" placeholder=\"Enter password\" name=\"password\" onChange={this.handleInputChange} />\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<div className=\"mt-5 row justify-content-center\">\r\n\t\t\t\t\t\t\t<button type=\"button\" onClick={this.onClickRegister} className=\"btn btn-outline-primary\">Submit</button>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</form>\r\n\t\t\t</div>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default Register;","import { Link } from 'react-router-dom';\r\n\r\nconst columns = [\r\n  {\r\n    \"dataField\": \"id\",\r\n    \"text\": \"ID\"\r\n  },\r\n  {\r\n    \"dataField\": \"username\",\r\n    \"text\": \"Username\",\r\n    \"formatter\": (cell, row) => <Link to={`/profile/${cell}`}> {cell} </Link>\r\n  },\r\n  {\r\n    \"dataField\": \"email\",\r\n    \"text\": \"Email\"\r\n  },\r\n  {\r\n    \"dataField\": \"createdAt\",\r\n    \"text\": \"Registration date\",\r\n    \"formatter\": (cell, row) => new Date(cell).toLocaleDateString()\r\n  },\r\n  {\r\n    \"dataField\": \"role\",\r\n    \"text\": \"Role\"\r\n  },\r\n  {\r\n    \"dataField\": \"status\",\r\n    \"text\": \"Block status\"\r\n  }\r\n]\r\n\r\nexport default columns;","import React, { Component } from \"react\";\r\nimport axios from \"axios\";\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport { withRouter } from \"react-router-dom\";\r\nimport { Alert } from 'react-bootstrap';\r\nimport columns from '../data/columns'\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass Users extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props)\r\n\r\n\t\tthis.state = {\r\n\t\t\tusers: [],\r\n\t\t\tselectedRows: [],\r\n\t\t\talert: {\r\n\t\t\t\tblock: false,\r\n\t\t\t\tunblock: false,\r\n\t\t\t\tdelete: false\r\n\t\t\t},\r\n\t\t}\r\n\r\n\t\tthis.blockUsers = this.blockUsers.bind(this);\r\n\t\tthis.unblockUsers = this.unblockUsers.bind(this);\r\n\t\tthis.deleteUsers = this.deleteUsers.bind(this);\r\n\t\tthis.getData = this.getData.bind(this);\r\n\t\tthis.showBlockAlert = this.showBlockAlert.bind(this);\r\n\t\tthis.showUnblockAlert = this.showUnblockAlert.bind(this);\r\n\t\tthis.showDeleteAlert = this.showDeleteAlert.bind(this);\r\n\t}\r\n\r\n\tasync getData() {\r\n\t\tawait new Promise(resolve => setTimeout(resolve, 200));\r\n\t\tlet data = [];\r\n\t\tdata = await axios.get('/user/usersTable')\r\n\t\t\t.then(response => {\r\n\t\t\t\treturn response.data;\r\n\t\t\t})\r\n\t\t\t.catch(err => {\r\n\t\t\t\tconsole.log(err);\r\n\t\t\t\tthis.props.history.push('/');\r\n\t\t\t});\r\n\t\tthis.setState({ users: data });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.getData();\r\n\t}\r\n\r\n\tshowBlockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowUnblockAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tunblock: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tunblock: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tshowDeleteAlert() {\r\n\t\tthis.setState(prevState => ({\r\n\t\t\talert:\r\n\t\t\t{\r\n\t\t\t\t...prevState.alert,\r\n\t\t\t\tdelete: true\r\n\t\t\t}\r\n\t\t}))\r\n\t\tsetTimeout(() => {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\talert:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.alert,\r\n\t\t\t\t\tdelete: false\r\n\t\t\t\t}\r\n\t\t\t}))\r\n\t\t}, 2000);\r\n\t}\r\n\r\n\tblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/block', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t\t}\r\n\t\t\t\t\telse {\r\n\t\t\t\t\t\tthis.showBlockAlert();\r\n\t\t\t\t\t\tthis.getData();\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t};\r\n\r\n\tunblockUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/unblock', {\r\n\t\t\tselectedRows,\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tif (response) {\r\n\t\t\t\t\tthis.showUnblockAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t};\r\n\r\n\tdeleteUsers() {\r\n\t\tconst selectedRows = this.state.selectedRows;\r\n\t\taxios.post('/table/delete', {\r\n\t\t\tselectedRows,\r\n\t\t}).then((response) => {\r\n\t\t\tif (response) {\r\n\t\t\t\tif (selectedRows.includes(parseInt(this.props.userId))) {\r\n\t\t\t\t\tthis.handleLogoutClick();\r\n\t\t\t\t}\r\n\t\t\t\telse {\r\n\t\t\t\t\tthis.showDeleteAlert();\r\n\t\t\t\t\tthis.getData();\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t});\r\n\t};\r\n\r\n\trender() {\r\n\t\treturn (\r\n\t\t\t<div className=\"container mt-3\">\r\n\t\t\t\t<Alert show={this.state.alert.block} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are blocked\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.unblock} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are unblocked\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<Alert show={this.state.alert.delete} variant=\"danger\">\r\n\t\t\t\t\t<p>\r\n\t\t\t\t\t\tUsers are deleted\r\n\t\t\t\t\t</p>\r\n\t\t\t\t</Alert>\r\n\t\t\t\t<div className=\"btn-group mb-3\" role=\"group\">\r\n\t\t\t\t\t<button onClick={this.blockUsers} type=\"button\" className=\"btn btn-outline-primary\">Block</button>\r\n\t\t\t\t\t<button onClick={this.unblockUsers} type=\"button\" className=\"btn btn-outline-primary\">Unblock</button>\r\n\t\t\t\t\t<button onClick={this.deleteUsers} type=\"button\" className=\"btn btn-outline-danger\">Delete</button>\r\n\t\t\t\t</div>\r\n\t\t\t\t<BootstrapTable\r\n\t\t\t\t\tkeyField='id'\r\n\t\t\t\t\tnoDataIndication=\"Table is Empty\"\r\n\t\t\t\t\tdata={this.state.users}\r\n\t\t\t\t\tcolumns={columns}\r\n\t\t\t\t\thiddenRows={[5]} //Admin ID\r\n\t\t\t\t\twrapperClasses=\"table-responsive\"\r\n\t\t\t\t\tselectRow={{\r\n\t\t\t\t\t\tmode: 'checkbox',\r\n\t\t\t\t\t\tclickToSelect: true,\r\n\t\t\t\t\t\tonSelectAll: (row, rows, isSelect) => {\r\n\t\t\t\t\t\t\tif (row) {\r\n\t\t\t\t\t\t\t\tfor (let r of rows) {\r\n\t\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, r.id]\r\n\t\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({ selectedRows: [] });\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t},\r\n\t\t\t\t\t\tonSelect: (row, isSelect) => {\r\n\t\t\t\t\t\t\tif (isSelect) {\r\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\r\n\t\t\t\t\t\t\t\t\tselectedRows: [...prevState.selectedRows, row.id]\r\n\t\t\t\t\t\t\t\t}))\r\n\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\tthis.setState({\r\n\t\t\t\t\t\t\t\t\tselectedRows: this.state.selectedRows.filter(function (selectedRows) {\r\n\t\t\t\t\t\t\t\t\t\treturn selectedRows !== row.id\r\n\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}}\r\n\t\t\t\t/>\r\n\t\t\t</div>\r\n\t\t)\r\n\t}\r\n}\r\n\r\nexport default withRouter(Users);","import React, { Component } from \"react\";\r\nimport { Button, Badge, Form, Container, Spinner } from \"react-bootstrap\";\r\nimport { Link } from 'react-router-dom';\r\nimport BootstrapTable from 'react-bootstrap-table-next';\r\nimport paginationFactory from 'react-bootstrap-table2-paginator';\r\nimport { BsX } from \"react-icons/bs\";\r\nimport axios from 'axios';\r\nimport { withRouter } from \"react-router\";\r\nimport SimpleEditable from 'react-bootstrap-simple-editable';\r\nimport 'react-bootstrap-simple-editable/dist/index.css'\r\n\r\nclass Profile extends Component {\r\n  constructor() {\r\n    super();\r\n    this.contentEditable = React.createRef();\r\n    this.state = {\r\n      id: undefined,\r\n      profileId: undefined,\r\n      username: \"\",\r\n      profileUsername: \"\",\r\n      email: \"\",\r\n      profileEmail: \"\",\r\n      books: [],\r\n      isLoading: true,\r\n    }\r\n    this.getBooks = this.getBooks.bind(this);\r\n  }\r\n\r\n  handleChange = e => {\r\n    this.setState({ [e.target.name]: e.target.value });\r\n  };\r\n\r\n  getBooks() {\r\n    const username = this.props.match.params.id; //change later\r\n    axios\r\n      .get(\"/book/userBooks\", {\r\n        params: {\r\n          username: username\r\n        }\r\n      })\r\n      .then(response => {\r\n        this.setState({ books: response.data });\r\n      });\r\n  }\r\n\r\n  getUserData() {\r\n    axios\r\n      .get(\"/user/userData\")\r\n      .then(response => {\r\n        if (response.data.user) {\r\n          this.setState({\r\n            id: response.data.user.id,\r\n            username: response.data.user.username,\r\n            email: response.data.user.email\r\n          }, () => this.setState({ isLoading: false }))\r\n        } else {\r\n          this.setState({ isLoading: false })\r\n        }\r\n      })\r\n  }\r\n\r\n  getProfileData() {\r\n    axios\r\n      .get(\"/user/profileData\",\r\n        {\r\n          params: {\r\n            username: this.props.match.params.id,\r\n          }\r\n        })\r\n      .then(response => {\r\n        this.setState({\r\n          profileId: response.data.id,\r\n          profileUsername: response.data.username,\r\n          profileEmail: response.data.email\r\n        })\r\n      })\r\n  }\r\n\r\n  updateUsername() {\r\n    const { username } = this.state;\r\n    axios\r\n      .post(\"/user/updateUsername\", { username })\r\n      .then(response => {\r\n        this.props.history.replace({ pathname: `/profile/${this.state.username}` })\r\n      })\r\n  }\r\n\r\n  updateEmail() {\r\n    const { email } = this.state;\r\n    axios\r\n      .post(\"/user/updateEmail\", { email })\r\n      .then(response => {\r\n      })\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBooks();\r\n    this.getProfileData();\r\n    this.getUserData();\r\n  }\r\n\r\n  render() {\r\n    const { isLoading } = this.state;\r\n    console.log(this.props)\r\n    console.log(this.state)\r\n    if (isLoading) {\r\n      return <div>\r\n        <Spinner animation=\"border\" role=\"status\">\r\n          <span className=\"sr-only\">Loading...</span>\r\n        </Spinner>\r\n      </div>;\r\n    }\r\n\r\n    const columns = [\r\n      {\r\n        dataField: \"title\",\r\n        text: \"Title\",\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"genre\",\r\n        text: \"Genre\"\r\n      },\r\n      {\r\n        dataField: \"tags\",\r\n        text: \"Tags\",\r\n        formatter: (cell, row) => cell.map((label, index) => { return (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">{label.label}</Badge>) })\r\n      },\r\n      {\r\n        dataField: \"rating\",\r\n        text: \"Rating\",\r\n        formatter: (cell, row) => row.ratingCount !== 0 ? (cell / row.ratingCount).toPrecision(2) : 0,\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"createdAt\",\r\n        text: \"Publication Date\",\r\n        formatter: (cell, row) => new Date(cell).toLocaleDateString(),\r\n        sort: true\r\n      },\r\n      {\r\n        dataField: \"Edit\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => \r\n          <Link to={{ pathname: `/edit/${row.title}`, state: { bookid: row.title } }}>\r\n            <Button variant=\"secondary\">\r\n              Edit\r\n            </Button>\r\n          </Link>,\r\n        hidden: this.state.username === this.state.profileUsername ? false : true\r\n      },\r\n      {\r\n        dataField: \"View\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => \r\n          <Link to={`/view/${row.title}`}>\r\n            <Button variant=\"secondary\">\r\n              View\r\n            </Button>\r\n          </Link>\r\n      },\r\n      {\r\n        dataField: \"Delete\",\r\n        text: \"\",\r\n        align: 'center',\r\n        formatter: (cell, row) => <Link to=\"\"> <BsX /> </Link>,\r\n        hidden: this.state.username === this.state.profileUsername ? false : true\r\n      }\r\n    ]\r\n    \r\n    return (\r\n      <>\r\n        <Container className=\"container mt-3\">\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold',\r\n              width: 'auto',\r\n            }}>\r\n              Username:\r\n              </div>\r\n            <div className=\"p-1 ml-3\">\r\n              {this.state.username === this.state.profileUsername\r\n                ? <SimpleEditable\r\n                  type=\"text\"\r\n                  name=\"username\"\r\n                  value={this.state.username}\r\n                  onSave={(value) => { this.setState({ username: value }, () => this.updateUsername()) }}\r\n                />\r\n                : <>\r\n                  <Form.Control type=\"text\" placeholder={this.state.profileUsername} readOnly />\r\n                </>\r\n              }\r\n            </div>\r\n          </div>\r\n          <div className=\"row mt-1\">\r\n            <div className=\"mb-1\" style={{\r\n              fontSize: 24,\r\n              fontWeight: 'bold'\r\n            }}>\r\n              Email:\r\n              </div>\r\n            <div className=\"p-1 ml-3\">\r\n              {this.state.email === this.state.profileEmail\r\n                ? <SimpleEditable\r\n                  type=\"text\"\r\n                  name=\"email\"\r\n                  //className=\"mt-3 mb-3\"\r\n                  value={this.state.email}\r\n                  onSave={(value) => { this.setState({ email: value }, () => this.updateEmail()) }}\r\n                />\r\n                : <Form.Control type=\"text\" placeholder={this.state.profileEmail} readOnly /> //CHANGE\r\n              }\r\n            </div>\r\n          </div>\r\n\r\n          <div className=\"container mt-3\">\r\n            {(this.state.username === this.props.match.params.id)\r\n              ? <div className=\"mt-3 mb-3\">\r\n                <Link to={\"/createBook\"}>\r\n                  <Button className=\"shadow-sm\" variant=\"outline-success\" >\r\n                    Create a book\r\n              </Button>\r\n                </Link>\r\n              </div>\r\n              : null\r\n            }\r\n\r\n            <BootstrapTable\r\n              bootstrap4\r\n              keyField='id'\r\n              noDataIndication=\"Table is Empty\"\r\n              data={this.state.books}\r\n              columns={columns}\r\n              defaultSorted={[{\r\n                dataField: 'createdAt',\r\n                order: 'desc'\r\n              }]}\r\n              wrapperClasses=\"table-responsive\"\r\n              pagination={paginationFactory()}\r\n            />\r\n          </div>\r\n        </Container>\r\n      </>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(Profile);","const genres = [\r\n  { value: 'fantasy', label: 'Fantasy' },\r\n  { value: 'action', label: 'Action' },\r\n  { value: 'adventure', label: 'Adventure' },\r\n  { value: 'detective', label: 'Detective' },\r\n  { value: 'romance', label: 'Romance' },\r\n  { value: 'sci-fi', label: 'Sci-Fi' },\r\n  { value: 'horror', label: 'Horror' },\r\n  { value: 'thriller', label: 'Thriller' },\r\n  { value: 'erotic', label: 'Erotic' },\r\n]\r\n\r\nexport default genres;","import React, { Component, Fragment } from \"react\";\r\nimport { Spinner, Form, Row, Col, Button, Accordion, Card, AccordionToggle, AccordionCollapse } from \"react-bootstrap\";\r\nimport { Typeahead, Token } from 'react-bootstrap-typeahead';\r\nimport { DragDropContext, Droppable, Draggable } from 'react-beautiful-dnd';\r\nimport { BsPlus, BsX } from \"react-icons/bs\";\r\nimport { withRouter } from \"react-router\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactMde from \"react-mde\";\r\nimport axios from 'axios';\r\nimport Select from 'react-select'\r\nimport tags from '../data/tags';\r\nimport genres from '../data/genres';\r\nimport 'react-bootstrap-typeahead/css/Typeahead.css';\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nconst reorder = (list, startIndex, endIndex) => {\r\n\tconst result = list;\r\n\tconst [removed] = result.splice(startIndex, 1);\r\n\tresult.splice(endIndex, 0, removed);\r\n\treturn resetNames(resetIds(result));\r\n};\r\n\r\nconst resetIds = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst ID = el;\r\n\t\tID.chapterId = index + 1;\r\n\t\treturn ID;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nconst resetNames = list => {\r\n\tconst resetList = list.map((el, index) => {\r\n\t\tconst name = el;\r\n\t\tname.chapterName = index + 1;\r\n\t\treturn name;\r\n\t})\r\n\treturn resetList;\r\n};\r\n\r\nclass CreateBook extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\teditMode: false,\r\n\t\t\tisLoading: true,\r\n\t\t\tmultiple: true,\r\n\t\t\tbookId: \"\",\r\n\t\t\ttags: [],\r\n\t\t\tgenre: \"\",\r\n\t\t\tactiveNav: \"write\",\r\n\t\t\tdesc: \"\",\r\n\t\t\ttitle: \"\",\r\n\t\t\tauthor: \"\",\r\n\t\t\tauthorId: \"\",\r\n\t\t\tchapters: [\r\n\t\t\t\t{\r\n\t\t\t\t\tchapterId: 1,\r\n\t\t\t\t\tid: '',\r\n\t\t\t\t\tchapterName: '1',\r\n\t\t\t\t\ttext: '',\r\n\t\t\t\t\tBookId: '',\r\n\t\t\t\t}\r\n\t\t\t],\r\n\t\t}\r\n\t\tthis.createBook = this.createBook.bind(this);\r\n\t\tthis.updateBook = this.updateBook.bind(this);\r\n\t\tthis.onDragEnd = this.onDragEnd.bind(this);\r\n\t\tthis.addChapter = this.addChapter.bind(this);\r\n\t\tthis.deleteChapter = this.deleteChapter.bind(this);\r\n\t}\r\n\r\n\topenBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\taxios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t},\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({\r\n\t\t\t\t\ttitle: response.data.title,\r\n\t\t\t\t\tbookId: response.data.id,\r\n\t\t\t\t\ttags: response.data.tags,\r\n\t\t\t\t\tgenre: response.data.genre,\r\n\t\t\t\t\tdesc: response.data.description,\r\n\t\t\t\t\tauthor: response.data.author,\r\n\t\t\t\t\tauthorId: response.data.authorId,\r\n\t\t\t\t\tchapters: response.data.Chapters\r\n\t\t\t\t},\r\n\t\t\t\t\t() => {\r\n\t\t\t\t\t\tif (this.props.role === 'admin' || this.props.user === this.state.author) {\r\n\t\t\t\t\t\t\tthis.state.chapters.map((chapter) => {\r\n\t\t\t\t\t\t\t\tdelete chapter['createdAt'];\r\n\t\t\t\t\t\t\t\tdelete chapter['updatedAt'];\r\n\t\t\t\t\t\t\t\treturn chapter;\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\tthis.setState({ isLoading: false })\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tthis.props.history.push(\"/\");\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t});\r\n\t};\r\n\r\n\tonDragEnd(result) {\r\n\t\tif (!result.destination) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tconst chapters = reorder(\r\n\t\t\tthis.state.chapters,\r\n\t\t\tresult.source.index,\r\n\t\t\tresult.destination.index\r\n\t\t);\r\n\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\thandleValueChange = (e, index) => {\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tchapters[index].text = e;\r\n\t\tthis.setState({ chapters });\r\n\t\t/*this.setState(prevState => ({\r\n\t\t\tchapters: {\r\n\t\t\t\t...prevState.chapters,\r\n\t\t\t\t[prevState.chapters[index].text]: e,\r\n\t\t\t},\r\n\t\t}));*/\r\n\t};\r\n\r\n\thandleTabChange = activeTab => {\r\n\t\tthis.setState({ activeTab });\r\n\t};\r\n\r\n\taddChapter() {\r\n\t\t//console.log(this.state.chapters.length)\r\n\t\tconst chaptersCount = this.state.chapters.length + 1;\r\n\t\tconst chapters = this.state.chapters;\r\n\t\tconst chapter = {\r\n\t\t\tBookId: this.state.bookId,\r\n\t\t\tchapterId: chaptersCount,\r\n\t\t\tchapterName: chaptersCount.toString(),\r\n\t\t\ttext: ''\r\n\t\t}\r\n\t\tchapters.push(chapter);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\tdeleteChapter = id => {\r\n\t\tconst chapters = this.state.chapters.filter((chapter) => chapter.chapterId !== id);\r\n\t\tthis.setState({ chapters: chapters });\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tthis.setState({ author: this.props.user, authorId: this.props.userId })\r\n\t\tif (this.props.location.pathname === `/edit/${this.props.match.params.bookid}`) {\r\n\t\t\tthis.setState({ editMode: true }, () => this.openBook())\r\n\t\t} else {\r\n\t\t\tthis.setState({ isLoading: false })\r\n\t\t}\r\n\t}\r\n\r\n\tcreateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/createBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, chapters\r\n\t\t})\r\n\t\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\tupdateBook() {\r\n\t\tconst {\r\n\t\t\tauthor,\r\n\t\t\tauthorId,\r\n\t\t\ttags,\r\n\t\t\tgenre,\r\n\t\t\tdesc,\r\n\t\t\ttitle,\r\n\t\t\tbookId,\r\n\t\t\tchapters\r\n\t\t} = this.state;\r\n\t\taxios.post('/book/updateBook', {\r\n\t\t\tauthor, authorId, tags, genre, desc, title, bookId, chapters\r\n\t\t})\r\n\t\t\t.then((response) => { });\r\n\t\tthis.props.history.push(`/view/${title}`);\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<div className=\"mt-4\">\r\n\t\t\t\t\t<Form>\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tTitle\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.title}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ title: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tDescription\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Form.Control\r\n\t\t\t\t\t\t\t\t\tas=\"textarea\"\r\n\t\t\t\t\t\t\t\t\trows={3}\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.desc}\r\n\t\t\t\t\t\t\t\t\tonChange={event => { this.setState({ desc: event.target.value }) }}\r\n\t\t\t\t\t\t\t\t\ttype=\"text\"\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tTags\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Fragment>\r\n\t\t\t\t\t\t\t\t\t<Typeahead\r\n\t\t\t\t\t\t\t\t\t\t{...this.state}\r\n\t\t\t\t\t\t\t\t\t\tallowNew={true}\r\n\t\t\t\t\t\t\t\t\t\thighlightOnlyResult={false}\r\n\t\t\t\t\t\t\t\t\t\tnewSelectionPrefix=\"Add a new tag: \"\r\n\t\t\t\t\t\t\t\t\t\tid=\"tags-token\"\r\n\t\t\t\t\t\t\t\t\t\toptions={tags}\r\n\t\t\t\t\t\t\t\t\t\tlabelKey=\"value\"\r\n\t\t\t\t\t\t\t\t\t\tonChange={(tags) => this.setState({ tags })}\r\n\t\t\t\t\t\t\t\t\t\tplaceholder=\"Start typing...\"\r\n\t\t\t\t\t\t\t\t\t\trenderToken={(option, { onRemove }, index) => {\r\n\t\t\t\t\t\t\t\t\t\t\treturn (\r\n\t\t\t\t\t\t\t\t\t\t\t\t<Token key={index} option={option} onRemove={onRemove}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t{`${option.value}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t</Token>\r\n\t\t\t\t\t\t\t\t\t\t\t);\r\n\t\t\t\t\t\t\t\t\t\t}}\r\n\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t</Fragment>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\r\n\t\t\t\t\t\t<Form.Group as={Row}>\r\n\t\t\t\t\t\t\t<Form.Label column sm={2}>\r\n\t\t\t\t\t\t\t\tGenre\r\n\t\t\t\t\t\t</Form.Label>\r\n\t\t\t\t\t\t\t<Col sm={6}>\r\n\t\t\t\t\t\t\t\t<Select\r\n\t\t\t\t\t\t\t\t\tvalue={this.state.genre}\r\n\t\t\t\t\t\t\t\t\tonChange={(genre) => this.setState({ genre })}\r\n\t\t\t\t\t\t\t\t\tisSearchable={false}\r\n\t\t\t\t\t\t\t\t\toptions={genres}\r\n\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t</Col>\r\n\t\t\t\t\t\t</Form.Group>\r\n\t\t\t\t\t</Form>\r\n\r\n\t\t\t\t\t<Card style={{ maxWidth: '45.5rem' }} onClick={this.addChapter}>\r\n\t\t\t\t\t\t<Card.Header as={Button} variant=\"light\">\r\n\t\t\t\t\t\t\t<BsPlus />\r\n\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t</Card>\r\n\r\n\t\t\t\t\t<DragDropContext onDragEnd={this.onDragEnd}>\r\n\t\t\t\t\t\t<Droppable droppableId=\"droppable\" >\r\n\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t<div className=\"col-xs\"\r\n\t\t\t\t\t\t\t\t\t{...provided.droppableProps}\r\n\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t<Accordion>\r\n\t\t\t\t\t\t\t\t\t\t{(this.state.chapters).map((tab, index) => (\r\n\t\t\t\t\t\t\t\t\t\t\t<Draggable\r\n\t\t\t\t\t\t\t\t\t\t\t\tkey={tab.chapterId}\r\n\t\t\t\t\t\t\t\t\t\t\t\tdraggableId={tab.chapterId.toString()}\r\n\t\t\t\t\t\t\t\t\t\t\t\tindex={index}\r\n\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t{(provided) => (\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t<div\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\tref={provided.innerRef}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.draggableProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t{...provided.dragHandleProps}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card key={index} style={{ maxWidth: '45.5rem' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<Card.Header style={{ display: 'flex', alignItems: 'center', margin: '0' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionToggle as={Button} variant=\"link\" eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{this.state.editMode ? `Chapter ${tab.chapterId}` : `Chapter ${tab.chapterName}`}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionToggle>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t{(index + 1 === this.state.chapters.length)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t? <Button variant=\"link\" onClick={() => { this.deleteChapter(tab.chapterId) }} style={{ marginLeft: 'auto' }}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<BsX />\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Button>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card.Header>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<AccordionCollapse eventKey={tab.chapterId}>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t<ReactMde\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tvalue={this.state.chapters[index].text}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonChange={\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\te => {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tthis.handleValueChange(e, index)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tselectedTab={this.state.activeTab}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tonTabChange={this.handleTabChange}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tgenerateMarkdownPreview={(markdown) =>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\tPromise.resolve(<ReactMarkdown source={markdown} />)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t\t</AccordionCollapse>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t\t</Card>\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t\t\t\t\t\t</Draggable>\r\n\t\t\t\t\t\t\t\t\t\t))}\r\n\t\t\t\t\t\t\t\t\t\t{provided.placeholder}\r\n\t\t\t\t\t\t\t\t\t</Accordion>\r\n\t\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t\t)}\r\n\t\t\t\t\t\t</Droppable>\r\n\t\t\t\t\t</DragDropContext>\r\n\r\n\t\t\t\t\t<div className=\"mt-3\">\r\n\t\t\t\t\t\t{this.state.editMode\r\n\t\t\t\t\t\t\t? <Button onClick={this.updateBook} variant=\"outline-success\">Update</Button>\r\n\t\t\t\t\t\t\t: <Button onClick={this.createBook} variant=\"outline-success\">Publish</Button>\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t</div>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(CreateBook);","import React, { Component } from \"react\";\r\n\r\nclass BookInfo extends Component {\r\n  render() {\r\n    return (\r\n      <div className=\"row mt-1\">\r\n        <div className=\"p-1 mr-5\">\r\n          {this.props.label}\r\n        </div>\r\n        <div>\r\n          {this.props.value}\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default BookInfo","import React, { Component } from \"react\";\r\nimport { withRouter } from \"react-router\";\r\nimport { Comment, Form, Button } from 'semantic-ui-react'\r\nimport 'semantic-ui-css/components/comment.min.css'\r\nimport 'semantic-ui-css/components/form.min.css'\r\nimport 'semantic-ui-css/components/button.min.css'\r\nimport 'semantic-ui-css/components/icon.min.css'\r\n\r\nclass CommentsSection extends Component {\r\n  constructor(props) {\r\n    super(props);\r\n    this.state = {\r\n      comments: [],\r\n      comment: ''\r\n    };\r\n  }\r\n  ws = new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`)\r\n\r\n  handleInputChange = (event) => {\r\n    event.preventDefault();\r\n    this.setState({\r\n      [event.target.name]: event.target.value,\r\n    });\r\n  };\r\n\r\n  componentDidMount() {\r\n    this.ws.onopen = () => {\r\n      // on connecting, do nothing but log it to the console\r\n      console.log('Connected to server')\r\n    }\r\n    this.ws.onmessage = evt => {\r\n      // on receiving a message, add it to the list of messages\r\n      const comment = JSON.parse(evt.data)\r\n      this.addCommentsFromServer(comment);\r\n    }\r\n    this.ws.onclose = () => {\r\n      console.log('Disconnected from server')\r\n      // automatically try to reconnect on connection loss\r\n      this.setState({\r\n        ws: new WebSocket(`ws://${process.env.ORIGINAL_URL || \"localhost:5000\"}/${this.props.bookId}`),\r\n      })\r\n    }\r\n  }\r\n\r\n  addCommentsFromServer = comments => {\r\n    // this.setState(state => ({ comments: [comment, ...state.comments] }))\r\n    this.setState(state => ({ comments: comments }))\r\n  }\r\n\r\n  addReply() {\r\n    if (this.state.comment) {\r\n      const comment = {\r\n        author: this.props.username,\r\n        UserId: this.props.userId,\r\n        BookId: this.props.bookId,\r\n        text: this.state.comment\r\n      }\r\n      this.ws.send(JSON.stringify(comment))\r\n      this.setState({ comment: '' })\r\n    }\r\n  }\r\n\r\n  render() {\r\n    return (\r\n      <div>\r\n        <Comment.Group size='small'>\r\n          {this.state.comments.map((comment, index) => (\r\n            <Comment key={index}>\r\n              <Comment.Content>\r\n                <Comment.Author as='a'>{comment.author}</Comment.Author>\r\n                <Comment.Metadata>\r\n                  <div>{new Date(comment.createdAt).toLocaleString(\"ru-RU\")}</div>\r\n                </Comment.Metadata>\r\n                <Comment.Text>{comment.text}</Comment.Text>\r\n              </Comment.Content>\r\n            </Comment>\r\n          ))}\r\n        </Comment.Group>\r\n        {this.props.username ?\r\n          <Form reply>\r\n            <Form.TextArea\r\n              value={this.state.comment}\r\n              onChange={e => this.handleInputChange(e)}\r\n              name='comment'\r\n              width={8}\r\n            />\r\n            <Button\r\n              ws={this.ws}\r\n              onClick={() => this.addReply()}\r\n              content='Add Reply'\r\n              labelPosition='left'\r\n              icon='edit'\r\n              size='small'\r\n              primary\r\n            />\r\n          </Form>\r\n          : null}\r\n      </div>\r\n    )\r\n  }\r\n}\r\n\r\nexport default withRouter(CommentsSection);","import React, { Component } from \"react\";\r\nimport { Spinner, Button, Pagination, Container, Badge } from \"react-bootstrap\";\r\nimport ReactMarkdown from 'react-markdown';\r\nimport ReactStars from \"react-rating-stars-component\";\r\nimport axios from 'axios';\r\nimport BookInfo from \"./components/BookInfo\";\r\nimport CommentsSection from \"./components/CommentsSection\";\r\nimport { withRouter } from \"react-router\";\r\nimport \"react-mde/lib/styles/css/react-mde-all.css\";\r\n\r\naxios.defaults.withCredentials = true;\r\n\r\nclass BookViewer extends Component {\r\n\tconstructor(props) {\r\n\t\tsuper(props);\r\n\t\tthis.state = {\r\n\t\t\tisLoading: true,\r\n\t\t\tbook: [],\r\n\t\t\tactivePage: \"\",\r\n\t\t\teditable: true,\r\n\t\t\tcomments: false,\r\n\t\t}\r\n\t\tthis.setRating = this.setRating.bind(this);\r\n\t\tthis.setRatingBook = this.setRatingBook.bind(this);\r\n\t\tthis.setActivePage = this.setActivePage.bind(this);\r\n\t\tthis.pushChapters = this.pushChapters.bind(this);\r\n\t}\r\n\r\n\tcomponentDidMount() {\r\n\t\tif (this.props.user === undefined) {\r\n\t\t\tthis.setState({ editable: false });\r\n\t\t}\r\n\t\tthis.openBook()\r\n\t}\r\n\r\n\tisRated() {\r\n\t\tconst bookId = this.state.book.id;\r\n\t\tconst authorId = this.props.userId;\r\n\t\tconsole.log(this.props);\r\n\t\taxios.get('/book/isRated', {\r\n\t\t\tparams: {\r\n\t\t\t\tauthorId, bookId\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconsole.log(response)\r\n\t\t\t\tif (response.data.message) {\r\n\t\t\t\t\tthis.setState({ editable: false })\r\n\t\t\t\t}\r\n\t\t\t});\r\n\t}\r\n\r\n\topenBook() {\r\n\t\tconst title = this.props.match.params.bookid;\r\n\t\taxios.get('/book/openBook', {\r\n\t\t\tparams: {\r\n\t\t\t\ttitle: title,\r\n\t\t\t}\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tthis.setState({ book: response.data },\r\n\t\t\t\t\t() => this.props.user ? this.isRated() : null, this.setState({ isLoading: false }))\r\n\t\t\t});\r\n\t};\r\n\r\n\tsetActivePage(index) {\r\n\t\tthis.setState({ activePage: index });\r\n\t}\r\n\r\n\tpushChapters = () => {\r\n\t\tlet chapters = [];\r\n\t\tif (this.state.book.Chapters) {\r\n\t\t\tthis.state.book.Chapters.map((chapter, index) => {\r\n\t\t\t\tchapters.push(\r\n\t\t\t\t\t<Pagination.Item onClick={() => { this.setActivePage(index); this.setState({ comments: false }) }} key={index}>{index + 1}</Pagination.Item>\r\n\t\t\t\t)\r\n\t\t\t\treturn chapters\r\n\t\t\t})\r\n\t\t}\r\n\t\treturn chapters;\r\n\t}\r\n\r\n\tsetRating(value) {\r\n\t\tif (this.props.user) {\r\n\t\t\tthis.setState(prevState => ({\r\n\t\t\t\tbook:\r\n\t\t\t\t{\r\n\t\t\t\t\t...prevState.book,\r\n\t\t\t\t\trating: this.state.editable ? prevState.book.rating + value : prevState.book.rating,\r\n\t\t\t\t\tratingCount: this.state.editable ? prevState.book.ratingCount + 1 : prevState.book.ratingCount,\r\n\t\t\t\t},\r\n\t\t\t\teditable: false\r\n\t\t\t}))\r\n\t\t} else {\r\n\t\t\tconsole.log(\"You have to login to set a rating.\")\r\n\t\t}\r\n\t}\r\n\r\n\tsetRatingBook() {\r\n\t\tif (this.props.user) {\r\n\t\tconst author = this.props.user;\r\n\t\tconst bookId = this.state.book.id;\r\n\t\tconst rating = this.state.book.rating;\r\n\t\tconst authorId = this.props.userId;\r\n\t\tconst ratingCount = this.state.book.ratingCount;\r\n\t\taxios.post('/book/setRating', {\r\n\t\t\tauthor, authorId, bookId, rating, ratingCount\r\n\t\t})\r\n\t\t\t.then((response) => {\r\n\t\t\t\tconsole.log(response);\r\n\t\t\t});\r\n\t\t} else {\r\n\t\t\tconsole.log('You have to login to set a rating.')\r\n\t\t}\r\n\t};\r\n\r\n\trender() {\r\n\t\tconst { isLoading } = this.state;\r\n\t\tconsole.log(this.props)\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n\r\n\t\treturn (\r\n\t\t\t<>\r\n\t\t\t\t<Container className=\"container\">\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Title:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.title}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Author:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.author}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Description:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.description}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<BookInfo\r\n\t\t\t\t\t\tlabel={\"Genre:\"}\r\n\t\t\t\t\t\tvalue={this.state.book.genre}\r\n\t\t\t\t\t/>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\tTags:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{this.state.book.tags\r\n\t\t\t\t\t\t\t? this.state.book.tags.map((tag, index) => {\r\n\t\t\t\t\t\t\t\treturn (<Badge key={index} className=\"mr-2 p-2\" variant=\"secondary\">\r\n\t\t\t\t\t\t\t\t\t{tag.label}\r\n\t\t\t\t\t\t\t\t</Badge>)\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t: null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\tRating:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t{this.state.book.rating || this.state.book.rating === 0 ?\r\n\t\t\t\t\t\t\t<ReactStars\r\n\t\t\t\t\t\t\t\tvalue={this.state.book.rating / this.state.book.ratingCount}\r\n\t\t\t\t\t\t\t\tcount={5}\r\n\t\t\t\t\t\t\t\tedit={this.props.user ? true : false}\r\n\t\t\t\t\t\t\t\tonChange={this.setRating}\r\n\t\t\t\t\t\t\t\tisHalf={true}\r\n\t\t\t\t\t\t\t\tsize={24}\r\n\t\t\t\t\t\t\t\tactiveColor=\"#ffd700\"\r\n\t\t\t\t\t\t\t/> : null\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\t<span className=\"ml-3 mt-2\">{this.state.book.rating ? (this.state.book.rating / this.state.book.ratingCount).toPrecision(2) : 0}</span>\r\n\t\t\t\t\t\t<Button className=\"ml-3 p-1\" onClick={() => this.setRatingBook()} variant=\"outline-success\">Submit</Button>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t<div className=\"row mt-1\">\r\n\t\t\t\t\t\t<div className=\"p-1 mr-5\">\r\n\t\t\t\t\t\t\tChapters:\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t<Pagination>\r\n\t\t\t\t\t\t\t{this.pushChapters()}\r\n\t\t\t\t\t\t\t<Pagination.Item onClick={() => { this.setState({ comments: true }) }}>Comments</Pagination.Item>\r\n\t\t\t\t\t\t</Pagination>\r\n\t\t\t\t\t</div>\r\n\t\t\t\t\t{this.state.comments\r\n\t\t\t\t\t\t? <CommentsSection\r\n\t\t\t\t\t\t\tusername={this.props.user}\r\n\t\t\t\t\t\t\tuserId={this.props.userId}\r\n\t\t\t\t\t\t\tbookId={this.state.book.id}\r\n\t\t\t\t\t\t/>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t\t{this.state.activePage !== \"\"\r\n\t\t\t\t\t\t? <div className=\"row mt-5 \">\r\n\t\t\t\t\t\t\t<ReactMarkdown>\r\n\t\t\t\t\t\t\t\t{this.state.book.Chapters[parseInt(this.state.activePage)].text}\r\n\t\t\t\t\t\t\t</ReactMarkdown>\r\n\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t: null}\r\n\t\t\t\t</Container>\r\n\t\t\t</>\r\n\t\t);\r\n\t}\r\n}\r\n\r\nexport default withRouter(BookViewer);","import React from \"react\";\r\nimport { Route, Redirect } from \"react-router-dom\";\r\nimport { withRouter } from \"react-router\";\r\n\r\nfunction LoginRoute({ component: Component, handleSuccessfulAuth, handleLogin, user, ...rest }) {\r\n  return (\r\n    <Route {...rest}\r\n      render={props => {\r\n        if (user === undefined) {\r\n          return <Component handleSuccessfulAuth={handleSuccessfulAuth}\r\n            handleLogin={handleLogin}\r\n            user={user}\r\n            {...props} />;\r\n        } else {\r\n          return (\r\n            <Redirect to=\"/\" />\r\n          );\r\n        }\r\n      }}\r\n    />\r\n  );\r\n};\r\n\r\nexport default withRouter(LoginRoute);\r\n","import React, { Component } from \"react\";\r\nimport BookCard from \"./BookCard\";\r\nimport { Spinner } from \"react-bootstrap\";\r\n\r\nclass Search extends Component {\r\n  constructor() {\r\n    super();\r\n    this.state = {\r\n      isLoading: true,\r\n      book: undefined\r\n    }\r\n    this.getBook = this.getBook.bind(this)\r\n  }\r\n\r\n  getBook(dataset, idx) {\r\n    this.setState({ book: dataset.find(data => data.id === parseInt(idx)) },\r\n    () => this.setState({ isLoading: false }))\r\n  }\r\n\r\n  componentDidMount() {\r\n    this.getBook(this.props.books, this.props.result.ref)\r\n  }\r\n\r\n  render() {\r\n    const { isLoading } = this.state;\r\n\t\tif (isLoading) {\r\n\t\t\treturn <div>\r\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\r\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\r\n\t\t\t\t</Spinner>\r\n\t\t\t</div>;\r\n\t\t}\r\n    const { book } = this.state\r\n    return (\r\n      <BookCard\r\n        key={book.id}\r\n        title={book.title}\r\n        description={book.description}\r\n        author={book.author}\r\n        updatedAt={book.updatedAt}\r\n      />\r\n    )\r\n  }\r\n}\r\n\r\nexport default Search","import React, { Component } from 'react';\nimport { Route, Switch, Link, Redirect } from 'react-router-dom';\nimport Home from './pages/Home.js';\nimport Login from './pages/Login.js';\nimport Register from './pages/Register.js';\nimport Users from './pages/Users.js';\nimport Profile from './pages/Profile.js';\nimport CreateBook from './pages/CreateBook.js';\nimport BookViewer from './pages/BookViewer.js';\nimport BookCard from \"./pages/components/BookCard\";\nimport LoginRoute from './LoginRoute.js';\nimport Search from \"./pages/components/Search\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router\";\nimport { Navbar, Nav, Button, FormControl, ListGroup, Toast, Spinner, InputGroup } from \"react-bootstrap\";\n\n/* LUNR SETUP */\nconst lunr = require(\"lunr\")\nrequire(\"lunr-languages/lunr.stemmer.support\")(lunr)\nrequire('lunr-languages/lunr.multi')(lunr)\nrequire(\"lunr-languages/lunr.ru\")(lunr)\nconst englishRussianSupport = lunr.multiLanguage('en', 'ru');\n\naxios.defaults.withCredentials = true;\n\nclass App extends Component {\n\tconstructor() {\n\t\tsuper();\n\t\tthis.state = {\n\t\t\tsearch: '',\n\t\t\talert: {\n\t\t\t\tlogin: false,\n\t\t\t\tlogout: false,\n\t\t\t},\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined,\n\t\t\t},\n\t\t\tisLoading: true,\n\t\t\tchapters: [],\n\t\t\tcomments: [],\n\t\t\t//searchResult: [],\n\t\t\t//books: []\n\t\t}\n\t\tthis.handleLogin = this.handleLogin.bind(this);\n\t\tthis.handleLogout = this.handleLogout.bind(this);\n\t\tthis.handleLogoutClick = this.handleLogoutClick.bind(this);\n\t\tthis.handleSuccessfulAuth = this.handleSuccessfulAuth.bind(this);\n\t\tthis.getBooks = this.getBooks.bind(this);\n\t\tthis.handleSearch = this.handleSearch.bind(this);\n\t}\n\n\thandleSuccessfulAuth(data) {\n\t\tthis.handleLogin(data);\n\t}\n\n\thandleLogout() {\n\t\tthis.showLogoutAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: undefined,\n\t\t\t\tusername: undefined,\n\t\t\t\temail: undefined,\n\t\t\t\trole: undefined\n\t\t\t}\n\t\t})\n\t\tthis.props.history.push(\"/\");\n\t}\n\n\tshowLogoutAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogout: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogoutClick() {\n\t\taxios.get('/user/logout')\n\t\t\t.then((response) => {\n\t\t\t\tthis.handleLogout();\n\t\t\t});\n\t}\n\n\tshowLoginAlert() {\n\t\tthis.setState(prevState => ({\n\t\t\talert:\n\t\t\t{\n\t\t\t\t...prevState.alert,\n\t\t\t\tlogin: true\n\t\t\t}\n\t\t}))\n\t}\n\n\thandleLogin(data) {\n\t\tthis.showLoginAlert();\n\t\tthis.setState({\n\t\t\tuser: {\n\t\t\t\tid: data.id,\n\t\t\t\tusername: data.username,\n\t\t\t\temail: data.email,\n\t\t\t\trole: data.role\n\t\t\t}\n\t\t}, () => this.props.history.push({\n\t\t\tpathname: \"/users\",\n\t\t\tstate: { user: this.state.user }\n\t\t}))\n\t}\n\n\tgetBooks() {\n\t\taxios\n\t\t\t.get(\"/book/allBooks\")\n\t\t\t.then(response => {\n\t\t\t\t//this.setState({ books: response.data });\n\t\t\t\tlocalStorage.setItem('books', JSON.stringify(response.data))\n\t\t\t});\n\t}\n\n\tgetUserData() {\n\t\taxios\n\t\t\t.get(\"/user/userData\")\n\t\t\t.then(response => {\n\t\t\t\tif (Object.keys(response.data).length !== 0) {\n\t\t\t\t\tthis.setState({\n\t\t\t\t\t\tuser: {\n\t\t\t\t\t\t\tid: response.data.user.id,\n\t\t\t\t\t\t\tusername: response.data.user.username,\n\t\t\t\t\t\t\temail: response.data.user.email,\n\t\t\t\t\t\t\trole: response.data.user.role\n\t\t\t\t\t\t}\n\t\t\t\t\t});\n\t\t\t\t} else {\n\t\t\t\t\tconsole.log(\"User is not logged in\")\n\t\t\t\t}\n\t\t\t\tthis.setState({ isLoading: false });\n\t\t\t})\n\t}\n\n\thandleInputChange = (event) => {\n\t\tthis.setState({\n\t\t\t[event.target.name]: event.target.value,\n\t\t});\n\t};\n\n\thandleSearch() {\n\t\tconst { search } = this.state\n\t\tif (search) {\n\t\t\taxios\n\t\t\t.get(\"/book/allComments\")\n\t\t\t.then(response => {\n\t\t\t\tlocalStorage.setItem('comments', JSON.stringify(response.data))\n\t\t\t});\n\t\t\taxios\n\t\t\t.get(\"/book/allChapters\")\n\t\t\t.then(response => {\n\t\t\t\tlocalStorage.setItem('chapters', JSON.stringify(response.data))\n\t\t\t});\n\t\t\tconst books = JSON.parse(localStorage.getItem('books'))\n\t\t\tconst comments = JSON.parse(localStorage.getItem('comments'))\n\t\t\tconst chapters = JSON.parse(localStorage.getItem('chapters'))\n\t\t\tconst idx = lunr(function () {\n\t\t\t\tthis.use(englishRussianSupport)\n\t\t\t\tthis.ref('id')\n\t\t\t\tthis.field('author')\n\t\t\t\tthis.field('title')\n\t\t\t\tthis.field('description')\n\t\t\t\tthis.field('text')\n\t\t\t\tbooks.map(book => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: book.id,\n\t\t\t\t\t\ttitle: book.title,\n\t\t\t\t\t\tauthor: book.author,\n\t\t\t\t\t\tdescription: book.description,\n\t\t\t\t\t})\t\n\t\t\t\t))\n\t\t\t\tcomments.map(comment => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: comment.BookId,\n\t\t\t\t\t\ttext: comment.text,\t\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t\tchapters.map(chapter => (\n\t\t\t\t\tthis.add({\n\t\t\t\t\t\tid: chapter.BookId,\n\t\t\t\t\t\tchapter: chapter.text,\n\t\t\t\t\t})\n\t\t\t\t))\n\t\t\t})\n\t\t\tlocalStorage.setItem('searchResult', JSON.stringify(idx.search(search)))\n\t\t\tthis.props.history.replace({ pathname: `/search/${this.state.search}` })\n\t\t}\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.getBooks();\n\t\tthis.getUserData();\n\t}\n\n\trender() {\n\t\tconst { isLoading } = this.state;\n\n\t\tif (isLoading) {\n\t\t\treturn <div>\n\t\t\t\t<Spinner animation=\"border\" role=\"status\">\n\t\t\t\t\t<span className=\"sr-only\">Loading...</span>\n\t\t\t\t</Spinner>\n\t\t\t</div>;\n\t\t}\n\n\t\tconsole.log(this.state)\n\n\t\treturn (\n\t\t\t<>\n\t\t\t\t<Navbar collapseOnSelect sticky=\"top\" expand=\"sm\" bg=\"light\" variant=\"light\">\n\t\t\t\t\t<Navbar.Brand href=\"/\" ><h3>Mordor</h3></Navbar.Brand>\n\t\t\t\t\t<Navbar.Toggle aria-controls=\"responsive-navbar-nav\" />\n\t\t\t\t\t<Navbar.Collapse id=\"responsive-navbar-nav\">\n\t\t\t\t\t\t<Nav className=\"mr-auto\">\n\t\t\t\t\t\t\t{this.state.user && this.state.user.role === 'admin'\n\t\t\t\t\t\t\t\t? <Nav.Link href=\"/users\">\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\t\tUsers\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t\t\t: null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t<Nav.Link href=\"/books\">\n\t\t\t\t\t\t\t\t<Button variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\tFandoms\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Nav.Link>\n\t\t\t\t\t\t</Nav>\n\t\t\t\t\t\t<div className=\"float-right\">\n\t\t\t\t\t\t\t<InputGroup className=\"mr-sm-2\">\n\t\t\t\t\t\t\t\t<div className=\"w-10\">\n\t\t\t\t\t\t\t\t\t<FormControl type=\"text\" placeholder=\"Search\" className=\"mr-sm-2\" name=\"search\" onChange={this.handleInputChange} />\n\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t<InputGroup.Prepend>\n\t\t\t\t\t\t\t\t\t<Button variant=\"outline-info\" onClick={this.handleSearch}>Search</Button>\n\t\t\t\t\t\t\t\t</InputGroup.Prepend>\n\t\t\t\t\t\t\t</InputGroup>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t\t{this.state.user && this.state.user.username\n\t\t\t\t\t\t\t? <div>\n\t\t\t\t\t\t\t\t<Button className=\"ml-sm-3\" onClick={() => this.props.history.replace({ pathname: `/profile/${this.state.user.username}`, state: { user: this.state.user } })} variant=\"primary\">\n\t\t\t\t\t\t\t\t\tProfile\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t\t<Button className=\"ml-sm-3\" onClick={this.handleLogoutClick} variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\tLogout\n\t\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t: <Link to={'/login'}>\n\t\t\t\t\t\t\t\t<Button className=\"ml-sm-3\" variant=\"outline-primary\">\n\t\t\t\t\t\t\t\t\tLogin\n\t\t\t\t\t\t\t\t</Button>\n\t\t\t\t\t\t\t</Link>\n\t\t\t\t\t\t}\n\t\t\t\t\t</Navbar.Collapse>\n\t\t\t\t</Navbar>\n\t\t\t\t<div className=\"container\">\n\t\t\t\t\t<Switch>\n\t\t\t\t\t\t<Route exact path=\"/\" component={Home} />\n\t\t\t\t\t\t<Route path=\"/profile/:id\" render={props =>\n\t\t\t\t\t\t\t<Profile {...props}\n\t\t\t\t\t\t\t\tbooks={JSON.parse(localStorage.getItem('books'))} //change later\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t} />\n\t\t\t\t\t\t<Route path=\"/view/:bookid\" render={props =>\n\t\t\t\t\t\t\t<BookViewer {...props}\n\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\tuserId={this.state.user.id}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t} />\n\t\t\t\t\t\t<Route path=\"/edit/:bookid\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\trole={this.state.user.role}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path=\"/createBook\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.username) {\n\t\t\t\t\t\t\t\treturn <CreateBook {...props}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<LoginRoute exact path=\"/login\" component={Login}\n\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t/>\n\t\t\t\t\t\t<Route exact path=\"/register\" render={props => (\n\t\t\t\t\t\t\t<Register {...props}\n\t\t\t\t\t\t\t\thandleSuccessfulAuth={this.handleSuccessfulAuth}\n\t\t\t\t\t\t\t\thandleLogin={this.handleLogin}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route exact path=\"/users\" render={props => {\n\t\t\t\t\t\t\tif (this.state.user.role === 'admin') {\n\t\t\t\t\t\t\t\treturn <Users {...props}\n\t\t\t\t\t\t\t\t\tuser={this.state.user.username}\n\t\t\t\t\t\t\t\t\tuserId={this.state.user.id} />\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\treturn (\n\t\t\t\t\t\t\t\t\t<Redirect to=\"/\" />\n\t\t\t\t\t\t\t\t);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}} />\n\t\t\t\t\t\t<Route path=\"/books\" render={props => (\n\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('books')).map((book, index) => (\n\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t<BookCard {...props}\n\t\t\t\t\t\t\t\t\t\t\tkey={book.id}\n\t\t\t\t\t\t\t\t\t\t\ttitle={book.title}\n\t\t\t\t\t\t\t\t\t\t\tdescription={book.description}\n\t\t\t\t\t\t\t\t\t\t\tauthor={book.author}\n\t\t\t\t\t\t\t\t\t\t\tupdatedAt={book.updatedAt}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route path=\"/search\" render={props => (\n\t\t\t\t\t\t\t<ListGroup>\n\t\t\t\t\t\t\t\t{JSON.parse(localStorage.getItem('searchResult')).map((result, index) => (\n\t\t\t\t\t\t\t\t\t<div key={index}>\n\t\t\t\t\t\t\t\t\t\t{console.log(result)}\n\t\t\t\t\t\t\t\t\t\t<Search {...props}\n\t\t\t\t\t\t\t\t\t\t\tresult={result}\n\t\t\t\t\t\t\t\t\t\t\tindex={index}\n\t\t\t\t\t\t\t\t\t\t\tbooks={JSON.parse(localStorage.getItem('books'))}\n\t\t\t\t\t\t\t\t\t\t\tcomments={this.state.comments}\n\t\t\t\t\t\t\t\t\t\t\tchapters={this.state.chapters}\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t))}\n\t\t\t\t\t\t\t</ListGroup>\n\t\t\t\t\t\t)} />\n\t\t\t\t\t\t<Route path=\"*\" component={() => <h3 className=\"text-center\">404 NOT FOUND</h3>} />\n\t\t\t\t\t</Switch>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tshow={this.state.alert.logout}\n\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\tlogout: false\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\tYou logged out\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t</Toast>\n\t\t\t\t\t</div>\n\t\t\t\t\t<div>\n\t\t\t\t\t\t<Toast\n\t\t\t\t\t\t\tstyle={{\n\t\t\t\t\t\t\t\tposition: 'absolute',\n\t\t\t\t\t\t\t\ttop: 100,\n\t\t\t\t\t\t\t\tright: 40,\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tshow={this.state.alert.login}\n\t\t\t\t\t\t\tonClose={() => {\n\t\t\t\t\t\t\t\tthis.setState(prevState => ({\n\t\t\t\t\t\t\t\t\talert:\n\t\t\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\t\t\t...prevState.alert,\n\t\t\t\t\t\t\t\t\t\tlogin: false\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}))\n\t\t\t\t\t\t\t}}\n\t\t\t\t\t\t\tdelay={3000}\n\t\t\t\t\t\t\tautohide\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t<Toast.Header>\n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t\t{this.state.user.username} logged in\n\t\t\t\t\t\t\t\t</strong>\n\t\t\t\t\t\t\t</Toast.Header>\n\t\t\t\t\t\t</Toast>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</>\n\t\t);\n\t}\n}\n\nexport default withRouter(App);","import 'bootstrap/dist/css/bootstrap.css';\nimport 'font-awesome/css/font-awesome.min.css'; \nimport React from 'react';\nimport ReactDOM from 'react-dom';\nimport { Router } from 'react-router-dom';\nimport { createBrowserHistory } from \"history\";\nimport './index.css';\nimport App from './App';\nimport axios from 'axios';\n\naxios.defaults.baseURL = 'https://itransition-coursework.herokuapp.com';\n\nconst history = createBrowserHistory();\n\nReactDOM.render(\n  <Router history={history}>\n    <App />\n\t</Router>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}